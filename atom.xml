<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>RossLinçš„æ•°å­—èŠ±å›­</title>
  
  <subtitle>è®°å½•Â·æ€è€ƒÂ·æˆé•¿</subtitle>
  <link href="https://roselin1217.github.io/atom.xml" rel="self"/>
  
  <link href="https://roselin1217.github.io/"/>
  <updated>2025-12-18T14:03:28.664Z</updated>
  <id>https://roselin1217.github.io/</id>
  
  <author>
    <name>RossLin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>11.å†…å­˜ç®¡ç†</title>
    <link href="https://roselin1217.github.io/2025/11/27/11.%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"/>
    <id>https://roselin1217.github.io/2025/11/27/11.%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/</id>
    <published>2025-11-27T02:00:00.000Z</published>
    <updated>2025-12-18T14:03:28.664Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç é”™è¯¯ï¼Œè¯·å†è¯•è¯•ï¼" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="bf6abfb75d4a5884c2f1ffe540f25939c803c324d0cfe9276f0664669b080470">4630436162ade97ba2718b7d0c4b3b63cb3a3f659c5ca08b4bca0f5845928186bdcfc696daac6d9329c0d777e4c8c11430e669204f63b31e60fbbba6873380f32108060f39e48ee126f785099739a6e7064b9f0f5825a7f36918c38c1834d261e6f7f656419f0f328181bb6dda30e7ae5d5c2ad2e417c9f1addd0fc9662011e4accbf4bd725bae91ab1baf862a99d9c3b32ed1d8d63186b2fe40d387a30b23edf971381eb43fbcf2337ee1158b44da3145ca4f18337e65ae4b47c743174c4b99c014330002766ab3f29db13a27f7cb1c3c104498041724e01dd599a746ce3fcc1e285899ccea76bc8e7207171025474926d34458d69bff7a92b44f02369abf1049b52b63eed825fe2c587936e502c5dce8c8fc30a3d34ec11b20d9cdc44184b468c63466336a57572f0a67f655dbdfed0978a330abf21e49da6063488c82ab6fc9ea72f7de297ffd1e04f8f16643932a2ead25ac537576c234586f13431bfd8eea1e89bb960bdef8927e872fc177e827df2b948f0faedbc9961c72eb45445dc72a61db86785096b178449365833eba9676c0acb545e682dae230a18b6acc530ff333b5681f0e753aad10a14736d6e3df230ecdfaac032d553dac9b47050c25ffb2075e170bb5633cf94cb7ea1b6dbd15d314b95442033d1b09a76e89ec878ee28ba56863d7de35a38d3e7c1bad5727ba22f9bde290ff99c59664264accec5480e1f0b94e5cce2f98e2fd1ffcff280de361c373f0fc43622f08bc63680e9ba78294ebb26c62f879b1931d98232d72f224f859e6dd2c016c3f9ad4ca8e9adc2d7d689b74879c25e9ebdd3686ef0b0384e9a770dc982bd86d6dd11a0c05749c9b66422cdf6911565e09dcc7e6a11d4b5bc2e2d9aa21995de8946bef19f19cf9019f1e22017c50dd8d8ffa5fa0996f01daeedd70ad5ddba33f5ec5ec89fdbbb177b65401445fde929766edaee34715e2af72b9769e175662af28bd0766df7744908ae6b91b15b6e27fa227c88edb98e892bde64bb172b1da6b3e74e4a523b3e6eed0f2b04d0eb4e8f1dd05755a0f42b524893b1f44f63fc99cee044be826758467dfb0be1be18f271dce3d6b41b52a83fe71253c4ed77cf459697924519f4182fd6c054f1f74c32663de52a454c1a8a3e42dd0f219c803913bb73966ddeb54012a95bb99a05987199e576cf67a82442fd8e0a3cfc38bc8143f4af44d5fd24252af426f8a1e43fdeba69832ada650528c25fc821e6df649424842f6828a28068c1cf78645499808c25d6557cd3d15afa6f7cdc2adc9e771911bf4c9f12db71cd8878a32ce1de39cee4039aa27ed51080375e194e23552ce9f8f81e06adad3d4987a98b2aa6fa3dc2b6aa4fb9062d3a8d131dccf21f0acd81e11ef3ebd360d4efd04658e0400a11ca810ce4064898d0bf3eba21186b8e0f96a5e40f79962d5dff9b091721ae62b4241971a0bbe529836890f0d954be7e8da548a757d57f7cce9a24398a4131cfb25ea4e3f5c3cd1967f4ff4df2691f9c3bda139bd75b9b6444127926886b1c7c02eb275fed4ea6c7c3b08eae276a588bce723f1e410d5092f07dfb5466324e8b2d4407bf59d401ba3936348f732a91325828efad24c08aaa0e39889e21aa77fa8a91056e5164b12d2bff2a6d082612d5ef29524af5a7f5c59e2971ed6052e08bf4255ca99dc0f60158bffed5e73dd4f98d9e22a3acc6a3888d474c562e5f2f2f8886e256584bdf920c3a63555d7923d91197a763695d761fa4285b16a9a2da6750f9deea85db7c309e439e548d12e0935de3c2e035f273b17d887ee80b3ef976fa6c51ef360aa6294f4387d05b234adc345038180a03015e6acd23bae637296873916e3fdd9e9012759e9b9f7adfaabd51861af900c79d45962f75a204fcd641e82eb2d3753a81741ef5df92b08175a8c6a12a1be1d473b32296c84005d1fe47d2024dd16f91b86d0e55ab24f5656c0cb0bca77bcc7f47ddf5d556d60f60d8bf96eb523564a4f0ca19c2cc9953891bb8a5f4f79a5f0ff188439a5ba048ff65ad3cd45979496a2f7eb7f2f08a72ac9636e4d711a766fd946b419632efcb64e0021733b67855b9ccdaefe77f351b0ce45482bdb90a6365b4627634a8ffe8516ee14e32827e366ccbe77a71c37b40208f736c3e2829f455a2f8ea9b7e3587bccf0aebfd0756b733cc4d50bb4c00a832d5755ab3789c65f522f58078f7d30734f1cdcb68c29048721c40effeee2b784905f3dc722e8d529fa134fc1c9d780d49fcc3907ba712fe16def315b30dc5d15c80f284745ee2e25e66706f3d5c69c382b0601dc0fbbd2d080f1c36d89f1e05582f4b838518711453b7d47c5efc68c6d47334ca25ddeaa1d9bcaa94b2aec417c8a098a38536090354fd5c8d083f2f1eb3f454a7e9da9853f3b24dc264a0863d6dc20aedeae9befb9203628712bb13a3f17fd18686476dd9b2a28b16aebc6a4b1dcdbba305b95894e28eb268c730b9e221e667d06fa9b1e3e235c6e6e3651b4ab3c2d9c2ea2a106dafc400ade47e6a0bc0b4ae6b8349ef58e047036f5ad4a814c2c2c8ccabb40fdbbfe6624b0ba106ce46b5a026727c2eb20cb361c5efe0e630c5b82de203934ee8a4918cf74a0e3708e9174510ffb8cb0fa77ce45eb00641a1ba8953fb241fcb677c808a686dfee0a44de4a7656b3821adf1fc018ab6174a7400a9abb00936ab4e8cc7f0f1f63a78398d660d679dae517f8297f1fd5622ddf28f40c4440948b2c7bf13c919986ff7f9c01924b754bee4d6d8f23912c8f4f48fdfe594f78fd8b9f144bd17ce1516c15942d01847ccf653dab2458860ac7c194d2fe227d2406732ef9d6eb469cd91c2969de67c9360200b1680c9f69a666adc24594cfe9b22d1b0de58d654fe9bb9bb3ab9da34ee5d077b3e0829f6ca81abebd73d55d6fff8bd0e132a20b0e5e4e9ebe03ae3fe1c01682c57afa8e3263a516fd8533af8aec36263872d4d76abd6a53616c77fb29309d789dd69d108a0fdfec6041636ed56faf2c601123e74873e9f73f4ff43677b373698b214e6b2a1e3b0adf6188e970796cfaf2d945b355e7f57cbfd0d0f19639f8feb9b8b371327ad174676f720ef503bc5cad0101806589fdfd5c9e654625183b74f68a6b6a10b50ab566c6cffc5915c852c52032ed9f10e9742f87e025c2ac990ad15326bfabd007863b47634009eb5649587a18204a58e1b93a88f30afeeb676855f1736894846d94970dd4676937d83fb5b5daf4e0524dedfd5d59bbe1b0261415321b0c3a556351b1b98fdeceb61ff33b1652c33d5fbc4125f4541b75806c79a322173ef038c1cf9a5a684b35fc27201bfd953f29e77681b3b191aded3091de26c18f45a549a1b2c0ee3c5fdc7e226a68040eb26e6836c2f55daeafc878ad5e40e2632a56840c735d4bd0e132651ea7b7d559c3d5af47e00b01e4648e2062415466bb0ba3ab095d529e374540077897125f50469f5781683b7054e2ab50f256d9a8f600ba7a25c00c8ff9f73b55629ef87b4a109bcf00ec7ef8306765afd403401b30a98c1c766e9f1a9df253b4bd815241d7dc1c1de2085d7987d8fcd49f91af58b5aede2be6bc92032a03f623a8f0757bb135f7fbed7406680733191f99306bfa22b38c07f35c186d1a419ec9468d9f47a44c43917b508a20530c8c254749b1b086748bfcc551cdd30fa1d6e27fa743dd0354577d104afe21186aa84cb5334cfb3ea9cf89566b42c6f25ae31d309fc7b4533ace1f0044358cf9317e413919433b2c3205fd60a509f0d84e73fcfd525d029a4bb4b557486fc4c6561dd557a78de5c27c9995c0fa100e7f2944a3c7cb4d0d3928baf79fe2931ecf79b545a77c87e527499a51f50a3bbcb0623f41bac1f06600bd475dbbe133c9307fff099b1699b907a30af1eb4d41604fdda448ef9269db1f3d0759d559a08b578972bc2c93992f41d567e5c4b8a6b19153f5654d8a93b9c23f53f9b1c6a0f64d8c97a3a200bacbef02a1cb9a4be1d54a825301d2dabdca822ff030775a2b348c4cae05335951095187558bed185151d38318a1c9e282aba47be8684ddfe0982236c9dfd81322190940d3e712b17c6f78eb0a4f094778ebec80612c92a86c2a825932d0233aa774c1bd393b8c83caf504d846673a8e53c1444448f3293d3845af084bdc33ed8f72d343fdcfee0a96f1e0f3b41274e8994b421d3ffc7c5f93a0d07dfac1984f3ff1038d3fb86c0820d20f5870f3fd40466982f35fccefcae4b32bf41e3f3dc4d359d6c05b1a677ce515758ddadb27959adb9fcb2d8c0973809b75bffd7da4333272ccb06c0317f9b27feef4da06e581f6adfed803d6ace8d65e6a278c101d9a1e6e975976cbe438a4a53f878fd5149d3d67d7acba44845c2ea3d5aad6d57a52d5b90fde5e2b22fe4e059e139e822ad17605994b27b41acafeb7dc2f847fcc7a38ad22542e8ffab25b478de8d04bc6f1c7b0c1608716e6f2853ecbc8e4003fdd6b71f178f09cfcb7a4828bbc5db75f451a66bdf02f14140226d5ef21f38e54170b90e6a296bf41e2a95a5f76575288dd58d7e9336f421e23f4b45bc0e01e1e06bab65d6e0dc79f367f4eb9cb95a36e6c3b3354d7ed91cd3cd48dcd98b4e14b0e3c05593fe13e5409aaaf18bf1dfca54d0b58781d2dbd14ee467fc48cd6cea6941967ce3b50a14ccf4bce4be5994d237fd78694fcd46b901d24655902b601af676992ed56a317bbaebc73f0fb51a2e791ec8ffe05338eab6893acaba3209d95472cd86d9128b6dded71362fbf08866af64b2b5618303f23f0155b34a870efcc5602f538293c65ed7560f87b217af9c30f750d2dfc3650620b19d6134e624a78e18c98b553cf56c728edc57f3d0c7eca3b852e2f1b1a69f3473ba0213f7e0bcdf8a55567c3300b36b1ce00c48ab5eec5af7a588c1f0045ee3d02b115df0bd102caacaabe2f79c9c6f55cfa73a6ce99a11abe479b796a45f262f05001a8b41eb88e09ebe6c53c4e6cfe599643136e6853b666c7e46a82c971ef853880f6107d73143c70a695dc8b8143e688d99b0d0ac3b2971c01b118aa7ad0e89e0d75bf6ba3b97758fb2ec235b8c6491cefab48ecf7436d86ffe0d2f3feac02b3165e2a6ce9ec28472ffab332a269c7d31136f81b1944641d700dcb05f0edbf0c0afa7d9c265bc65fbe33b763e31c60eaee569a81f08cbbfa7c93a954f24d8210b675791bd4a27121669614570eb178afb6fcf760b2a3eb7b9411079e96671bed8085caabd8fc701522ed50b750d21505b2dae9dc5617d1deb690ccec9970886ebd2651a7e122961a633027fd141177cd1f63db5787630c4b72b6e8f62293d44914c3b181a84264581ef10bc90a8c7c60e80254a3e882f275d84709df33cdb744e90eccb9380f0100eb8482fdecf209ae7de498bc33c35690f27cf13dac9ab0db781af6ae60e840be906870bd8b203a982cb8a2f02ab5027d4c7fa3fc3e04b0910c4adfedc93c217b8ea1d010fe81a991b15c1b81073fc2150406e1cc09c78926eca0438a14d938b0db7fafab7c1080aa20cb2e7a8c4a39851b9ceb3cf5592d761e08f1cc6af065abc686d1d9d4a13d8e76328700ad690a586104490cc438d8b7345da734df04246661838738b0c9cb0d39ff72f8b2af808816708d42e574254803f2f5fc2fbabc406b0c397c87fe7e8d85917b820c9c486b605f0fc04d565d81d4c49c5c39521a83ed49f5ed2045eb4f32bd06fa0980c806daee6ae518e22af8f10608b396edbfab4a2921b748d19ae928be7c50f2c4359d17269e06e2a8a039c24d32c1165633d7dde5d69ded399923e417533afb5c45c29fdf95dbd4c4e1ac4389ed19331bce320134556a9b9ff95755792f02ce34270abfde2d0b6f79c75c5f97b0e130440b18b38413bae42bdceb63f32a8f44bd841d3b9ae21b0f3287e4f687dfdc91b6b23c4999f71e17ef3bfdb1320409f56863664e865cd2ce420dcbe88c926fb28c5ad3920de7a8c21900dd73fdf2776eb2f97413c4c21254a032be64220311a251e493aa5cde9154aa4808d3a62f74026f6fa2b01c57b2f019f87c6433b5ac99277415afa96a9c146986fa8ef1fcb5b0e70399a045cf2cd57fe6762ab97edb406b31b91d8c8363a220bf3f935536523a130c12fc46b3c5ac0c0f2535213ddd3bd6cc2ab52a51bcecc65abada411df54f2c1cda798777e1ccea21a891475d49bc3b28658f375471705a2001f3e8d54d60d84dfbb022245cb0299f930158980af6242ebdf58ef5ebd6038a430183ee764ddfba3e3dab497d52375b6c11856bf489a1b73980029d0ea7a91165217cc0d78ff6b237a97c556850a88f9a9aec079406cecc5d06c489627174eb06d27ea18a1b85cb34861b5767460c70f4ccc4fc583640e930aab8510276ff8b7d08c532bd81a42fa624c8894bf6d4e94daacf66cc22306a5269196fd86ac58d0d87d1432c205501a776c9cd54b9da8bfd4d512017160d57a75ec5fbee7af2a24a7a143642baafb242fdcb7dd7b9dbd5eaca2543161f0a7cdfbe9ba0e9539650a1c2dae64cd74afeff8250050e7e567a8a513ce63fe7381db9163272344c104b48e285fe88ba7f67b8873e7b2b6ae296d4c310fde79ac484bc54857cb4e27f85a2a11febb3e2f935e59108ae0d8dd12cc89ee6f3fb8da2d58e4d7eb962cb95e878830e960dfa97c8fe1ee234d92dabbab1c6baa130c172cf431a80bf9b3565f6d89c7b1e4f541f2931b5bf2a5eb73a9658d9a26a5246471cf20236fb21928ee3f50cdf855f7e33f988eb1492510297a5dc898340685a5c28b024c90fab0b297d38723140cecd427982737ded0903947bbdd6b6c0d62333fe9919a95d179cf0cfe81d83f3bffc314a10d80d8022b3ce6a216c06c7f4fec165212f193e0d10027e0d3f7db114bb014dc08da511fe46b2f784a04404a2773db2aecf0342e708063c476dddffc3d2f6bdf4db0c7e07cab6d559ef77fb4e7cd2ffd3609c2d93667e5a028d2e8bbc8679c03a476b350fa4f3aeb31efef756dc7560298f50dad1a00e1f67f171e648aefb3a61d7c70164c33d0c4816d2257f7210e8bfa9fd9d67c6c605237c781e179d2606eec54f5ef92d19f533dafff565d6d6d76b317fb2f162fbaa199f7de311f8aea536540693d0538b945bcf38b06cd23ff35866eea2a8fdcb5b6de06200c73f2eed1f3f4c75a13eed1edc1f768022845b8d8b0c563b5621baa6d5ef0aa22ead00bb986f6c3b98778bc0535af86ee4b1b49bcea96c0d79cc37482de015096ac90ed762a44694c1f4d9c37352d05540e633d4234728a0fd01ed93c1be4bbba2b8c047332521a8fcc181f83cf0a5f360a0ce1409f9cc981b8234baaa3410cebe2753a7aeaac26fde45f204929748d5d55201d377e870fa5a4fadb9ad022b5e3de765b9b45ee361ece78636a484f6c9b328fd4bd7621410502abf80b2843ac5422413ad3156169c42b6e015e8aaa2df25fd744c1bb255c4b91d0e2efcbcf5d248af437c576145efe1c63d6a695f2fc33a786cd06084811389b30827110de85de3d7c9a6b0c18a946398113106ad90939dc6664c3d7c21f785519fa904c7f949aa138e6a47353fa83fc255ae5afd1429de98e102a1e27d58acce771e585b816b0c60c971d2d8ac4296356f371a408a7b925b9e53c45dfb24169fd19e7d53f24caed42cb0f6401ff46ee3020153e71aa7d7e87c8f3f9c27f2ad91a5311fb98623d422f7ce65458dbfa6330e328a23c1d1eb014f1326d094a0c4e6930bfc9a23ce969848bfb7f2d3a0fa72183d11257abc84ca8d9ad6a9bc2391aa752a3b582b7165cc330cf4e08a442b1932332b266460cdf2c2148dca0f3e8e97de1ba8c1b295aae0697cce2b99600bac81976993ad68a9a05a55dde60523e7edccbee29459ed535965f98f4f89c065a382ba7eb003d882c2bba6ffe6a27d766961aa615b06774875bfc7d0a4edec75e107798c65a444f6856883e6f8261c18b45458794704f0d431c638886ed669add438bcf75c971d7afe7b85ede6abb6f43572bcbcee6f0b84e78f867e29982edf086b4ea633ebef6daf27fcd45f7dade8ff741426e45831542090a2f5357a06ffd5f861dc17e3f78f6bf452cf181336c7592ea611ba155ce6d082819c904f6e572c007b49fee1ef2f55776d10d9f3dd5f0c8a70cfa4f50018efc45a8486b08a2286a7e43f7d404b00603f9ff5933da17dbf97df2c805727ece0b46bdd0bc28706716606e50ad0fc33c2a97b0c1fb5d236284c3d715cfc610342acd3b6103dcf6f6807a64fd3c9fae7610a4bc1a8b0c0d2366095ad8aaa55bf7cc031da34143ab2273e714307992c46da68ff952298c58e0dae9107af0a2d3db3225ad4eab420c4d841ef56b2986af7e1f41fe6af7e1dae3ab559acb8bff6bc0fd91362903cb46cfbd8735c9d10ee9066aa98075bf0816ab7507c2c07131c4dfb4b6f0d64a4bcdfc32539107b5ef8106246404b57656e1f7d204d21c095ef2dbd95852a2789902d489dc04084bde44a92bbc75b195dcd1cc5346fce41459153fb4810f3d53e1dbeed93414f7f798db461d86bc443cfa502b70863dc323cc7e0a3c9e72c8fa2eba6829e14</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">è¯·è¾“å…¥å¯†ç æŸ¥çœ‹æ–‡ç« å†…å®¹</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">è¿™æ˜¯ä¸€ç¯‡éœ€è¦å¯†ç æŸ¥çœ‹çš„ç§å¯†ç¬”è®°å“¦~</summary>
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>10.è¶…å£°æ³¢æµ‹è·</title>
    <link href="https://roselin1217.github.io/2025/11/24/10.%E8%B6%85%E5%A3%B0%E6%B3%A2%E6%B5%8B%E8%B7%9D%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/"/>
    <id>https://roselin1217.github.io/2025/11/24/10.%E8%B6%85%E5%A3%B0%E6%B3%A2%E6%B5%8B%E8%B7%9D%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0/</id>
    <published>2025-11-24T02:00:00.000Z</published>
    <updated>2025-11-28T10:19:52.091Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¶…å£°æ³¢æµ‹è·"><a href="#è¶…å£°æ³¢æµ‹è·" class="headerlink" title="è¶…å£°æ³¢æµ‹è·"></a>è¶…å£°æ³¢æµ‹è·</h1><h2 id="ä¸€ã€è¶…å£°æ³¢æµ‹è·åŸç†ä¸å®ç°"><a href="#ä¸€ã€è¶…å£°æ³¢æµ‹è·åŸç†ä¸å®ç°" class="headerlink" title="ä¸€ã€è¶…å£°æ³¢æµ‹è·åŸç†ä¸å®ç°"></a>ä¸€ã€è¶…å£°æ³¢æµ‹è·åŸç†ä¸å®ç°</h2><h3 id="1-æµ‹è·åŸç†"><a href="#1-æµ‹è·åŸç†" class="headerlink" title="1. æµ‹è·åŸç†"></a>1. æµ‹è·åŸç†</h3><p>è¶…å£°æ³¢æµ‹è·çš„åŸç†æ˜¯åˆ©ç”¨è¶…å£°æ³¢åœ¨ç©ºæ°”ä¸­çš„ä¼ æ’­é€Ÿåº¦ä¸ºå·²çŸ¥ï¼Œæµ‹é‡å£°æ³¢åœ¨å‘å°„åé‡åˆ°éšœç¢ç‰©åå°„å›æ¥çš„æ—¶é—´ï¼Œæ ¹æ®å‘å°„å’Œæ¥æ”¶çš„æ—¶é—´å·®è®¡ç®—å‡ºå‘å°„ç‚¹åˆ°éšœç¢ç‰©çš„å®é™…è·ç¦»ã€‚ç”±æ­¤å¯è§ï¼Œè¶…å£°æ³¢æµ‹è·åŸç†ä¸é›·è¾¾åŸç†æ˜¯ä¸€æ ·çš„ã€‚</p><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251127143229081.png" alt="image-20251127143229081"></p><h3 id="2-æµ‹è·å…¬å¼æ¨å¯¼"><a href="#2-æµ‹è·å…¬å¼æ¨å¯¼" class="headerlink" title="2. æµ‹è·å…¬å¼æ¨å¯¼"></a>2. æµ‹è·å…¬å¼æ¨å¯¼</h3><p>æµ‹è·çš„å…¬å¼è¡¨ç¤ºä¸ºï¼š</p><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251127182824215.png"></p><h3 id="3-è¶…å£°æ³¢å‘é€ç»†èŠ‚"><a href="#3-è¶…å£°æ³¢å‘é€ç»†èŠ‚" class="headerlink" title="3. è¶…å£°æ³¢å‘é€ç»†èŠ‚"></a>3. è¶…å£°æ³¢å‘é€ç»†èŠ‚</h3><p>æ ¹æ®æˆ‘ä»¬ä¸Šæ–¹çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬é¦–å…ˆéœ€è¦è¿›è¡Œå‘é€ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå‘é€ 8 ä¸ª 40kHz çš„æ–¹æ³¢è¿›è¡Œæµ‹é‡ã€‚</p><ul><li><strong>å‘¨æœŸè®¡ç®—</strong>: å‘¨æœŸ<br>$$<br>T &#x3D; \frac{1}{40 , \text{kHz}} &#x3D; 25 , \text{us}<br>$$<br>ã€‚</li><li><strong>ç”µå¹³åè½¬æ—¶é—´</strong>: ä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦ 12us å°†å‘é€çš„ç”µå¹³è¿›è¡Œåè½¬ï¼ˆçº¦ä¸ºåŠä¸ªå‘¨æœŸï¼‰ã€‚</li></ul><h3 id="4-ä»£ç å®ç°æ¦‚è¿°-åŸºäº-STC89C-ç³»åˆ—å•ç‰‡æœº"><a href="#4-ä»£ç å®ç°æ¦‚è¿°-åŸºäº-STC89C-ç³»åˆ—å•ç‰‡æœº" class="headerlink" title="4. ä»£ç å®ç°æ¦‚è¿° (åŸºäº STC89C ç³»åˆ—å•ç‰‡æœº)"></a>4. ä»£ç å®ç°æ¦‚è¿° (åŸºäº STC89C ç³»åˆ—å•ç‰‡æœº)</h3><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¦æ­£ç¡®ä½¿ç”¨ç³»ç»Ÿé¢‘ç‡ä¸º 12MHzï¼Œå¹¶ä¸”ä½¿ç”¨ <code>y1/stc89</code> æŒ‡ä»¤é›†ã€‚</p><h4 id="4-1-å»¶æ—¶å‡½æ•°-Delay12us-void"><a href="#4-1-å»¶æ—¶å‡½æ•°-Delay12us-void" class="headerlink" title="4.1 å»¶æ—¶å‡½æ•° Delay12us(void)"></a>4.1 å»¶æ—¶å‡½æ•° <code>Delay12us(void)</code></h4><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251127124721571.png" alt="image-20251127124721571"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ul.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;intrins.h&gt;</span> <span class="comment">// æ ‡å‡†å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief  å»¶æ—¶12å¾®ç§’</span></span><br><span class="line"><span class="comment"> * @param  æ— </span></span><br><span class="line"><span class="comment"> * @note   åŸºäº12MHzç³»ç»Ÿæ—¶é’Ÿ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay12us</span><span class="params">(<span class="type">void</span>)</span> <span class="comment">//@12.000MHz</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> data i;</span><br><span class="line">    _nop_(); <span class="comment">// ä½¿ç”¨æ ‡å‡†åº“å‡½æ•° _nop_()</span></span><br><span class="line">    i = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-2-è¶…å£°æ³¢å‘é€åˆå§‹åŒ–-Ut-Wave-Init"><a href="#4-2-è¶…å£°æ³¢å‘é€åˆå§‹åŒ–-Ut-Wave-Init" class="headerlink" title="4.2 è¶…å£°æ³¢å‘é€åˆå§‹åŒ– Ut_Wave_Init()"></a>4.2 è¶…å£°æ³¢å‘é€åˆå§‹åŒ– <code>Ut_Wave_Init()</code></h4><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251127122447909.png" alt="image-20251127122447909"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰è¶…å£°æ³¢æ¨¡å—çš„å¼•è„š</span></span><br><span class="line">sbit Tx = P1^<span class="number">0</span>; <span class="comment">// å‘é€å¼•è„š</span></span><br><span class="line">sbit Rx = P1^<span class="number">1</span>; <span class="comment">// æ¥æ”¶å¼•è„š</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief  å‘é€8ä¸ª40kHzçš„è¶…å£°æ³¢è„‰å†²</span></span><br><span class="line"><span class="comment"> * @param  æ— </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Ut_Wave_Init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        Tx = <span class="number">1</span>; <span class="comment">// æ‹‰é«˜ç”µå¹³</span></span><br><span class="line">        Delay12us(); <span class="comment">// å»¶æ—¶12us</span></span><br><span class="line">        Tx = <span class="number">0</span>; <span class="comment">// æ‹‰ä½ç”µå¹³</span></span><br><span class="line">        Delay12us(); <span class="comment">// å»¶æ—¶12us</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-3-è¶…å£°æ³¢æ•°æ®é‡‡é›†ä¸è·ç¦»è®¡ç®—-Ut-Wave-Data"><a href="#4-3-è¶…å£°æ³¢æ•°æ®é‡‡é›†ä¸è·ç¦»è®¡ç®—-Ut-Wave-Data" class="headerlink" title="4.3 è¶…å£°æ³¢æ•°æ®é‡‡é›†ä¸è·ç¦»è®¡ç®— Ut_Wave_Data()"></a>4.3 è¶…å£°æ³¢æ•°æ®é‡‡é›†ä¸è·ç¦»è®¡ç®— <code>Ut_Wave_Data()</code></h4><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251127134433921.png" alt="image-20251127134433921"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief  è§¦å‘æµ‹é‡å¹¶è®¡ç®—è·ç¦»</span></span><br><span class="line"><span class="comment"> * @return unsigned char è¿”å›æµ‹å¾—çš„è·ç¦»å€¼</span></span><br><span class="line"><span class="comment"> * @note   æ­¤å‡½æ•°å­˜åœ¨ä¸€ä¸ªæ½œåœ¨çš„bugï¼šè¿”å›å€¼ç±»å‹ä¸º unsigned charï¼Œ</span></span><br><span class="line"><span class="comment"> *         å½“è·ç¦»è¶…è¿‡255cmæ—¶ä¼šå‘ç”Ÿæ•°æ®æº¢å‡ºã€‚å»ºè®®è¿”å› unsigned intã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Ut_Wave_Data</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> time;</span><br><span class="line">    <span class="comment">// é…ç½®å®šæ—¶å™¨/è®¡æ•°å™¨</span></span><br><span class="line">    <span class="comment">// æ³¨æ„: CH, CL, CMOD, CR, CF æ˜¯ç‰¹å®šäºSTCç³»åˆ—PCA/PWMæ¨¡å—çš„å¯„å­˜å™¨ï¼Œ</span></span><br><span class="line">    <span class="comment">// å¹¶éæ ‡å‡†8051çš„å®šæ—¶å™¨å¯„å­˜å™¨ã€‚æ­¤å¤„ä»£ç æ˜¯åŸºäºPCAæ¨¡å—å®ç°ã€‚</span></span><br><span class="line">    CH = <span class="number">0</span>; <span class="comment">// æ¸…ç©ºPCAè®¡æ•°å™¨é«˜å­—èŠ‚</span></span><br><span class="line">    CL = <span class="number">0</span>; <span class="comment">// æ¸…ç©ºPCAè®¡æ•°å™¨ä½å­—èŠ‚</span></span><br><span class="line">    CMOD = <span class="number">0x00</span>; <span class="comment">// è®¾ç½®PCAæ—¶é’Ÿæºä¸ºç³»ç»Ÿæ—¶é’Ÿ/12ï¼Œå¹¶ç¦æ­¢PCAä¸­æ–­</span></span><br><span class="line">    EA = <span class="number">0</span>; <span class="comment">// å…³é—­æ€»ä¸­æ–­ï¼Œé˜²æ­¢å‘é€è„‰å†²æ—¶è¢«æ‰“æ–­</span></span><br><span class="line">    Ut_Wave_Init(); <span class="comment">// å‘é€è¶…å£°æ³¢è„‰å†²</span></span><br><span class="line">    EA = <span class="number">1</span>; <span class="comment">// ç«‹å³å¼€å¯æ€»ä¸­æ–­</span></span><br><span class="line">    CR = <span class="number">1</span>; <span class="comment">// å¯åŠ¨PCAè®¡æ•°å™¨</span></span><br><span class="line">    <span class="comment">// ç­‰å¾…æ¥æ”¶å¼•è„šRxå˜ä¸ºé«˜ç”µå¹³ï¼ˆå›æ³¢ä¿¡å·ï¼‰ï¼Œæˆ–è€…PCAè®¡æ•°å™¨æº¢å‡º(CF=1)</span></span><br><span class="line">    <span class="keyword">while</span> (Rx &amp;&amp; !CF);</span><br><span class="line">    CR = <span class="number">0</span>; <span class="comment">// åœæ­¢PCAè®¡æ•°å™¨</span></span><br><span class="line">    <span class="keyword">if</span> (!CF) <span class="comment">// å¦‚æœæœªæº¢å‡ºï¼Œè¯´æ˜æ”¶åˆ°äº†å›æ³¢</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è®¡ç®—æ—¶é—´</span></span><br><span class="line">        time = CH &lt;&lt; <span class="number">8</span> | CL; <span class="comment">// åˆå¹¶PCAè®¡æ•°å™¨å€¼</span></span><br><span class="line">        <span class="comment">// è·ç¦»è®¡ç®—: d = 0.017 * time</span></span><br><span class="line">        <span class="comment">// us -&gt; s 10^(-6)</span></span><br><span class="line">        <span class="comment">// m -&gt; cm 10^2</span></span><br><span class="line">        <span class="comment">// L = V*T/2 = 340 * time / 2 = 170 * 10^(-4) * time = 0.017 * time</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="number">0.017</span> * time);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="comment">// å¦‚æœæº¢å‡ºï¼Œè¯´æ˜è¶…å‡ºæµ‹é‡èŒƒå›´</span></span><br><span class="line">    &#123;</span><br><span class="line">        CF = <span class="number">0</span>; <span class="comment">// æ¸…é™¤æº¢å‡ºæ ‡å¿—ä½</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// è¿”å›0è¡¨ç¤ºæµ‹é‡å¤±è´¥æˆ–è¶…å‡ºèŒƒå›´</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>ä»£ç æ³¨è§£</strong>:</p><ol><li><strong>å¯„å­˜å™¨</strong>: <code>CH</code>, <code>CL</code>, <code>CMOD</code>, <code>CR</code>, <code>CF</code> çœ‹èµ·æ¥æ˜¯ STC å•ç‰‡æœºç‰¹æœ‰çš„ <strong>PCA (å¯ç¼–ç¨‹è®¡æ•°å™¨é˜µåˆ—)</strong> æ¨¡å—çš„å¯„å­˜å™¨ï¼Œè€Œä¸æ˜¯æ ‡å‡†çš„å®šæ—¶å™¨0&#x2F;1çš„ <code>TH0</code>, <code>TL0</code>, <code>TF0</code>ã€‚è¿™éœ€è¦æ ¹æ®å…·ä½“çš„å•ç‰‡æœºå‹å·å’Œå®šæ—¶å™¨é…ç½®è¿›è¡Œé€‚é…ã€‚</li><li><strong>è¿”å›å€¼ç±»å‹</strong>: <code>return (0.017 * time);</code> çš„è¿”å›å€¼ç±»å‹ä¸º <code>unsigned char</code>ï¼Œè¿™æ„å‘³ç€æœ€å¤§åªèƒ½è¿”å› 255ã€‚å¦‚æœè·ç¦»è¶…è¿‡ 255cmï¼Œå°†ä¼šå‘ç”Ÿæˆªæ–­ï¼Œå¯¼è‡´æ•°æ®ä¸å‡†ç¡®ã€‚é€šå¸¸è·ç¦»å€¼ä¼šä½¿ç”¨ <code>unsigned int</code> ç±»å‹å­˜å‚¨ã€‚</li></ol></blockquote><h4 id="4-4-è¯»å–è·ç¦»å€¼-Get-Distance"><a href="#4-4-è¯»å–è·ç¦»å€¼-Get-Distance" class="headerlink" title="4.4 è¯»å–è·ç¦»å€¼ Get_Distance()"></a>4.4 è¯»å–è·ç¦»å€¼ <code>Get_Distance()</code></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾çš„å…¨å±€å˜é‡</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> Distance_Slow_Down = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Distance_Val = <span class="number">0</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @brief  è¯»å–è·ç¦»å€¼</span></span><br><span class="line"><span class="comment"> * @param  æ— </span></span><br><span class="line"><span class="comment"> * @note   é€šè¿‡ä¸€ä¸ªå»¶æ—¶å˜é‡æ¥æ§åˆ¶æµ‹é‡çš„é¢‘ç‡ï¼Œé¿å…è¿‡äºé¢‘ç¹åœ°æµ‹é‡ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Get_Distance</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥å»¶æ—¶æ˜¯å¦åˆ°è¾¾</span></span><br><span class="line">    <span class="keyword">if</span> (Distance_Slow_Down &lt; <span class="number">100</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    Distance_Slow_Down = <span class="number">0</span>; <span class="comment">// é‡ç½®å»¶æ—¶è®¡æ•°å™¨</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¯»å–è¶…å£°æ³¢æ¨¡å—æµ‹é‡çš„è·ç¦»</span></span><br><span class="line">    Distance_Val = Ut_Wave_Data();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é‡è¦æ³¨æ„äº‹é¡¹</strong>ï¼šåœ¨ <code>Ut_Wave_Data()</code> å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>EA = 0;</code> æ¥å…³é—­æ€»ä¸­æ–­ï¼Œä»¥ç¡®ä¿å‘é€8ä¸ªè„‰å†²çš„ç²¾ç¡®æ—¶åºã€‚<strong>åœ¨å‘é€å®Œæ¯•åï¼Œå¿…é¡»ç«‹å³ä½¿ç”¨ <code>EA = 1;</code> é‡æ–°å¼€å¯ä¸­æ–­</strong>ï¼Œå¦åˆ™ç¨‹åºä¸­ä¾èµ–ä¸­æ–­çš„éƒ¨åˆ†ï¼ˆå¦‚æ•°ç ç®¡åŠ¨æ€æ‰«æã€æŒ‰é”®æ£€æµ‹ç­‰ï¼‰å°†åœæ­¢å·¥ä½œï¼Œå¯¼è‡´ç³»ç»Ÿæ— å“åº”ã€‚</p><h2 id="äºŒã€æ ¸å¿ƒçŸ¥è¯†è¡¥å……ï¼šPCA-vs-æ™®é€šå®šæ—¶å™¨"><a href="#äºŒã€æ ¸å¿ƒçŸ¥è¯†è¡¥å……ï¼šPCA-vs-æ™®é€šå®šæ—¶å™¨" class="headerlink" title="äºŒã€æ ¸å¿ƒçŸ¥è¯†è¡¥å……ï¼šPCA vs. æ™®é€šå®šæ—¶å™¨"></a>äºŒã€æ ¸å¿ƒçŸ¥è¯†è¡¥å……ï¼šPCA vs. æ™®é€šå®šæ—¶å™¨</h2><p>ä»£ç ä¸­ä½¿ç”¨äº†STCå•ç‰‡æœºç‰¹æœ‰çš„PCAæ¨¡å—æ¥å®ç°è®¡æ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„å®è·µã€‚ä¸ºäº†æ›´æ·±å…¥åœ°ç†è§£ï¼Œæˆ‘ä»¬å°†å…¶ä¸æœ€å¸¸è§çš„æ™®é€šå®šæ—¶å™¨ï¼ˆå¦‚Timer 0ï¼‰è¿›è¡Œè¯¦ç»†å¯¹æ¯”ã€‚</p><h3 id="1-æ ¸å¿ƒæ€æƒ³ï¼šç‘å£«å†›åˆ€-vs-ä¸“ç”¨æ‰³æ‰‹"><a href="#1-æ ¸å¿ƒæ€æƒ³ï¼šç‘å£«å†›åˆ€-vs-ä¸“ç”¨æ‰³æ‰‹" class="headerlink" title="1. æ ¸å¿ƒæ€æƒ³ï¼šç‘å£«å†›åˆ€ vs. ä¸“ç”¨æ‰³æ‰‹"></a>1. æ ¸å¿ƒæ€æƒ³ï¼šç‘å£«å†›åˆ€ vs. ä¸“ç”¨æ‰³æ‰‹</h3><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å½¢è±¡çš„æ¯”å–»ï¼š</p><ul><li><strong>æ™®é€šå®šæ—¶å™¨</strong>ï¼šå°±åƒä¸€æŠŠ<strong>ä¸“ç”¨æ‰³æ‰‹</strong>ã€‚å®ƒéå¸¸æ“…é•¿åšä¸€ä»¶äº‹ï¼š<strong>å®šæ—¶&#x2F;è®¡æ•°</strong>ã€‚å½“ä½ éœ€è¦ä¸€ä¸ªå‘¨æœŸæ€§çš„ä¸­æ–­æ¥æ‰§è¡Œä»»åŠ¡æ—¶ï¼ˆå¦‚æ¯éš”1msåˆ·æ–°æ•°ç ç®¡ï¼‰ï¼Œå®ƒå°±æ˜¯æœ€ç›´æ¥ã€æœ€é«˜æ•ˆçš„é€‰æ‹©ã€‚</li><li><strong>PCAï¼ˆ<strong>P</strong>rogrammable <strong>C</strong>ounter <strong>A</strong>rrayï¼‰</strong>ï¼šå°±åƒä¸€æŠŠ<strong>ç‘å£«å†›åˆ€</strong>ã€‚å®ƒçš„æ ¸å¿ƒä¹Ÿæ˜¯ä¸€ä¸ªå®šæ—¶å™¨ï¼ˆä¸»è®¡æ•°å™¨ï¼‰ï¼Œä½†å®ƒè¿˜é›†æˆäº†å¤šä¸ªâ€œå°å·¥å…·â€ï¼ˆæ¯”è¾ƒ&#x2F;æ•è·æ¨¡å—ï¼‰ï¼Œä½¿å¾—å®ƒèƒ½å®ç°æ›´å¤æ‚çš„åŠŸèƒ½ã€‚</li><li>ä¸¤è€…æœ¬è´¨éƒ½æ˜¯<strong>è®¡æ•°å™¨</strong>ã€‚</li></ul><h3 id="2-åŠŸèƒ½å¯¹æ¯”"><a href="#2-åŠŸèƒ½å¯¹æ¯”" class="headerlink" title="2. åŠŸèƒ½å¯¹æ¯”"></a>2. åŠŸèƒ½å¯¹æ¯”</h3><table><thead><tr><th align="left">åŠŸèƒ½ç‰¹æ€§</th><th align="left">æ™®é€šå®šæ—¶å™¨ (Timer 0&#x2F;1)</th><th align="left">PCA (å¯ç¼–ç¨‹è®¡æ•°å™¨é˜µåˆ—)</th></tr></thead><tbody><tr><td align="left"><strong>åŸºæœ¬å®šæ—¶&#x2F;è®¡æ•°</strong></td><td align="left">âœ… <strong>æ ¸å¿ƒåŠŸèƒ½</strong></td><td align="left">âœ… <strong>æ ¸å¿ƒåŠŸèƒ½</strong></td></tr><tr><td align="left"><strong>å‘¨æœŸæ€§ä¸­æ–­</strong></td><td align="left">âœ… <strong>ç›´æ¥æ”¯æŒ</strong>ã€‚è®¾ç½®åˆå€¼ï¼Œæº¢å‡ºåè§¦å‘ä¸­æ–­ã€‚</td><td align="left">âœ… <strong>æ”¯æŒ</strong>ã€‚é€šè¿‡æº¢å‡ºæ ‡å¿—<code>CF</code>è§¦å‘ä¸­æ–­ã€‚</td></tr><tr><td align="left"><strong>PWMè¾“å‡º</strong></td><td align="left">âŒ <strong>æ— æ³•ç›´æ¥å®ç°</strong>ã€‚éœ€ç”¨è½¯ä»¶åœ¨ä¸­æ–­ä¸­æ¨¡æ‹Ÿï¼Œå ç”¨CPUï¼Œç²¾åº¦å·®ã€‚</td><td align="left">âœ… <strong>ç¡¬ä»¶è‡ªåŠ¨å®ç°</strong>ã€‚é…ç½®åï¼Œç¡¬ä»¶è‡ªåŠ¨è¾“å‡ºPWMæ³¢å½¢ï¼Œä¸å CPUã€‚</td></tr><tr><td align="left"><strong>è¾“å…¥æ•è·</strong></td><td align="left">âŒ <strong>æ— æ³•ç›´æ¥å®ç°</strong>ã€‚éœ€ç”¨å¤–éƒ¨ä¸­æ–­+å®šæ—¶å™¨ç»„åˆï¼Œé€»è¾‘å¤æ‚ã€‚</td><td align="left">âœ… <strong>ç¡¬ä»¶è‡ªåŠ¨å®ç°</strong>ã€‚å¯è‡ªåŠ¨æ•è·å¼•è„šç”µå¹³è·³å˜æ—¶åˆ»çš„è®¡æ•°å€¼ï¼Œå“åº”å¿«ã€‚</td></tr><tr><td align="left"><strong>è½¯ä»¶å®šæ—¶å™¨</strong></td><td align="left">âŒ <strong>æ— æ³•ç›´æ¥å®ç°</strong>ã€‚éœ€åœ¨ä¸»ç¨‹åºæˆ–ä¸­æ–­ä¸­ç»´æŠ¤å˜é‡ã€‚</td><td align="left">âœ… <strong>æ”¯æŒ</strong>ã€‚æ¯ä¸ªæ¯”è¾ƒæ¨¡å—éƒ½å¯è®¾ä¸ºç‹¬ç«‹çš„è½¯ä»¶å®šæ—¶å™¨ã€‚</td></tr></tbody></table><h3 id="3-å¯„å­˜å™¨å¯¹æ¯”"><a href="#3-å¯„å­˜å™¨å¯¹æ¯”" class="headerlink" title="3. å¯„å­˜å™¨å¯¹æ¯”"></a>3. å¯„å­˜å™¨å¯¹æ¯”</h3><p>ä½ çš„ä»£ç ä¸­ï¼Œä¸¤ç§å®šæ—¶å™¨ä½¿ç”¨äº†å®Œå…¨ä¸åŒçš„å¯„å­˜å™¨é›†ï¼Œè¿™è¯æ˜äº†å®ƒä»¬æ˜¯ç‹¬ç«‹çš„ç¡¬ä»¶æ¨¡å—ã€‚</p><table><thead><tr><th align="left">ä½œç”¨</th><th align="left">æ™®é€šå®šæ—¶å™¨ (ä»¥Timer 0ä¸ºä¾‹)</th><th align="left">PCA</th></tr></thead><tbody><tr><td align="left"><strong>æ¨¡å¼é…ç½®</strong></td><td align="left"><code>TMOD</code> (è®¾ç½®16ä½&#x2F;8ä½æ¨¡å¼) <code>AUXR</code> (è®¾ç½®12T&#x2F;1Tæ—¶é’Ÿ)</td><td align="left"><code>CMOD</code> (è®¾ç½®æ—¶é’Ÿæºã€ä¸­æ–­ä½¿èƒ½)</td></tr><tr><td align="left"><strong>è®¡æ•°å™¨å€¼</strong></td><td align="left"><code>TH0</code>, <code>TL0</code> (é«˜&#x2F;ä½å­—èŠ‚)</td><td align="left"><code>CH</code>, <code>CL</code> (é«˜&#x2F;ä½å­—èŠ‚)</td></tr><tr><td align="left"><strong>å¯åœæ§åˆ¶</strong></td><td align="left"><code>TR0</code> (Run control bit)</td><td align="left"><code>CR</code> (Run control bit)</td></tr><tr><td align="left"><strong>æº¢å‡ºæ ‡å¿—</strong></td><td align="left"><code>TF0</code> (Overflow Flag)</td><td align="left"><code>CF</code> (Counter Overflow Flag)</td></tr><tr><td align="left"><strong>ä¸­æ–­æ§åˆ¶</strong></td><td align="left"><code>ET0</code> (Timer 0 Interrupt Enable)</td><td align="left">PCAæœ‰ç‹¬ç«‹çš„ä¸­æ–­ä½¿èƒ½ä½</td></tr></tbody></table><h3 id="4-åœ¨ä½ çš„è¶…å£°æ³¢æµ‹è·ä»£ç ä¸­çš„åº”ç”¨åˆ†æ"><a href="#4-åœ¨ä½ çš„è¶…å£°æ³¢æµ‹è·ä»£ç ä¸­çš„åº”ç”¨åˆ†æ" class="headerlink" title="4. åœ¨ä½ çš„è¶…å£°æ³¢æµ‹è·ä»£ç ä¸­çš„åº”ç”¨åˆ†æ"></a>4. åœ¨ä½ çš„è¶…å£°æ³¢æµ‹è·ä»£ç ä¸­çš„åº”ç”¨åˆ†æ</h3><p>ç°åœ¨æˆ‘ä»¬å›å¤´çœ‹ä½ çš„ <code>Ut_Wave_Data()</code> å‡½æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// ...</span><br><span class="line">CH = 0; CL = 0;   // æ¸…ç©ºPCAè®¡æ•°å™¨</span><br><span class="line">CMOD = 0x00;      // é…ç½®PCA</span><br><span class="line">CR = 1;           // å¯åŠ¨PCA</span><br><span class="line">while (Rx &amp;&amp; !CF); // è½®è¯¢ç­‰å¾…</span><br><span class="line">CR = 0;           // åœæ­¢PCA</span><br><span class="line">time = CH &lt;&lt; 8 | CL; // è¯»å–è®¡æ•°å€¼</span><br><span class="line">// ...</span><br></pre></td></tr></table></figure><ul><li><strong>ä»£ç ä¸­ç”¨åˆ°äº†PCAçš„ä»€ä¹ˆåŠŸèƒ½ï¼Ÿ</strong><br>ä½ åªç”¨äº†PCAæœ€åŸºç¡€çš„åŠŸèƒ½ï¼š<strong>æŠŠå®ƒå½“ä½œä¸€ä¸ª16ä½çš„ã€ä»0å¼€å§‹è®¡æ—¶çš„ç§’è¡¨</strong>ã€‚ä½ é€šè¿‡è½®è¯¢<code>CF</code>æ ‡å¿—ä½æ¥å®ç°è¶…æ—¶æ£€æµ‹ã€‚</li><li><strong>èƒ½ç”¨æ™®é€šå®šæ—¶å™¨å®ç°å—ï¼Ÿ</strong><br><strong>å®Œå…¨å¯ä»¥ï¼</strong> è€Œä¸”è¿™æ˜¯æ›´å¸¸è§„çš„åšæ³•ã€‚ä½¿ç”¨Timer 0çš„ä»£ç é€»è¾‘å‡ ä¹å®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯æ¢ä¸€å¥—å¯„å­˜å™¨è€Œå·²ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// ä½¿ç”¨Timer 0çš„ä¼ªä»£ç </span><br><span class="line">TMOD = 0x01;    // 16ä½å®šæ—¶å™¨æ¨¡å¼</span><br><span class="line">TH0 = 0; TL0 = 0; // ä»0å¼€å§‹è®¡æ—¶</span><br><span class="line">TF0 = 0;        // æ¸…é™¤æº¢å‡ºæ ‡å¿—</span><br><span class="line">TR0 = 1;        // å¯åŠ¨Timer 0</span><br><span class="line">while (Rx &amp;&amp; !TF0); // è½®è¯¢ç­‰å¾…</span><br><span class="line">TR0 = 0;        // åœæ­¢Timer 0</span><br><span class="line">time = TH0 &lt;&lt; 8 | TL0; // è¯»å–è®¡æ•°å€¼</span><br><span class="line">// ...</span><br></pre></td></tr></table></figure><h3 id="5-å¦‚ä½•é€‰æ‹©ï¼Ÿ"><a href="#5-å¦‚ä½•é€‰æ‹©ï¼Ÿ" class="headerlink" title="5. å¦‚ä½•é€‰æ‹©ï¼Ÿ"></a>5. å¦‚ä½•é€‰æ‹©ï¼Ÿ</h3><ul><li><strong>é€‰æ‹©æ™®é€šå®šæ—¶å™¨</strong>ï¼šå½“ä½ çš„éœ€æ±‚ä»…ä»…æ˜¯<strong>å®šæ—¶ã€å»¶æ—¶ã€æˆ–è€…æµ‹é‡ä¸€ä¸ªæ—¶é—´é•¿åº¦</strong>æ—¶ï¼Œä½¿ç”¨Timer 0æˆ–Timer 1æ˜¯é¦–é€‰ã€‚å®ƒæ›´ç®€å•ã€é€šç”¨ï¼Œä»£ç ç§»æ¤æ€§ä¹Ÿæ›´å¥½ã€‚</li><li><strong>é€‰æ‹©PCA</strong>ï¼šå½“ä½ çš„é¡¹ç›®éœ€è¦<strong>åŒæ—¶å®ç°å¤šç§åŠŸèƒ½</strong>æ—¶ï¼ŒPCAçš„ä¼˜åŠ¿å°±ä½“ç°å‡ºæ¥äº†ã€‚ä¾‹å¦‚ï¼Œä½ çš„é¡¹ç›®æ—¢è¦è¶…å£°æ³¢æµ‹è·ï¼Œåˆè¦ç”¨PWMæ§åˆ¶ç”µæœºè½¬é€Ÿï¼Œè¿™æ—¶ç”¨PCAçš„æ•è·æ¨¡å—æµ‹è·ï¼Œç”¨å¦ä¸€ä¸ªæ¨¡å—è¾“å‡ºPWMï¼Œå°±èƒ½é«˜æ•ˆåœ°å®Œæˆä»»åŠ¡ï¼Œè€ŒæŠŠæ™®é€šçš„Timer 0ç•™ç»™ç³»ç»Ÿæ—¶é’ŸèŠ‚æ‹ç­‰å…³é”®ä»»åŠ¡ã€‚</li></ul><p><strong>ç»“è®º</strong>ï¼šåœ¨ä½ çš„è¶…å£°æ³¢æµ‹è·ä»£ç ä¸­ï¼Œä½ ä½¿ç”¨äº†PCAçš„â€œç‘å£«å†›åˆ€â€æ¥åˆ‡è‹¹æœï¼ˆåšåŸºæœ¬è®¡æ—¶ï¼‰ï¼Œè¿™æ˜¯å®Œå…¨å¯è¡Œçš„ã€‚ä½†äº†è§£æ™®é€šå®šæ—¶å™¨è¿™æŠŠâ€œä¸“ç”¨æ‰³æ‰‹â€åŒæ ·èƒ½èƒœä»»ï¼Œå¹¶ä¸”çŸ¥é“å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Œèƒ½å¸®åŠ©ä½ åœ¨æœªæ¥çš„é¡¹ç›®ä¸­åšå‡ºæ›´åˆç†çš„è®¾è®¡é€‰æ‹©ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è¶…å£°æ³¢æµ‹è·&quot;&gt;&lt;a href=&quot;#è¶…å£°æ³¢æµ‹è·&quot; class=&quot;headerlink&quot; title=&quot;è¶…å£°æ³¢æµ‹è·&quot;&gt;&lt;/a&gt;è¶…å£°æ³¢æµ‹è·&lt;/h1&gt;&lt;h2 id=&quot;ä¸€ã€è¶…å£°æ³¢æµ‹è·åŸç†ä¸å®ç°&quot;&gt;&lt;a href=&quot;#ä¸€ã€è¶…å£°æ³¢æµ‹è·åŸç†ä¸å®ç°&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>2.æ•°ç ç®¡å’Œå®šæ—¶å™¨</title>
    <link href="https://roselin1217.github.io/2025/11/24/2.%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA%E5%8E%9F%E7%90%86%E4%B8%8E%E5%8A%A8%E6%80%81%E6%89%AB%E6%8F%8F%E5%AE%9E%E7%8E%B0/"/>
    <id>https://roselin1217.github.io/2025/11/24/2.%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA%E5%8E%9F%E7%90%86%E4%B8%8E%E5%8A%A8%E6%80%81%E6%89%AB%E6%8F%8F%E5%AE%9E%E7%8E%B0/</id>
    <published>2025-11-24T02:00:00.000Z</published>
    <updated>2025-11-28T10:22:15.320Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ•°ç ç®¡å’Œå®šæ—¶å™¨"><a href="#æ•°ç ç®¡å’Œå®šæ—¶å™¨" class="headerlink" title="**æ•°ç ç®¡å’Œå®šæ—¶å™¨ **"></a>**æ•°ç ç®¡å’Œå®šæ—¶å™¨ **</h1><h2 id="ä¸€ã€æ•°ç ç®¡åŸºæœ¬åŸç†"><a href="#ä¸€ã€æ•°ç ç®¡åŸºæœ¬åŸç†" class="headerlink" title="ä¸€ã€æ•°ç ç®¡åŸºæœ¬åŸç†"></a>ä¸€ã€æ•°ç ç®¡åŸºæœ¬åŸç†</h2><h3 id="1-æ•°ç ç®¡ç»“æ„"><a href="#1-æ•°ç ç®¡ç»“æ„" class="headerlink" title="1. æ•°ç ç®¡ç»“æ„"></a>1. æ•°ç ç®¡ç»“æ„</h3><p>æ•°ç ç®¡æœ¬è´¨ä¸Šæ˜¯ç”±<strong>8ä¸ªLEDæ®µ</strong>ï¼ˆa<del>g + å°æ•°ç‚¹dpï¼‰ç»„åˆè€Œæˆçš„æ˜¾ç¤ºå™¨ä»¶ï¼Œç”¨äºæ˜¾ç¤ºæ•°å­—0</del>9åŠéƒ¨åˆ†å­—æ¯ã€‚</p><p>æ ¹æ®å†…éƒ¨è¿æ¥æ–¹å¼ï¼Œå¯åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š</p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251110230550029.png" style="zoom: 67%;" /><table><thead><tr><th>ç±»å‹</th><th>é˜³æè¿æ¥</th><th>é˜´æè¿æ¥</th><th>æ§åˆ¶æ–¹å¼</th><th>äº®ç­é€»è¾‘</th></tr></thead><tbody><tr><td><strong>å…±é˜³ææ•°ç ç®¡</strong></td><td>æ‰€æœ‰LEDé˜³æè¿åœ¨ä¸€èµ·æ¥VCC</td><td>æ¯æ®µç‹¬ç«‹æ¥é©±åŠ¨ç”µè·¯</td><td>æ§åˆ¶<strong>é˜´æç”µå¹³</strong></td><td><strong>0äº®ï¼Œ1ç­</strong></td></tr><tr><td><strong>å…±é˜´ææ•°ç ç®¡</strong></td><td>æ¯æ®µç‹¬ç«‹æ¥é©±åŠ¨ç”µè·¯</td><td>æ‰€æœ‰LEDé˜´æè¿åœ¨ä¸€èµ·æ¥åœ°</td><td>æ§åˆ¶<strong>é˜³æç”µå¹³</strong></td><td><strong>1äº®ï¼Œ0ç­</strong></td></tr></tbody></table><blockquote><p>âœ… <strong>æœ¬ç³»ç»Ÿä½¿ç”¨çš„æ˜¯å…±é˜³ææ•°ç ç®¡</strong>ï¼ˆæ ¹æ®ç”µè·¯å›¾ä¸ä»£ç ä¸­<code>0xc0, 0xf9...</code>æ¨æ–­ï¼‰<br>å› æ­¤ï¼š<strong>è¾“å‡ºä½ç”µå¹³ â†’ æ®µç‚¹äº®ï¼›è¾“å‡ºé«˜ç”µå¹³ â†’ æ®µç†„ç­</strong></p></blockquote><h3 id="2-æ®µç è¡¨ï¼ˆå…±é˜³ææ•°ç ç®¡ï¼‰"><a href="#2-æ®µç è¡¨ï¼ˆå…±é˜³ææ•°ç ç®¡ï¼‰" class="headerlink" title="2. æ®µç è¡¨ï¼ˆå…±é˜³ææ•°ç ç®¡ï¼‰"></a>2. æ®µç è¡¨ï¼ˆå…±é˜³ææ•°ç ç®¡ï¼‰</h3><h3 id="3-ä»€ä¹ˆæ˜¯â€œæ¶ˆå½±â€ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"><a href="#3-ä»€ä¹ˆæ˜¯â€œæ¶ˆå½±â€ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="3. ä»€ä¹ˆæ˜¯â€œæ¶ˆå½±â€ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"></a>3. ä»€ä¹ˆæ˜¯â€œæ¶ˆå½±â€ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</h3><h4 id="â“-ä»€ä¹ˆæ˜¯æ¶ˆå½±ï¼Ÿ"><a href="#â“-ä»€ä¹ˆæ˜¯æ¶ˆå½±ï¼Ÿ" class="headerlink" title="â“ ä»€ä¹ˆæ˜¯æ¶ˆå½±ï¼Ÿ"></a>â“ ä»€ä¹ˆæ˜¯æ¶ˆå½±ï¼Ÿ</h4><p>åœ¨<strong>åŠ¨æ€æ‰«ææ˜¾ç¤º</strong>ä¸­ï¼Œå½“ä»ä¸€ä¸ªæ•°ç ç®¡åˆ‡æ¢åˆ°å¦ä¸€ä¸ªæ—¶ï¼Œç”±äº<strong>æ®µç æ•°æ®æå‰åŠ è½½</strong>æˆ–<strong>ä½é€‰ä¿¡å·å»¶è¿Ÿå…³é—­</strong>ï¼Œä¼šå¯¼è‡´å‰ä¸€ä¸ªæ•°ç ç®¡åœ¨åˆ‡æ¢ç¬é—´ä»æœ‰æ®‹å½±ï¼ˆéƒ¨åˆ†æ®µå¾®äº®ï¼‰ï¼Œè¿™ç§ç°è±¡ç§°ä¸º**â€œæ¶ˆå½±â€**ï¼ˆæˆ–â€œé¬¼å½±â€ï¼‰ã€‚</p><h4 id="âœ…-æ¶ˆå½±äº§ç”Ÿçš„åŸå› ï¼š"><a href="#âœ…-æ¶ˆå½±äº§ç”Ÿçš„åŸå› ï¼š" class="headerlink" title="âœ… æ¶ˆå½±äº§ç”Ÿçš„åŸå› ï¼š"></a>âœ… æ¶ˆå½±äº§ç”Ÿçš„åŸå› ï¼š</h4><ul><li>ä½é€‰ï¼ˆé€‰ä¸­å“ªä¸ªæ•°ç ç®¡ï¼‰ä¸æ®µé€‰ï¼ˆæ˜¾ç¤ºä»€ä¹ˆæ•°å­—ï¼‰æœªä¸¥æ ¼åŒæ­¥ï¼›</li><li>æ®µç æ•°æ®å†™å…¥åï¼Œæœªå…ˆå…³é—­æ‰€æœ‰ä½é€‰å°±åˆ‡æ¢ï¼Œé€ æˆçŸ­æš‚é‡å ã€‚</li></ul><h4 id="ğŸ”§-è§£å†³æ–¹æ³•ï¼š"><a href="#ğŸ”§-è§£å†³æ–¹æ³•ï¼š" class="headerlink" title="ğŸ”§ è§£å†³æ–¹æ³•ï¼š"></a>ğŸ”§ è§£å†³æ–¹æ³•ï¼š</h4><blockquote><p><strong>â€œå…ˆå…³ä½é€‰ â†’ å†é€æ®µç  â†’ å†å¼€ä½é€‰â€</strong><br>å³ï¼š<strong>æ¶ˆå½±ä¸‰æ­¥æ³•</strong></p><ol><li>å…ˆå…³é—­æ‰€æœ‰æ•°ç ç®¡ï¼ˆP0 &#x3D; 0xFFï¼Œæ®µç å…¨ç­ï¼‰</li><li>å†è¿›è¡Œä½é€‰ï¼ˆé€‰ä¸­è¦æ˜¾ç¤ºçš„æ•°ç ç®¡ï¼‰</li><li>æœ€åå†™å…¥æ®µç å¹¶é”å­˜</li></ol></blockquote><blockquote><p>âœ… æœ¬ç³»ç»Ÿé€šè¿‡åœ¨æ¯æ¬¡æ˜¾ç¤ºå‰å…ˆæ‰§è¡Œä¸€æ¬¡**â€œå…¨ç­â€æ“ä½œ**ï¼Œæœ‰æ•ˆæ¶ˆé™¤é¬¼å½±ã€‚</p></blockquote><hr><h2 id="äºŒã€æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºåŸç†"><a href="#äºŒã€æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºåŸç†" class="headerlink" title="äºŒã€æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºåŸç†"></a>äºŒã€æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºåŸç†</h2><h3 id="ğŸ¯-åŸç†æ¦‚è¿°"><a href="#ğŸ¯-åŸç†æ¦‚è¿°" class="headerlink" title="ğŸ¯ åŸç†æ¦‚è¿°"></a>ğŸ¯ åŸç†æ¦‚è¿°</h3><p>åŠ¨æ€æ˜¾ç¤ºæ˜¯æŒ‡<strong>å¤šä¸ªæ•°ç ç®¡è½®æµç‚¹äº®</strong>ï¼Œåˆ©ç”¨äººçœ¼çš„<strong>è§†è§‰æš‚ç•™æ•ˆåº”</strong>ï¼ˆçº¦10~40msï¼‰ï¼Œåœ¨å¿«é€Ÿåˆ‡æ¢ä¸‹äº§ç”Ÿâ€œåŒæ—¶ç‚¹äº®â€çš„é”™è§‰ã€‚</p><ul><li><p><strong>åˆ·æ–°é¢‘ç‡å»ºè®®</strong>ï¼š&gt; 50Hzï¼ˆå³æ¯50msåˆ·æ–°ä¸€æ¬¡ï¼‰ï¼Œäººçœ¼æ— é—ªçƒã€‚</p></li><li><p><strong>æ¯ä¸ªæ•°ç ç®¡ç‚¹äº®æ—¶é—´</strong>ï¼šçº¦ 1~5ms</p></li><li><p><strong>ä¼˜ç‚¹</strong>ï¼šèŠ‚çœIOå£ã€åŠŸè€—ä½ã€ç”µè·¯ç®€å•</p></li><li><p><strong>ç¼ºç‚¹</strong>ï¼šéœ€ç¨‹åºå®šæ—¶åˆ·æ–°ï¼Œå ç”¨CPUèµ„æº</p></li></ul><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251110230743404.png"></p><h3 id="âœ…-åŠ¨æ€æ‰«æå®ç°æ­¥éª¤"><a href="#âœ…-åŠ¨æ€æ‰«æå®ç°æ­¥éª¤" class="headerlink" title="âœ… åŠ¨æ€æ‰«æå®ç°æ­¥éª¤"></a>âœ… åŠ¨æ€æ‰«æå®ç°æ­¥éª¤</h3><blockquote><p><strong>â€œæ¶ˆå½± â†’ ä½é€‰ â†’ æ®µé€‰â€</strong></p></blockquote><table><thead><tr><th>æ­¥éª¤</th><th>æ“ä½œ</th><th>ç›®çš„</th></tr></thead><tbody><tr><td>1. æ¶ˆå½±</td><td>P0 &#x3D; 0xFF + é”å­˜</td><td>å…³é—­æ‰€æœ‰æ®µï¼Œé¿å…æ®‹å½±</td></tr><tr><td>2. ä½é€‰</td><td>é€‰ä¸­æŸä¸ªæ•°ç ç®¡ï¼ˆå¦‚ç¬¬3ä½ï¼‰</td><td>è®©ç”µæµåªæµè¿‡è¯¥æ•°ç ç®¡</td></tr><tr><td>3. æ®µé€‰</td><td>å†™å…¥å¯¹åº”æ•°å­—çš„æ®µç </td><td>æ˜¾ç¤ºæ‰€éœ€æ•°å­—</td></tr></tbody></table><blockquote><p>ğŸ’¡ <strong>æ³¨æ„</strong>ï¼šä½é€‰ä¸æ®µé€‰éœ€åˆ†åˆ«é€šè¿‡<strong>ä¸åŒçš„é”å­˜å™¨</strong>æ§åˆ¶ï¼ˆæœ¬ç³»ç»Ÿä½¿ç”¨ä¸¤ä¸ªé”å­˜å™¨ï¼šä¸€ä¸ªæ§åˆ¶ä½é€‰ã€ä¸€ä¸ªæ§åˆ¶æ®µé€‰ï¼‰</p></blockquote><hr><h2 id="ä¸‰ã€ç¡¬ä»¶è¿æ¥è¯´æ˜"><a href="#ä¸‰ã€ç¡¬ä»¶è¿æ¥è¯´æ˜" class="headerlink" title="ä¸‰ã€ç¡¬ä»¶è¿æ¥è¯´æ˜"></a>ä¸‰ã€ç¡¬ä»¶è¿æ¥è¯´æ˜</h2><ul><li><strong>P0å£</strong>ï¼šè¾“å‡ºæ®µç ä¸ä½é€‰ä¿¡å·ï¼ˆå…±ç”¨ï¼‰</li><li>P2å£:æ§åˆ¶é”å­˜å™¨ä½¿èƒ½ç«¯<ul><li><code>P2.5</code> æ§åˆ¶<strong>æ®µé€‰é”å­˜å™¨</strong>ï¼ˆLE &#x3D; Y6C ï¼ˆ110ï¼‰ï¼Œç”±Y6é€‰é€šï¼‰  </li><li><code>P2.7</code> æ§åˆ¶<strong>ä½é€‰é”å­˜å™¨</strong>ï¼ˆLE &#x3D; Y7Cï¼ˆ111ï¼‰ï¼Œç”±Y7é€‰é€šï¼‰</li></ul></li><li><strong>Y4~Y7</strong>ï¼šç”±74HC138è¯‘ç å™¨è¾“å‡ºï¼Œç”¨äºé€‰é€šä¸åŒé”å­˜å™¨</li></ul><blockquote><p>âœ… <strong>æ®µé€‰é”å­˜å™¨ä½¿èƒ½</strong>ï¼šé€‰ä¸­ Y6 â†’ Y6&#x3D;0 â†’ Y6C&#x3D;1 â†’ æ®µé€‰é”å­˜å™¨æ‰“å¼€<br>âœ… <strong>ä½é€‰é”å­˜å™¨ä½¿èƒ½</strong>ï¼šé€‰ä¸­ Y7 â†’ Y7&#x3D;0 â†’ Y7C&#x3D;1 â†’ ä½é€‰é”å­˜å™¨æ‰“å¼€</p></blockquote><hr><h2 id="å››ã€å®Œæ•´ä»£ç å®ç°ï¼ˆå¸¦è¯¦ç»†æ³¨é‡Šï¼‰"><a href="#å››ã€å®Œæ•´ä»£ç å®ç°ï¼ˆå¸¦è¯¦ç»†æ³¨é‡Šï¼‰" class="headerlink" title="å››ã€å®Œæ•´ä»£ç å®ç°ï¼ˆå¸¦è¯¦ç»†æ³¨é‡Šï¼‰"></a>å››ã€å®Œæ•´ä»£ç å®ç°ï¼ˆå¸¦è¯¦ç»†æ³¨é‡Šï¼‰</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">unsigned char seg_dula[] = &#123;0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90,0xff,0xbf,0xc6&#125;;</span><br><span class="line">unsigned char seg_wela[] = &#123;0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80&#125;;</span><br><span class="line"></span><br><span class="line">// å‡½æ•°åï¼šæ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºå‡½æ•°</span><br><span class="line">// å…¥å£å‚æ•°ï¼š</span><br><span class="line">//   welaï¼šä½é€‰ç´¢å¼•ï¼ˆ0~7ï¼‰ï¼Œè¡¨ç¤ºç¬¬å‡ ä¸ªæ•°ç ç®¡ï¼ˆä»å³åˆ°å·¦ï¼‰</span><br><span class="line">//   dulaï¼šæ®µé€‰æ•°å­—ï¼ˆ0~9ï¼‰ï¼Œè¡¨ç¤ºè¦æ˜¾ç¤ºçš„æ•°å­—</span><br><span class="line">//   pointï¼šæ˜¯å¦ç‚¹äº®å°æ•°ç‚¹ï¼ˆ1=ç‚¹äº®ï¼Œ0=ä¸ç‚¹äº®ï¼‰</span><br><span class="line">// è¿”å›å€¼ï¼šæ— </span><br><span class="line">// åŠŸèƒ½ï¼šé€šè¿‡åŠ¨æ€æ‰«ææ˜¾ç¤ºä¸€ä¸ªæ•°å­—ï¼Œæ”¯æŒå°æ•°ç‚¹ï¼Œè‡ªåŠ¨æ¶ˆå½±</span><br><span class="line"></span><br><span class="line">void seg_disp(unsigned char wela, unsigned char dula, unsigned char point)</span><br><span class="line">&#123;</span><br><span class="line">    // ç¬¬ä¸€æ­¥ï¼šæ¶ˆå½± â€”â€” å…ˆå…³é—­æ‰€æœ‰æ•°ç ç®¡ï¼ˆé¿å…æ®‹å½±ï¼‰</span><br><span class="line">    // å°†P0è®¾ä¸ºå…¨é«˜ï¼ˆ0xFFï¼‰â†’ æ‰€æœ‰æ®µç­</span><br><span class="line">    P0 = 0xFF;</span><br><span class="line"></span><br><span class="line">    // é”å­˜å™¨ä½¿èƒ½ï¼šé€‰ä¸­Y7ï¼ˆP2.7=1, P2.6=1, P2.5=1, P2.4=0 â†’ Y7=0ï¼Œä½¿èƒ½ä½é€‰é”å­˜å™¨ï¼‰</span><br><span class="line">    // P2 = P2 &amp; 0x1F | 0xE0; â†’ ä¿ç•™ä½5ä½ï¼Œé«˜ä¸‰ä½è®¾ä¸º111 â†’ 1110 0000 = 0xE0</span><br><span class="line">    P2 = P2 &amp; 0x1F | 0xE0;</span><br><span class="line">    </span><br><span class="line">    // é”å­˜ï¼šæ‹‰ä½LE â†’ ä¿æŒå…¨ç­çŠ¶æ€</span><br><span class="line">    P2 &amp;= 0x1F;</span><br><span class="line"></span><br><span class="line">    // ç¬¬äºŒæ­¥ï¼šä½é€‰ â€”â€” é€‰ä¸­è¦æ˜¾ç¤ºçš„æ•°ç ç®¡ï¼ˆå¦‚ç¬¬3ä½ï¼‰</span><br><span class="line">    P0 = seg_wela[wela];  // å†™å…¥ä½é€‰ç ï¼ˆä½ç”µå¹³æœ‰æ•ˆï¼‰</span><br><span class="line"></span><br><span class="line">    // ä½¿èƒ½ä½é€‰é”å­˜å™¨ï¼ˆY7é€‰é€šï¼‰â†’ Y7=0 â†’ Y7C=1 â†’ æ‰“å¼€é”å­˜å™¨</span><br><span class="line">    P2 = P2 &amp; 0x1F | 0xE0;</span><br><span class="line">    </span><br><span class="line">    // é”å­˜ä½é€‰ä¿¡å·</span><br><span class="line">    P2 &amp;= 0x1F;</span><br><span class="line"></span><br><span class="line">    // ç¬¬ä¸‰æ­¥ï¼šæ®µé€‰ â€”â€” è®¾ç½®è¦æ˜¾ç¤ºçš„æ•°å­—</span><br><span class="line">    P0 = seg_dula[dula];  // å†™å…¥æ®µç </span><br><span class="line"></span><br><span class="line">    // å¦‚æœéœ€è¦æ˜¾ç¤ºå°æ•°ç‚¹</span><br><span class="line">    if(point)</span><br><span class="line">        P0 &amp;= 0x7F;  // å°†dpä½ï¼ˆç¬¬7ä½ï¼‰ç½®0ï¼Œç‚¹äº®å°æ•°ç‚¹ï¼ˆå…±é˜³æï¼š0äº®ï¼‰</span><br><span class="line"></span><br><span class="line">    // ä½¿èƒ½æ®µé€‰é”å­˜å™¨ï¼ˆé€‰ä¸­Y6 â†’ P2.5=1, P2.6=1, P2.7=1 â†’ Y6=0 â†’ Y6C=1ï¼‰</span><br><span class="line">    // æ³¨æ„ï¼šæ­¤æ—¶P2.7ä»ä¸º1ï¼Œä½†é”å­˜å™¨æ˜¯Y6æ§åˆ¶çš„ï¼Œä¸å½±å“</span><br><span class="line">    P2 = P2 &amp; 0x1F | 0xC0;  // 0xC0 = 1100 0000 â†’ è®¾ç½®P2.7=1, P2.6=1, P2.5=0 â†’ é€‰Y6</span><br><span class="line">    P2 &amp;= 0x1F;  // é”å­˜æ®µç </span><br><span class="line"></span><br><span class="line">    // âœ… å®Œæˆä¸€æ¬¡æ˜¾ç¤º</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šæ—¶å™¨</p><p>1.åœ¨STC-ISPä¸Šç”Ÿæˆåˆå§‹åŒ–å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">void Timer0Init(void)</span><br><span class="line">&#123;</span><br><span class="line">AUXR &amp;= 0x7F;</span><br><span class="line">TMOD &amp;= 0xF0;</span><br><span class="line">TL0 = 0x18;</span><br><span class="line">TH0 = 0xFC;</span><br><span class="line">TF0 = 0;</span><br><span class="line">TR0 = 1;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ET0 = 1; //æ‰“å¼€å®šæ—¶å™¨0ä¸­æ–­ ï¼ˆEnable Timer 0 Interruptï¼‰</span><br><span class="line">EA = 1; //æ‰“å¼€æ€»ä¸­æ–­  ï¼ˆEnable All interruptsï¼‰</span><br></pre></td></tr></table></figure><p>2.ç¼–å†™ä¸­æ–­æœåŠ¡å‡½æ•°:</p><p>åªéœ€è¦åœ¨æ™®é€šå‡½æ•°ååŠ  interrupt num<br>numè¶Šå¤§ï¼Œä¸­æ–­ä¼˜å…ˆçº§è¶Šä½ï¼Œå½“ä¸­æ–­åŒæ—¶å‘ç”Ÿï¼Œä¼˜å…ˆçº§é«˜çš„å…ˆè¿›è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">unsigned char seg_pos;</span><br><span class="line">unsigned char seg_buf[8] =&#123;10,10,10,10,10,10,10,10&#125;;</span><br><span class="line">unsigned char seg_point[8] =&#123;0&#125;;</span><br><span class="line"></span><br><span class="line">void Timer0Init interrupt 1</span><br><span class="line">&#123;</span><br><span class="line"> if(++seg_pos == 8) seg_pos = 0;</span><br><span class="line"> Seg_Disp(Seg_Pos,Seg_Buf[Seg_Pos],Seg_Point[Seg_Pos]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº”ã€å®šæ—¶å™¨0ä¸­æ–­ç³»ç»Ÿï¼ˆå®ç°è‡ªåŠ¨åŠ¨æ€æ‰«æï¼‰"><a href="#äº”ã€å®šæ—¶å™¨0ä¸­æ–­ç³»ç»Ÿï¼ˆå®ç°è‡ªåŠ¨åŠ¨æ€æ‰«æï¼‰" class="headerlink" title="äº”ã€å®šæ—¶å™¨0ä¸­æ–­ç³»ç»Ÿï¼ˆå®ç°è‡ªåŠ¨åŠ¨æ€æ‰«æï¼‰"></a>äº”ã€å®šæ—¶å™¨0ä¸­æ–­ç³»ç»Ÿï¼ˆå®ç°è‡ªåŠ¨åŠ¨æ€æ‰«æï¼‰</h2><h3 id="1-å®šæ—¶å™¨0åˆå§‹åŒ–ï¼ˆ1mså®šæ—¶ï¼Œç”¨äºåˆ·æ–°æ•°ç ç®¡ï¼‰"><a href="#1-å®šæ—¶å™¨0åˆå§‹åŒ–ï¼ˆ1mså®šæ—¶ï¼Œç”¨äºåˆ·æ–°æ•°ç ç®¡ï¼‰" class="headerlink" title="1. å®šæ—¶å™¨0åˆå§‹åŒ–ï¼ˆ1mså®šæ—¶ï¼Œç”¨äºåˆ·æ–°æ•°ç ç®¡ï¼‰"></a><strong>1. å®šæ—¶å™¨0åˆå§‹åŒ–ï¼ˆ1mså®šæ—¶ï¼Œç”¨äºåˆ·æ–°æ•°ç ç®¡ï¼‰</strong></h3><p>(**æ˜“é”™ç‚¹)**<strong>å®šä¹‰æ—¶é—´å˜é‡ å¸¸ç”¨ <code>unsigned int</code></strong> </p><p>intï¼ˆ <strong>integer</strong>ï¼ˆæ•´æ•°ï¼‰ï¼‰ï¼š<strong>16 ä½</strong>ï¼ˆ2 å­—èŠ‚ï¼‰</p><p>å–å€¼èŒƒå›´ï¼š2^16&#x3D;65535</p><p><code>char</code> ï¼ˆ <strong>characterï¼ˆå­—ç¬¦ï¼‰</strong>ï¼‰ï¼šæ˜¯ <strong>1 å­—èŠ‚ï¼ˆ8 ä½ï¼‰</strong> </p><p>å–å€¼èŒƒå›´ï¼š2^8 &#x3D;255</p><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251110230848799.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// å‡½æ•°åï¼šå®šæ—¶å™¨0åˆå§‹åŒ–</span><br><span class="line">// åŠŸèƒ½ï¼šé…ç½®å®šæ—¶å™¨0ä¸ºæ¨¡å¼1ï¼ˆ16ä½å®šæ—¶ï¼‰ï¼Œæ¯1msäº§ç”Ÿä¸€æ¬¡ä¸­æ–­</span><br><span class="line">// æ™¶æŒ¯ï¼š12MHz â†’ æœºå™¨å‘¨æœŸï¼š1Î¼s</span><br><span class="line">// å®šæ—¶1ms â†’ è®¡æ•°å€¼ = 1000</span><br><span class="line">// å®šæ—¶å™¨è®¡æ•° = 65536 - 1000 = 64536 = 0xFC18</span><br><span class="line">// TH0 = 0xFC, TL0 = 0x18</span><br><span class="line"></span><br><span class="line">void Timer0Init(void)</span><br><span class="line">&#123;</span><br><span class="line">    AUXR &amp;= 0x7F;     // è®¾ç½®å®šæ—¶å™¨0ä¸º1Tæ¨¡å¼ï¼ˆSTCä¸“ç”¨ï¼ŒåŠ é€Ÿï¼‰</span><br><span class="line">    TMOD &amp;= 0xF0;     // æ¸…é™¤T0æ¨¡å¼ä½ï¼Œä¿ç•™T1</span><br><span class="line">    TL0 = 0x18;       // ä½8ä½åˆå€¼</span><br><span class="line">    TH0 = 0xFC;       // é«˜8ä½åˆå€¼</span><br><span class="line">    TF0 = 0;          // æ¸…é™¤æº¢å‡ºæ ‡å¿—</span><br><span class="line">    TR0 = 1;          // å¯åŠ¨å®šæ—¶å™¨0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ”” <strong>æ³¨æ„</strong>ï¼š</p><ul><li>è‹¥ä½¿ç”¨12Tæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼Œåˆå€¼ä¸º <code>TH0=0x3C, TL0=0xB0</code></li><li>æœ¬ä»£ç ä½¿ç”¨ <strong>1Tæ¨¡å¼</strong>ï¼ˆSTCå¢å¼ºå‹ï¼‰ï¼Œç²¾åº¦æ›´é«˜ï¼Œæ¨èä½¿ç”¨ï¼</li></ul></blockquote><h3 id="2-æ‰“å¼€ä¸­æ–­"><a href="#2-æ‰“å¼€ä¸­æ–­" class="headerlink" title="2. æ‰“å¼€ä¸­æ–­"></a>2. æ‰“å¼€ä¸­æ–­</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ET0 = 1; //æ‰“å¼€å®šæ—¶å™¨0ä¸­æ–­ ï¼ˆEnable Timer 0 Interruptï¼‰</span><br><span class="line">EA = 1; //æ‰“å¼€æ€»ä¸­æ–­  ï¼ˆEnable All interruptsï¼‰</span><br></pre></td></tr></table></figure><h3 id="3-å®šæ—¶å™¨0ä¸­æ–­æœåŠ¡å‡½æ•°ï¼ˆæ ¸å¿ƒï¼åŠ¨æ€æ‰«æåœ¨æ­¤å®Œæˆï¼‰"><a href="#3-å®šæ—¶å™¨0ä¸­æ–­æœåŠ¡å‡½æ•°ï¼ˆæ ¸å¿ƒï¼åŠ¨æ€æ‰«æåœ¨æ­¤å®Œæˆï¼‰" class="headerlink" title="3. å®šæ—¶å™¨0ä¸­æ–­æœåŠ¡å‡½æ•°ï¼ˆæ ¸å¿ƒï¼åŠ¨æ€æ‰«æåœ¨æ­¤å®Œæˆï¼‰"></a>3. å®šæ—¶å™¨0ä¸­æ–­æœåŠ¡å‡½æ•°ï¼ˆæ ¸å¿ƒï¼åŠ¨æ€æ‰«æåœ¨æ­¤å®Œæˆï¼‰</h3><p><strong>åªéœ€è¦åœ¨æ™®é€šå‡½æ•°ååŠ  interrupt num</strong><br><strong>ã€‚numè¶Šå¤§ï¼Œä¸­æ–­ä¼˜å…ˆçº§è¶Šä½ï¼Œå½“ä¸­æ–­åŒæ—¶å‘ç”Ÿï¼Œä¼˜å…ˆçº§é«˜çš„å…ˆè¿›è¡Œ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">unsigned char seg_pos;</span><br><span class="line">unsigned char seg_buf[8] =&#123;10,10,10,10,10,10,10,10&#125;;</span><br><span class="line">unsigned char seg_point[8] =&#123;0&#125;;</span><br><span class="line"></span><br><span class="line">void Timer0Init interrupt 1  //void Function_Name() interrupt num  numå–å†³äºæ•°æ®æ‰‹å†Œ</span><br><span class="line">&#123;</span><br><span class="line"> if(++seg_pos == 8) seg_pos = 0;</span><br><span class="line"> Seg_Disp(Seg_Pos,Seg_Buf[Seg_Pos],Seg_Point[Seg_Pos]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>âœ… <strong>å…³é”®è¯´æ˜</strong>ï¼š</p><ul><li>ä¸­æ–­æœåŠ¡å‡½æ•°<strong>å¿…é¡»é‡è½½åˆå€¼</strong>ï¼ˆ1Tæ¨¡å¼ä¸‹TH0&#x2F;TL0ä¸è‡ªåŠ¨é‡è½½ï¼‰</li><li><code>seg_disp()</code> ä¼šè‡ªåŠ¨æ‰§è¡Œâ€œæ¶ˆå½±â†’ä½é€‰â†’æ®µé€‰â€ä¸‰æ­¥ï¼Œæ— éœ€é¢å¤–å¤„ç†</li><li>æ‰€æœ‰æ˜¾ç¤ºæ•°æ®ç”± <code>seg_buf[]</code> å’Œ <code>seg_point[]</code> æä¾›ï¼Œ<strong>ä¸»ç¨‹åºåªéœ€ä¿®æ”¹è¿™ä¸¤æ•°ç»„</strong></li></ul></blockquote><h3 id="8051å•ç‰‡æœºå®šæ—¶å™¨ç›¸å…³å¯„å­˜å™¨æ€»ç»“"><a href="#8051å•ç‰‡æœºå®šæ—¶å™¨ç›¸å…³å¯„å­˜å™¨æ€»ç»“" class="headerlink" title="8051å•ç‰‡æœºå®šæ—¶å™¨ç›¸å…³å¯„å­˜å™¨æ€»ç»“"></a><strong>8051å•ç‰‡æœºå®šæ—¶å™¨ç›¸å…³å¯„å­˜å™¨æ€»ç»“</strong></h3><table><thead><tr><th align="left">ç¼©å†™</th><th align="left">å…¨ç§°</th><th align="left">è¯´æ˜</th><th align="left">ç›¸å…³ä»£ç ç¤ºä¾‹åŠè§£é‡Š</th></tr></thead><tbody><tr><td align="left"><strong>AUXR</strong></td><td align="left">Auxiliary Register (è¾…åŠ©å¯„å­˜å™¨)</td><td align="left">æŸäº›å¢å¼ºå‹8051å•ç‰‡æœºï¼ˆå¦‚STCç³»åˆ—ï¼‰ç‰¹æœ‰çš„å¯„å­˜å™¨ï¼Œç”¨äºæ§åˆ¶å®šæ—¶å™¨çš„å·¥ä½œæ¨¡å¼ã€‚</td><td align="left"><code>AUXR &amp;= 0x7F;</code> å°†ç¬¬7ä½ï¼ˆé€šå¸¸ä¸ºT0x12ä½ï¼‰æ¸…é›¶ï¼Œé€‰æ‹©12Tæ¨¡å¼ï¼ˆå³12ä¸ªæ—¶é’Ÿå‘¨æœŸä¸ºä¸€ä¸ªæœºå™¨å‘¨æœŸï¼Œä¼ ç»Ÿ8051æ¨¡å¼ï¼‰ã€‚</td></tr><tr><td align="left"><strong>TMOD</strong></td><td align="left">Timer Mode Register (å®šæ—¶å™¨æ¨¡å¼å¯„å­˜å™¨)</td><td align="left">ç”¨äºè®¾ç½®å®šæ—¶å™¨0å’Œå®šæ—¶å™¨1çš„å·¥ä½œæ¨¡å¼ï¼ˆå¦‚æ–¹å¼0~3ï¼‰ã€‚</td><td align="left"><code>TMOD &amp;= 0xF0;</code> è¡¨ç¤ºæ¸…é™¤ä½4ä½ï¼Œå³å®šæ—¶å™¨0çš„æ¨¡å¼è¢«è®¾ä¸ºæ–¹å¼0ï¼ˆ13ä½å®šæ—¶å™¨ï¼‰æˆ–æ–¹å¼1ï¼ˆ16ä½å®šæ—¶å™¨ï¼‰ã€‚å…·ä½“å–å†³äºåç»­æ˜¯å¦è®¾ç½®M1&#x2F;M0ä½ã€‚</td></tr><tr><td align="left"><strong>TL0</strong></td><td align="left">Timer 0 Low-byte (å®šæ—¶å™¨0ä½8ä½)</td><td align="left">å®šæ—¶å™¨0çš„ä½å­—èŠ‚è®¡æ•°å¯„å­˜å™¨ã€‚ä¸TH0å…±åŒç»„æˆä¸€ä¸ª16ä½çš„è®¡æ•°å™¨ã€‚</td><td align="left">(æ— ç›´æ¥ä»£ç ç¤ºä¾‹ï¼Œé€šå¸¸ä¸TH0ä¸€èµ·èµ‹å€¼)</td></tr><tr><td align="left"><strong>TH0</strong></td><td align="left">Timer 0 High-byte (å®šæ—¶å™¨0é«˜8ä½)</td><td align="left">å®šæ—¶å™¨0çš„é«˜å­—èŠ‚è®¡æ•°å¯„å­˜å™¨ã€‚ä¸TL0å…±åŒç»„æˆä¸€ä¸ª16ä½çš„è®¡æ•°å™¨ã€‚</td><td align="left">(æ— ç›´æ¥ä»£ç ç¤ºä¾‹ï¼Œé€šå¸¸ä¸TL0ä¸€èµ·èµ‹å€¼)</td></tr><tr><td align="left"><strong>TF0</strong></td><td align="left">Timer 0 Overflow Flag (å®šæ—¶å™¨0æº¢å‡ºæ ‡å¿—ä½)</td><td align="left">å½“å®šæ—¶å™¨0è®¡æ•°æº¢å‡ºæ—¶ï¼Œç¡¬ä»¶è‡ªåŠ¨ç½®1ï¼›éœ€è½¯ä»¶æ¸…é›¶ã€‚</td><td align="left"><code>TF0 = 0;</code> æ‰‹åŠ¨æ¸…é™¤æº¢å‡ºæ ‡å¿—ã€‚è™½ç„¶ä¸Šç”µåé€šå¸¸ä¸º0ï¼Œä½†æ˜¾å¼æ¸…é›¶æ˜¯è‰¯å¥½ä¹ æƒ¯ã€‚</td></tr><tr><td align="left"><strong>TR0</strong></td><td align="left">Timer 0 Run control bit (å®šæ—¶å™¨0è¿è¡Œæ§åˆ¶ä½)</td><td align="left">ä½äºTCONå¯„å­˜å™¨ä¸­ï¼Œç”¨äºæ§åˆ¶å®šæ—¶å™¨0çš„å¯åœã€‚</td><td align="left"><code>TR0 = 1;</code> å¯åŠ¨å®šæ—¶å™¨0å¼€å§‹è®¡æ•°ã€‚ <code>TR0 = 0;</code> åœæ­¢å®šæ—¶å™¨0è®¡æ•°ã€‚</td></tr><tr><td align="left"><strong>ET0</strong></td><td align="left">Enable Timer 0 Interrupt (ä½¿èƒ½å®šæ—¶å™¨0ä¸­æ–­)</td><td align="left">ä½äºIEï¼ˆInterrupt Enableï¼‰å¯„å­˜å™¨ä¸­ï¼Œç”¨äºå…è®¸æˆ–ç¦æ­¢å®šæ—¶å™¨0ä¸­æ–­ã€‚</td><td align="left"><code>ET0 = 1;</code> å…è®¸å®šæ—¶å™¨0æº¢å‡ºæ—¶äº§ç”Ÿä¸­æ–­ã€‚</td></tr><tr><td align="left"><strong>EA</strong></td><td align="left">Enable All interrupts (å…¨å±€ä¸­æ–­ä½¿èƒ½ä½)</td><td align="left">ä½äºIEï¼ˆInterrupt Enableï¼‰å¯„å­˜å™¨ä¸­ï¼Œç”¨äºå…¨å±€å¼€å¯æˆ–å…³é—­æ‰€æœ‰ä¸­æ–­ã€‚</td><td align="left"><code>EA = 1;</code> å¼€å¯CPUæ€»ä¸­æ–­å…è®¸ï¼Œå¦åˆ™æ‰€æœ‰ä¸­æ–­éƒ½è¢«å±è”½ã€‚</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ•°ç ç®¡å’Œå®šæ—¶å™¨&quot;&gt;&lt;a href=&quot;#æ•°ç ç®¡å’Œå®šæ—¶å™¨&quot; class=&quot;headerlink&quot; title=&quot;**æ•°ç ç®¡å’Œå®šæ—¶å™¨ **&quot;&gt;&lt;/a&gt;**æ•°ç ç®¡å’Œå®šæ—¶å™¨ **&lt;/h1&gt;&lt;h2 id=&quot;ä¸€ã€æ•°ç ç®¡åŸºæœ¬åŸç†&quot;&gt;&lt;a href=&quot;#ä¸€ã€æ•°ç ç®¡åŸºæœ¬åŸç†&quot; cla</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>3.å•æ€»çº¿åè®®è¯¦è§£ï¼ˆDS18B20 ï¼‰</title>
    <link href="https://roselin1217.github.io/2025/11/24/3.one_wire%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE%EF%BC%88DS18B20%EF%BC%89/"/>
    <id>https://roselin1217.github.io/2025/11/24/3.one_wire%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE%EF%BC%88DS18B20%EF%BC%89/</id>
    <published>2025-11-24T02:00:00.000Z</published>
    <updated>2025-11-28T10:17:19.343Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹</p><h1 id="å•æ€»çº¿åè®®è¯¦è§£ï¼ˆDS18B20-ï¼‰"><a href="#å•æ€»çº¿åè®®è¯¦è§£ï¼ˆDS18B20-ï¼‰" class="headerlink" title="å•æ€»çº¿åè®®è¯¦è§£ï¼ˆDS18B20 ï¼‰"></a>å•æ€»çº¿åè®®è¯¦è§£ï¼ˆDS18B20 ï¼‰</h1><hr><h2 id="ä¸€ã€å•æ€»çº¿åè®®åŸºç¡€"><a href="#ä¸€ã€å•æ€»çº¿åè®®åŸºç¡€" class="headerlink" title="ä¸€ã€å•æ€»çº¿åè®®åŸºç¡€"></a>ä¸€ã€å•æ€»çº¿åè®®åŸºç¡€</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯å•æ€»çº¿ï¼Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯å•æ€»çº¿ï¼Ÿ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯å•æ€»çº¿ï¼Ÿ"></a>1.1 ä»€ä¹ˆæ˜¯å•æ€»çº¿ï¼Ÿ</h3><p><strong>å•æ€»çº¿ï¼ˆ1-Wireï¼‰</strong> æ˜¯ Dallas&#x2F;Maxim å…¬å¸å¼€å‘çš„ä¸€ç§ä¸²è¡Œé€šä¿¡åè®®ã€‚</p><p><strong>æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong></p><ul><li>âœ… åªéœ€ 1 æ ¹æ•°æ®çº¿ <strong>Data Queue</strong> ï¼ˆDQï¼‰+ 1 æ ¹åœ°çº¿ï¼ˆGNDï¼‰</li><li>âœ… æ”¯æŒå¤šè®¾å¤‡æŒ‚è½½ï¼ˆæ¯ä¸ªè®¾å¤‡æœ‰å”¯ä¸€ 64 ä½ ROM ç ï¼‰</li><li>âœ… åŠåŒå·¥é€šä¿¡ï¼ˆåŒä¸€æ—¶åˆ»åªèƒ½å•å‘ä¼ è¾“ï¼‰</li><li>âœ… ä¸»ä»æ¶æ„ï¼ˆMCU æ˜¯ä¸»æœºï¼Œä¼ æ„Ÿå™¨æ˜¯ä»æœºï¼‰</li></ul><p><strong>ç¡¬ä»¶è¿æ¥ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TEXT        VCC (3.3V/5V)</span><br><span class="line">         |</span><br><span class="line">        [R] 4.7kÎ© ä¸Šæ‹‰ç”µé˜»</span><br><span class="line">         |</span><br><span class="line">MCU -----+-------- DS18B20 (DQ)</span><br><span class="line">         |</span><br><span class="line">        GND</span><br></pre></td></tr></table></figure><hr><h3 id="1-2-å¼€æ¼è¾“å‡ºåŸç†ï¼ˆé‡è¦ï¼ï¼‰"><a href="#1-2-å¼€æ¼è¾“å‡ºåŸç†ï¼ˆé‡è¦ï¼ï¼‰" class="headerlink" title="1.2 å¼€æ¼è¾“å‡ºåŸç†ï¼ˆé‡è¦ï¼ï¼‰"></a>1.2 å¼€æ¼è¾“å‡ºåŸç†ï¼ˆé‡è¦ï¼ï¼‰</h3><p>å•æ€»çº¿ä½¿ç”¨ <strong>å¼€æ¼è¾“å‡ºï¼ˆOpen-Drainï¼‰</strong> æ¨¡å¼ï¼š</p><table><thead><tr><th align="left">MCU æ“ä½œ</th><th align="left">DQ å¼•è„šçŠ¶æ€</th><th align="left">å®é™…ç”µå¹³</th></tr></thead><tbody><tr><td align="left"><code>DQ = 0</code></td><td align="left">å¼ºåˆ¶æ‹‰ä½</td><td align="left">ä½ç”µå¹³ï¼ˆ0Vï¼‰</td></tr><tr><td align="left"><code>DQ = 1</code></td><td align="left"><strong>é‡Šæ”¾æ€»çº¿</strong>ï¼ˆé«˜é˜»æ€ï¼‰</td><td align="left">é«˜ç”µå¹³ï¼ˆç”±ä¸Šæ‹‰ç”µé˜»å†³å®šï¼‰</td></tr></tbody></table><p><strong>å…³é”®ç†è§£ï¼š</strong></p><ul><li><code>DQ = 1</code> <strong>ä¸æ˜¯</strong>ä¸»åŠ¨è¾“å‡ºé«˜ç”µå¹³ï¼Œè€Œæ˜¯â€æ¾æ‰‹â€è®©ä¸Šæ‹‰ç”µé˜»æŠŠæ€»çº¿æ‹‰é«˜</li><li>ä»æœºå¯ä»¥åœ¨æ€»çº¿è¢«é‡Šæ”¾åæ‹‰ä½æ€»çº¿ï¼ˆå®ç°æ•°æ®ä¼ è¾“ï¼‰</li></ul><hr><h2 id="äºŒã€å•æ€»çº¿æ—¶åºï¼ˆé€šç”¨è§„åˆ™ï¼‰"><a href="#äºŒã€å•æ€»çº¿æ—¶åºï¼ˆé€šç”¨è§„åˆ™ï¼‰" class="headerlink" title="äºŒã€å•æ€»çº¿æ—¶åºï¼ˆé€šç”¨è§„åˆ™ï¼‰"></a>äºŒã€å•æ€»çº¿æ—¶åºï¼ˆé€šç”¨è§„åˆ™ï¼‰</h2><h3 id="2-1-åˆå§‹åŒ–æ—¶åºï¼ˆå¤ä½-åº”ç­”ï¼‰"><a href="#2-1-åˆå§‹åŒ–æ—¶åºï¼ˆå¤ä½-åº”ç­”ï¼‰" class="headerlink" title="2.1 åˆå§‹åŒ–æ—¶åºï¼ˆå¤ä½ + åº”ç­”ï¼‰"></a>2.1 åˆå§‹åŒ–æ—¶åºï¼ˆå¤ä½ + åº”ç­”ï¼‰</h3><p><strong>ç›®çš„ï¼š</strong> ç¡®è®¤è®¾å¤‡åœ¨çº¿</p><p><strong>æµç¨‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">TEXTä¸»æœºåŠ¨ä½œï¼š</span><br><span class="line">1. æ‹‰ä½æ€»çº¿ â‰¥480Î¼sï¼ˆå‘é€å¤ä½è„‰å†²ï¼‰</span><br><span class="line">2. é‡Šæ”¾æ€»çº¿</span><br><span class="line">3. ç­‰å¾… 15~60Î¼s</span><br><span class="line">4. è¯»å–æ€»çº¿ç”µå¹³</span><br><span class="line"></span><br><span class="line">ä»æœºå“åº”ï¼š</span><br><span class="line">- æ£€æµ‹åˆ°å¤ä½è„‰å†²åï¼Œæ‹‰ä½æ€»çº¿ 60~240Î¼sï¼ˆåº”ç­”è„‰å†²ï¼‰</span><br><span class="line">- è¿”å› 0 = åœ¨çº¿ï¼Œè¿”å› 1 = æ— å“åº”</span><br></pre></td></tr></table></figure><p><strong>æ³¢å½¢å›¾ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TEXTMCU:  â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">          â”‚ 480Î¼sâ”‚</span><br><span class="line">          â””â”€â”€â”€â”€â”€â”˜</span><br><span class="line"></span><br><span class="line">DS:   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">               â”‚60~â”‚240Î¼s</span><br><span class="line">               â””â”€â”€â”€â”˜ åº”ç­”è„‰å†²</span><br></pre></td></tr></table></figure><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">bit init_ds18b20(void)</span><br><span class="line">   &#123;</span><br><span class="line">       bit initflag = 0;</span><br><span class="line">       </span><br><span class="line">       DQ = 1;         // æ‹‰é«˜æ€»çº¿ï¼Œå‡†å¤‡</span><br><span class="line">       Delay_OneWire(12);</span><br><span class="line">       DQ = 0;         // äº§ç”Ÿå¤ä½è„‰å†² (æ‹‰ä½ &gt; 480us)</span><br><span class="line">       Delay_OneWire(80);</span><br><span class="line">       DQ = 1;         // é‡Šæ”¾æ€»çº¿ï¼Œç­‰å¾…DS18B20å“åº”</span><br><span class="line">       Delay_OneWire(10); </span><br><span class="line">       initflag = DQ;  // æ£€æµ‹åº”ç­”è„‰å†² (ä½ç”µå¹³è¡¨ç¤ºå­˜åœ¨)</span><br><span class="line">       Delay_OneWire(5);</span><br><span class="line">       </span><br><span class="line">       return initflag; // è¿”å›0è¡¨ç¤ºå­˜åœ¨ï¼Œ1è¡¨ç¤ºä¸å­˜åœ¨</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><hr><h3 id="2-2-å†™æ—¶åºï¼ˆä¸»æœºå‘é€æ•°æ®ï¼‰"><a href="#2-2-å†™æ—¶åºï¼ˆä¸»æœºå‘é€æ•°æ®ï¼‰" class="headerlink" title="2.2 å†™æ—¶åºï¼ˆä¸»æœºå‘é€æ•°æ®ï¼‰"></a>2.2 å†™æ—¶åºï¼ˆä¸»æœºå‘é€æ•°æ®ï¼‰</h3><p><strong>åŸåˆ™ï¼š</strong> é€šè¿‡ <strong>æ‹‰ä½æ—¶é—´é•¿çŸ­</strong> åŒºåˆ† 0 å’Œ 1</p><h4 id="å†™-0"><a href="#å†™-0" class="headerlink" title="å†™ 0"></a>å†™ 0</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TEXT1. æ‹‰ä½ 60~120Î¼s</span><br><span class="line">2. é‡Šæ”¾æ€»çº¿</span><br><span class="line">TEXTDQ: â”€â”€â”€â”€â”           â”Œâ”€â”€â”€</span><br><span class="line">        â”‚  60~120Î¼s â”‚</span><br><span class="line">        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><h4 id="å†™-1"><a href="#å†™-1" class="headerlink" title="å†™ 1"></a>å†™ 1</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TEXT1. æ‹‰ä½ 1~15Î¼sï¼ˆçŸ­è„‰å†²ï¼‰</span><br><span class="line">2. ç«‹å³é‡Šæ”¾æ€»çº¿</span><br><span class="line">3. ä¿æŒé«˜ç”µå¹³è‡³æ—¶é—´æ§½ç»“æŸ</span><br><span class="line">TEXTDQ: â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">        â”‚â”‚ &lt;15Î¼s</span><br><span class="line">        â””â”˜</span><br></pre></td></tr></table></figure><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">void Write_DS18B20(unsigned char dat)</span><br><span class="line">    &#123;</span><br><span class="line">        unsigned char i;</span><br><span class="line">        for(i=0; i&lt;8; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            DQ = 0;             // å¼€å§‹å†™æ—¶åºï¼Œæ‹‰ä½æ€»çº¿</span><br><span class="line">            DQ = dat &amp; 0x01;    // å†™å…¥æ•°æ®ä½ (0æˆ–1)</span><br><span class="line">            Delay_OneWire(5);   // ä¿æŒ &gt; 60us</span><br><span class="line">            DQ = 1;             // é‡Šæ”¾æ€»çº¿</span><br><span class="line">            dat &gt;&gt;= 1;          // å‡†å¤‡ä¸‹ä¸€ä½æ•°æ®</span><br><span class="line">        &#125;</span><br><span class="line">        Delay_OneWire(5);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><hr><h3 id="2-3-è¯»æ—¶åºï¼ˆä»æœºå‘é€æ•°æ®ï¼‰"><a href="#2-3-è¯»æ—¶åºï¼ˆä»æœºå‘é€æ•°æ®ï¼‰" class="headerlink" title="2.3 è¯»æ—¶åºï¼ˆä»æœºå‘é€æ•°æ®ï¼‰"></a>2.3 è¯»æ—¶åºï¼ˆä»æœºå‘é€æ•°æ®ï¼‰</h3><p><strong>åŸåˆ™ï¼š</strong> ä¸»æœºè§¦å‘ï¼Œä»æœºæ§åˆ¶æ€»çº¿ç”µå¹³</p><p><strong>æµç¨‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TEXT1. ä¸»æœºæ‹‰ä½æ€»çº¿ 1Î¼sï¼ˆè§¦å‘ä¿¡å·ï¼‰</span><br><span class="line">2. ä¸»æœºé‡Šæ”¾æ€»çº¿</span><br><span class="line">3. ç­‰å¾… 10~15Î¼s åé‡‡æ ·æ€»çº¿ç”µå¹³</span><br><span class="line">   - ä½ç”µå¹³ = 0</span><br><span class="line">   - é«˜ç”µå¹³ = 1</span><br></pre></td></tr></table></figure><p><strong>æ³¢å½¢å›¾ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">TEXTè¯»åˆ° 0:</span><br><span class="line">MCU:  â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">         â”‚â”‚ 1Î¼s</span><br><span class="line">         â””â”˜</span><br><span class="line">DS:   â”€â”€â”€â”€â”        â”Œâ”€â”€â”€</span><br><span class="line">          â”‚ ä»æœºæ‹‰ä½ â”‚</span><br><span class="line">          â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line"></span><br><span class="line">è¯»åˆ° 1:</span><br><span class="line">MCU:  â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">         â””â”˜</span><br><span class="line">DS:   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  (ä»æœºä¸æ‹‰ä½ï¼Œä¿æŒé«˜ç”µå¹³)</span><br></pre></td></tr></table></figure><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">unsigned char Read_DS18B20(void)</span><br><span class="line">   &#123;</span><br><span class="line">       unsigned char i;</span><br><span class="line">       unsigned char dat = 0; // åˆå§‹åŒ–ä¸º0</span><br><span class="line">       </span><br><span class="line">       for(i=0; i&lt;8; i++)</span><br><span class="line">       &#123;</span><br><span class="line">           DQ = 0;             // å¼€å§‹è¯»æ—¶åºï¼Œæ‹‰ä½æ€»çº¿</span><br><span class="line">           dat &gt;&gt;= 1;          // å³ç§»ä¸€ä½ï¼Œå‡†å¤‡æ¥æ”¶æ–°æ•°æ®</span><br><span class="line">           DQ = 1;             // é‡Šæ”¾æ€»çº¿ï¼Œè®©DS18B20æ§åˆ¶</span><br><span class="line">           if(DQ)              // åœ¨15uså†…è¯»å–æ€»çº¿ç”µå¹³</span><br><span class="line">           &#123;</span><br><span class="line">               dat |= 0x80;    // å¦‚æœä¸ºé«˜ç”µå¹³ï¼Œåˆ™æœ€é«˜ä½ç½®1</span><br><span class="line">           &#125;    </span><br><span class="line">           Delay_OneWire(5);   // ç­‰å¾…è¯»å‘¨æœŸç»“æŸ</span><br><span class="line">       &#125;</span><br><span class="line">       return dat;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><hr><h2 id="ä¸‰ã€å•æ€»çº¿é€šä¿¡æµç¨‹"><a href="#ä¸‰ã€å•æ€»çº¿é€šä¿¡æµç¨‹" class="headerlink" title="ä¸‰ã€å•æ€»çº¿é€šä¿¡æµç¨‹"></a>ä¸‰ã€å•æ€»çº¿é€šä¿¡æµç¨‹</h2><h3 id="3-1-æ ‡å‡†æµç¨‹ï¼ˆå›ºå®šé¡ºåºï¼‰"><a href="#3-1-æ ‡å‡†æµç¨‹ï¼ˆå›ºå®šé¡ºåºï¼‰" class="headerlink" title="3.1 æ ‡å‡†æµç¨‹ï¼ˆå›ºå®šé¡ºåºï¼‰"></a>3.1 æ ‡å‡†æµç¨‹ï¼ˆå›ºå®šé¡ºåºï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">TEXT1. åˆå§‹åŒ–        â† æ¡æ‰‹ç¡®è®¤è®¾å¤‡åœ¨çº¿</span><br><span class="line">   â†“</span><br><span class="line">2. ROM æ“ä½œ      â† é€‰æ‹©/è·³è¿‡è®¾å¤‡</span><br><span class="line">   â†“</span><br><span class="line">3. åŠŸèƒ½æŒ‡ä»¤      â† å‘é€è®¾å¤‡ç‰¹å®šå‘½ä»¤</span><br><span class="line">   â†“</span><br><span class="line">4. æ•°æ®ä¼ è¾“      â† è¯»å–æˆ–å†™å…¥æ•°æ®</span><br></pre></td></tr></table></figure><p><strong>æ¯æ¬¡é€šä¿¡å¿…é¡»ä»åˆå§‹åŒ–å¼€å§‹ï¼</strong></p><hr><h3 id="3-2-ROM-æ“ä½œæŒ‡ä»¤ï¼ˆæ‰€æœ‰å•æ€»çº¿è®¾å¤‡é€šç”¨ï¼‰"><a href="#3-2-ROM-æ“ä½œæŒ‡ä»¤ï¼ˆæ‰€æœ‰å•æ€»çº¿è®¾å¤‡é€šç”¨ï¼‰" class="headerlink" title="3.2 ROM æ“ä½œæŒ‡ä»¤ï¼ˆæ‰€æœ‰å•æ€»çº¿è®¾å¤‡é€šç”¨ï¼‰"></a>3.2 ROM æ“ä½œæŒ‡ä»¤ï¼ˆæ‰€æœ‰å•æ€»çº¿è®¾å¤‡é€šç”¨ï¼‰</h3><table><thead><tr><th align="center">æŒ‡ä»¤ç </th><th align="left">åç§°</th><th align="left">åŠŸèƒ½</th><th align="left">åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="center"><code>0xCC</code></td><td align="left">Skip ROM</td><td align="left">è·³è¿‡ ROM åŒ¹é…</td><td align="left"><strong>å•è®¾å¤‡</strong>ç³»ç»Ÿï¼ˆæœ€å¸¸ç”¨ï¼‰</td></tr><tr><td align="center"><code>0x55</code></td><td align="left">Match ROM</td><td align="left">é€‰æ‹©ç‰¹å®šè®¾å¤‡</td><td align="left">å¤šè®¾å¤‡æ€»çº¿</td></tr><tr><td align="center"><code>0x33</code></td><td align="left">Read ROM</td><td align="left">è¯»å– 64 ä½ ROM ç </td><td align="left">è·å–è®¾å¤‡ ID</td></tr><tr><td align="center"><code>0xF0</code></td><td align="left">Search ROM</td><td align="left">æœç´¢æ‰€æœ‰è®¾å¤‡</td><td align="left">è®¾å¤‡æšä¸¾</td></tr></tbody></table><hr><h2 id="å››ã€DS18B20-ä¸“å±å†…å®¹"><a href="#å››ã€DS18B20-ä¸“å±å†…å®¹" class="headerlink" title="å››ã€DS18B20 ä¸“å±å†…å®¹"></a>å››ã€DS18B20 ä¸“å±å†…å®¹</h2><h3 id="4-1-åŠŸèƒ½æŒ‡ä»¤ï¼ˆDS18B20-ç‰¹å®šï¼‰"><a href="#4-1-åŠŸèƒ½æŒ‡ä»¤ï¼ˆDS18B20-ç‰¹å®šï¼‰" class="headerlink" title="4.1 åŠŸèƒ½æŒ‡ä»¤ï¼ˆDS18B20 ç‰¹å®šï¼‰"></a>4.1 åŠŸèƒ½æŒ‡ä»¤ï¼ˆDS18B20 ç‰¹å®šï¼‰</h3><table><thead><tr><th align="center">æŒ‡ä»¤ç </th><th align="left">åç§°</th><th align="left">åŠŸèƒ½</th></tr></thead><tbody><tr><td align="center"><code>0x44</code></td><td align="left">Convert T</td><td align="left">å¯åŠ¨æ¸©åº¦è½¬æ¢ï¼ˆè€—æ—¶ 750msï¼‰</td></tr><tr><td align="center"><code>0xBE</code></td><td align="left">Read Scratchpad</td><td align="left">è¯»å–æš‚å­˜å™¨ï¼ˆå«æ¸©åº¦æ•°æ®ï¼‰</td></tr><tr><td align="center"><code>0x4E</code></td><td align="left">Write Scratchpad</td><td align="left">å†™å…¥é…ç½®ï¼ˆç²¾åº¦ã€æŠ¥è­¦é˜ˆå€¼ï¼‰</td></tr></tbody></table><hr><h3 id="4-2-æš‚å­˜å™¨ç»“æ„ï¼ˆ9-å­—èŠ‚ï¼‰"><a href="#4-2-æš‚å­˜å™¨ç»“æ„ï¼ˆ9-å­—èŠ‚ï¼‰" class="headerlink" title="4.2 æš‚å­˜å™¨ç»“æ„ï¼ˆ9 å­—èŠ‚ï¼‰"></a>4.2 æš‚å­˜å™¨ç»“æ„ï¼ˆ9 å­—èŠ‚ï¼‰</h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111104128787.png"></p><p>è°ƒç”¨ <code>0xBE</code> åï¼ŒDS18B20 æŒ‰é¡ºåºå‘é€ï¼š</p><table><thead><tr><th align="center">å­—èŠ‚ç´¢å¼•</th><th align="left">å†…å®¹</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">Byte 0</td><td align="left">æ¸©åº¦ä½ 8 ä½ï¼ˆLSBï¼‰</td><td align="left">ç¬¬1æ¬¡ <code>Read_DS18B20()</code></td></tr><tr><td align="center">Byte 1</td><td align="left">æ¸©åº¦é«˜ 8 ä½ï¼ˆMSBï¼‰</td><td align="left">ç¬¬2æ¬¡ <code>Read_DS18B20()</code></td></tr><tr><td align="center">Byte 2</td><td align="left">TH å¯„å­˜å™¨</td><td align="left">é«˜æ¸©æŠ¥è­¦é˜ˆå€¼</td></tr><tr><td align="center">Byte 3</td><td align="left">TL å¯„å­˜å™¨</td><td align="left">ä½æ¸©æŠ¥è­¦é˜ˆå€¼</td></tr><tr><td align="center">Byte 4</td><td align="left">é…ç½®å¯„å­˜å™¨</td><td align="left">ç²¾åº¦è®¾ç½®ï¼ˆ9&#x2F;10&#x2F;11&#x2F;12ä½ï¼‰</td></tr><tr><td align="center">Byte 5-7</td><td align="left">ä¿ç•™</td><td align="left">å›ºå®š 0xFF</td></tr><tr><td align="center">Byte 8</td><td align="left">CRC æ ¡éªŒ</td><td align="left">æ•°æ®å®Œæ•´æ€§æ ¡éªŒ</td></tr></tbody></table><hr><h3 id="4-3-æ¸©åº¦æ•°æ®æ ¼å¼"><a href="#4-3-æ¸©åº¦æ•°æ®æ ¼å¼" class="headerlink" title="4.3 æ¸©åº¦æ•°æ®æ ¼å¼"></a>4.3 æ¸©åº¦æ•°æ®æ ¼å¼</h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111104239787.png"></p><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111105018620.png"></p><p><strong>16 ä½è¡¥ç è¡¨ç¤ºï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TEXTé«˜å­—èŠ‚ (MSB)              ä½å­—èŠ‚ (LSB)</span><br><span class="line">S S S S S 2â¶ 2âµ 2â´   2Â³ 2Â² 2Â¹ 2â° 2â»Â¹ 2â»Â² 2â»Â³ 2â»â´</span><br><span class="line">â””â”€ç¬¦å·ä½â”€â”˜  â””â”€æ•´æ•°éƒ¨åˆ†â”€â”˜  â””â”€â”€â”€â”€â”€å°æ•°éƒ¨åˆ†â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><ul><li><strong>åˆ†è¾¨ç‡</strong>ï¼š0.0625Â°Cï¼ˆ1&#x2F;16ï¼‰</li><li><strong>èŒƒå›´</strong>ï¼š-55Â°C ~ +125Â°C</li></ul><p><strong>è®¡ç®—å…¬å¼ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¸©åº¦ = (high &lt;&lt; 8 | low) / 16.0</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TEXT+25.0625Â°C:  0x0191 = 401 â†’ 401/16 = 25.0625</span><br><span class="line">-10.125Â°C:   0xFF5Eï¼ˆè¡¥ç ï¼‰â†’ -162/16 = -10.125</span><br></pre></td></tr></table></figure><hr><h3 id="4-4-å®Œæ•´è¯»å–æ¸©åº¦ä»£ç "><a href="#4-4-å®Œæ•´è¯»å–æ¸©åº¦ä»£ç " class="headerlink" title="4.4 å®Œæ•´è¯»å–æ¸©åº¦ä»£ç "></a>4.4 å®Œæ•´è¯»å–æ¸©åº¦ä»£ç </h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251114104523084.png" alt="image-20251114104523084"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;onewire.h&quot;</span><br><span class="line">#include &quot;intrins.h&quot;</span><br><span class="line">sbit DQ = P1 ^ 4;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">float rd_temperature(void)</span><br><span class="line">&#123;</span><br><span class="line">    unsigned char low, high; // ç”¨äºå­˜å‚¨æ¸©åº¦çš„ä½ä½å’Œé«˜ä½å­—èŠ‚</span><br><span class="line">   </span><br><span class="line">    init_ds18b20();         // åˆå§‹åŒ–DS18B20</span><br><span class="line">    Write_DS18B20(0xcc);    // è·³è¿‡ROMæ“ä½œï¼ˆé€‚ç”¨äºå•æ€»çº¿åªæœ‰ä¸€ä¸ªè®¾å¤‡çš„æƒ…å†µï¼‰</span><br><span class="line">    Write_DS18B20(0x44);    // å‘é€å¯åŠ¨æ¸©åº¦è½¬æ¢å‘½ä»¤</span><br><span class="line"></span><br><span class="line">    init_ds18b20();         // å†æ¬¡åˆå§‹åŒ–DS18B20ï¼Œå‡†å¤‡è¯»å–</span><br><span class="line">    Write_DS18B20(0xcc);    // è·³è¿‡ROMæ“ä½œ</span><br><span class="line">    Write_DS18B20(0xbe);    // å‘é€è¯»å–æš‚å­˜å™¨å‘½ä»¤</span><br><span class="line">    </span><br><span class="line">    low = Read_DS18B20();   // è¯»å–æ¸©åº¦å€¼çš„ä½ä½å­—èŠ‚</span><br><span class="line">    high = Read_DS18B20();  // è¯»å–æ¸©åº¦å€¼çš„é«˜ä½å­—èŠ‚</span><br><span class="line">    </span><br><span class="line">    return ((high &lt;&lt; 8) | low) / 16.0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">Intrinsic Functionï¼ˆå†…åµŒå‡½æ•°/å›ºæœ‰å‡½æ•°ï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ã€‚</span><br><span class="line">_nop_()ï¼šç©ºæ“ä½œï¼ˆNo Operationï¼‰ã€‚å®ƒä¼šæ’å…¥ä¸€ä¸ªç²¾ç¡®çš„æœºå™¨å‘¨æœŸå»¶æ—¶ï¼Œç”¨äºäº§ç”Ÿéå¸¸çŸ­çš„å»¶æ—¶ã€‚</span><br><span class="line">_cror_()ï¼šå¾ªç¯å³ç§»ï¼ˆCircular Rotate Rightï¼‰ã€‚</span><br><span class="line">_crol_()ï¼šå¾ªç¯å·¦ç§»ï¼ˆCircular Rotate Leftï¼‰ã€‚</span><br><span class="line">_iror_()ï¼šå¸¦è¿›ä½å¾ªç¯å³ç§»ã€‚</span><br><span class="line">_irol_()ï¼šå¸¦è¿›ä½å¾ªç¯å·¦ç§»ã€‚</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚         å•æ€»çº¿ (One-Wire)            â”‚  â† é€šä¿¡åè®®ï¼ˆæŠ½è±¡è§„åˆ™ï¼‰</span><br><span class="line">â”‚   - ä¸€ç§é€šä¿¡æ ‡å‡†/åè®®                 â”‚</span><br><span class="line">â”‚   - å®šä¹‰äº†æ—¶åºè§„åˆ™                    â”‚</span><br><span class="line">â”‚   - å®šä¹‰äº†é€šä¿¡æµç¨‹                    â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">               â”‚ éµå¾ª/å®ç°</span><br><span class="line">               â–¼</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚          DS18B20                    â”‚  â† å…·ä½“èŠ¯ç‰‡ï¼ˆå®ç°è€…ï¼‰</span><br><span class="line">â”‚   - ä¸€æ¬¾æ¸©åº¦ä¼ æ„Ÿå™¨èŠ¯ç‰‡                â”‚</span><br><span class="line">â”‚   - ä½¿ç”¨å•æ€»çº¿åè®®é€šä¿¡                â”‚</span><br><span class="line">â”‚   - æœ‰è‡ªå·±ç‰¹å®šçš„æŒ‡ä»¤é›†                â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹		&lt;/p&gt;
&lt;h1 id=&quot;å•æ€»çº¿åè®®è¯¦è§£ï¼ˆDS18B20-ï¼‰&quot;&gt;&lt;a href=&quot;#å•æ€»çº¿åè®®è¯¦è§£ï¼ˆDS18B20-ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;å•æ€»çº¿åè®®è¯¦è§£ï¼ˆDS18B20 ï¼‰&quot;&gt;&lt;/a&gt;å•æ€»çº¿åè®®è¯¦è§£ï¼ˆDS18B20 ï¼‰&lt;/h1&gt;&lt;h</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>4.I2Cåè®®ï¼ˆPCF8591ï¼‰</title>
    <link href="https://roselin1217.github.io/2025/11/24/4.I2C%E5%8D%8F%E8%AE%AE(PCF8591)/"/>
    <id>https://roselin1217.github.io/2025/11/24/4.I2C%E5%8D%8F%E8%AE%AE(PCF8591)/</id>
    <published>2025-11-24T02:00:00.000Z</published>
    <updated>2025-11-28T10:17:43.649Z</updated>
    
    <content type="html"><![CDATA[<h1 id="I2C-åè®®ï¼ˆPCF8591ï¼‰"><a href="#I2C-åè®®ï¼ˆPCF8591ï¼‰" class="headerlink" title="I2C åè®®ï¼ˆPCF8591ï¼‰"></a>I2C åè®®ï¼ˆPCF8591ï¼‰</h1><p>æœ¬æ–‡æ¡£è®°å½•äº† I2C é€šä¿¡åè®®çš„åŸºç¡€çŸ¥è¯†ä»¥åŠ PCF8591 èŠ¯ç‰‡ï¼ˆ8ä½AD&#x2F;DAè½¬æ¢å™¨ï¼‰çš„åº”ç”¨ç»†èŠ‚ã€‚</p><h2 id="ğŸ—ï¸-æ•´ä½“æ¶æ„"><a href="#ğŸ—ï¸-æ•´ä½“æ¶æ„" class="headerlink" title="ğŸ—ï¸ æ•´ä½“æ¶æ„"></a>ğŸ—ï¸ æ•´ä½“æ¶æ„</h2><h3 id="ä¸‰å±‚å…³ç³»å›¾"><a href="#ä¸‰å±‚å…³ç³»å›¾" class="headerlink" title="ä¸‰å±‚å…³ç³»å›¾"></a>ä¸‰å±‚å…³ç³»å›¾</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">TEXTâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚  åº”ç”¨å±‚ï¼šPCF8591èŠ¯ç‰‡                     â”‚</span><br><span class="line">â”‚  â”œâ”€ ç¡¬ä»¶åŠŸèƒ½ï¼š4è·¯AD + 1è·¯DA              â”‚</span><br><span class="line">â”‚  â”œâ”€ è®¾å¤‡åœ°å€ï¼š0x90/0x91                 â”‚</span><br><span class="line">â”‚  â””â”€ æ§åˆ¶é€»è¾‘ï¼šå¯„å­˜å™¨/æ§åˆ¶å­—èŠ‚            â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚  é€šä¿¡å±‚ï¼šI2Cåè®®                         â”‚</span><br><span class="line">â”‚  â”œâ”€ 7ä¸ªåŸºç¡€å‡½æ•°ï¼ˆé€šç”¨æ‰€æœ‰I2Cè®¾å¤‡ï¼‰       â”‚</span><br><span class="line">â”‚  â””â”€ æ—¶åºï¼šStart/Stop/åº”ç­”/æ•°æ®ä¼ è¾“       â”‚</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚  ç¡¬ä»¶å±‚ï¼š51å•ç‰‡æœºGPIO                    â”‚</span><br><span class="line">â”‚  â”œâ”€ SCLï¼šP2.1ï¼ˆæ—¶é’Ÿçº¿ï¼‰                 â”‚</span><br><span class="line">â”‚  â””â”€ SDAï¼šP2.0ï¼ˆæ•°æ®çº¿ï¼‰                 â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><h2 id="æ•´ä½“æ¶æ„ä¸ç±»æ¯”"><a href="#æ•´ä½“æ¶æ„ä¸ç±»æ¯”" class="headerlink" title="æ•´ä½“æ¶æ„ä¸ç±»æ¯”"></a>æ•´ä½“æ¶æ„ä¸ç±»æ¯”</h2><p>I2C ç›¸å…³çš„å¼€å‘å¯ä»¥ç†è§£ä¸ºåˆ†å±‚ç»“æ„ï¼š</p><table><thead><tr><th align="left">å±‚æ¬¡</th><th align="left">è´Ÿè´£å†…å®¹</th><th align="left">å®ä¾‹</th></tr></thead><tbody><tr><td align="left"><strong>åº”ç”¨å±‚</strong></td><td align="left">PCF8591 èŠ¯ç‰‡åŠŸèƒ½é€»è¾‘ã€åœ°å€ã€æ§åˆ¶å­—èŠ‚ã€‚</td><td align="left">è¯»å– AIN1ï¼Œè®¾ç½® DA è¾“å‡º 150ã€‚</td></tr><tr><td align="left"><strong>é€šä¿¡å±‚</strong></td><td align="left">I2C åè®®çš„é€šç”¨å®ç°ï¼ˆStart&#x2F;Stopã€åº”ç­”ã€æ•°æ®å‘é€ï¼‰ã€‚</td><td align="left"><strong>7ä¸ª</strong>åŸºç¡€ I2C å‡½æ•°ï¼ˆä¸è®¾å¤‡æ— å…³ï¼‰ã€‚</td></tr><tr><td align="left"><strong>ç¡¬ä»¶å±‚</strong></td><td align="left">51å•ç‰‡æœºä¸ SCL&#x2F;SDA å¼•è„šçš„ GPIO æ“ä½œã€‚</td><td align="left">æ§åˆ¶ P2.1 (SCL) å’Œ P2.0 (SDA) çš„é«˜ä½ç”µå¹³ã€‚</td></tr></tbody></table><h2 id="1-I2C-é€šä¿¡åè®®åŸºç¡€-Inter-Integrated-Circuit"><a href="#1-I2C-é€šä¿¡åè®®åŸºç¡€-Inter-Integrated-Circuit" class="headerlink" title="1. I2C é€šä¿¡åè®®åŸºç¡€ (Inter-Integrated Circuit)"></a>1. I2C é€šä¿¡åè®®åŸºç¡€ (Inter-Integrated Circuit)</h2><p>I2C æ˜¯ä¸€ç§ç”±é£åˆ©æµ¦ï¼ˆNXPï¼‰å¼€å‘çš„<strong>åŒæ­¥ã€å¤šä¸»&#x2F;ä»ã€ä¸¤çº¿åŒæ­¥ä¸²è¡Œé€šä¿¡åè®®</strong>ï¼Œä¸»è¦ç”¨äºçŸ­è·ç¦»å†…è¿æ¥ä½é€Ÿå¤–è®¾ã€‚</p><ul><li><p>**SCL (Serial Clock Lineï¼Œä¸²è¡Œæ—¶é’Ÿçº¿)**ç”±ä¸»è®¾å¤‡ï¼ˆMasterï¼‰äº§ç”Ÿï¼Œç”¨äºåŒæ­¥æ•°æ®ä¼ è¾“ã€‚</p></li><li><p><strong>SDA (Serial Data Lineï¼Œä¸²è¡Œæ•°æ®çº¿):</strong> ç”¨äºä¼ è¾“æ•°æ®ã€‚</p></li></ul><h3 id="æ ¸å¿ƒç‰¹ç‚¹"><a href="#æ ¸å¿ƒç‰¹ç‚¹" class="headerlink" title="æ ¸å¿ƒç‰¹ç‚¹"></a>æ ¸å¿ƒç‰¹ç‚¹</h3><table><thead><tr><th align="left">ç‰¹ç‚¹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><strong>çº¿è·¯</strong></td><td align="left">ä»…éœ€ <strong>SCL</strong> (æ—¶é’Ÿçº¿) å’Œ <strong>SDA</strong> (æ•°æ®çº¿) ä¸¤æ¡çº¿ï¼Œå‡éœ€<strong>ä¸Šæ‹‰ç”µé˜»</strong>ã€‚</td></tr><tr><td align="left"><strong>åŒæ­¥æ€§</strong></td><td align="left"><strong>SCL</strong> çº¿ä¸Šçš„æ—¶é’Ÿä¿¡å·åŒæ­¥æ‰€æœ‰æ•°æ®ä½ä¼ è¾“ã€‚</td></tr><tr><td align="left"><strong>ä¸»ä»æ¶æ„</strong></td><td align="left"><strong>ä¸»è®¾å¤‡ (Master)</strong> æ§åˆ¶é€šä¿¡æ—¶åºï¼Œ<strong>ä»è®¾å¤‡ (Slave)</strong> å“åº”è¯·æ±‚ï¼Œæ¯ä¸ªä»è®¾å¤‡æœ‰å”¯ä¸€çš„åœ°å€ã€‚</td></tr></tbody></table><h3 id="é€šä¿¡æµç¨‹"><a href="#é€šä¿¡æµç¨‹" class="headerlink" title="é€šä¿¡æµç¨‹"></a>é€šä¿¡æµç¨‹</h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/i2c%E5%8D%8F%E8%AE%AE.png"></p><p>ä¸€ä¸ªæ ‡å‡†çš„ I2C é€šä¿¡åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><p><strong>èµ·å§‹æ¡ä»¶ (Start):</strong> SCL ä¸ºé«˜ç”µå¹³ï¼ŒSDA ä»é«˜ç”µå¹³æ‹‰ä½ã€‚</p></li><li><p><strong>å‘é€åœ°å€:</strong> ä¸»è®¾å¤‡å‘é€ 7 ä½åœ°å€ + 1 ä½ <strong>R&#x2F;W</strong> ä½ï¼ˆ0&#x3D;å†™ï¼Œ1&#x3D;è¯»ï¼‰ã€‚</p></li><li><p><strong>åº”ç­” (ACK&#x2F;NACK):</strong> è¢«å¯»å€çš„ä»è®¾å¤‡å¿…é¡»å°† SDA æ‹‰ä½ï¼ˆACKï¼‰ã€‚</p></li><li><p><strong>æ•°æ®ä¼ è¾“:</strong> ä»¥ **8 ä½ï¼ˆ1å­—èŠ‚ï¼‰**ä¸ºå•ä½è¿›è¡Œäº¤æ¢ï¼Œæ¯å­—èŠ‚åéƒ½éœ€è¦åº”ç­”ã€‚</p></li><li><p><strong>åœæ­¢æ¡ä»¶ (Stop):</strong> SCL ä¸ºé«˜ç”µå¹³ï¼ŒSDA ä»ä½ç”µå¹³æ‹‰é«˜ï¼Œé‡Šæ”¾æ€»çº¿ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;iic.h&quot;</span><br><span class="line">#include &quot;intrins.h&quot;</span><br><span class="line"></span><br><span class="line">#define DELAY_TIME 5 //åŸæ¥æ˜¯10</span><br><span class="line"></span><br><span class="line">#define Photo_Res_Channel 0x41</span><br><span class="line">#define Adj_Res_Channel 0x43</span><br><span class="line"></span><br><span class="line">//æ€»çº¿å¼•è„šå®šä¹‰</span><br><span class="line">sbit SDA = P2^1;  /* æ•°æ®çº¿ */</span><br><span class="line">sbit SCL = P2^0;  /* æ—¶é’Ÿçº¿ */</span><br><span class="line"></span><br><span class="line">void IIC_Delay(unsigned char i)</span><br><span class="line">&#123;</span><br><span class="line">    do&#123;_nop_();&#125;</span><br><span class="line">    while(i--);        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æ€»çº¿å¯åŠ¨æ¡ä»¶</span><br><span class="line">void IIC_Start(void)</span><br><span class="line">&#123;</span><br><span class="line">    SDA = 1;</span><br><span class="line">    SCL = 1;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SDA = 0;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SCL = 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æ€»çº¿åœæ­¢æ¡ä»¶</span><br><span class="line">void IIC_Stop(void)</span><br><span class="line">&#123;</span><br><span class="line">    SDA = 0;</span><br><span class="line">    SCL = 1;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SDA = 1;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å‘é€åº”ç­”</span><br><span class="line">void IIC_SendAck(bit ackbit)</span><br><span class="line">&#123;</span><br><span class="line">    SCL = 0;</span><br><span class="line">    SDA = ackbit;  // 0ï¼šåº”ç­”ï¼Œ1ï¼šéåº”ç­”</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SCL = 1;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    SCL = 0; </span><br><span class="line">    SDA = 1;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//ç­‰å¾…åº”ç­”</span><br><span class="line">bit IIC_WaitAck(void)</span><br><span class="line">&#123;</span><br><span class="line">    bit ackbit;</span><br><span class="line"></span><br><span class="line">    SCL  = 1;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    ackbit = SDA;</span><br><span class="line">    SCL = 0;</span><br><span class="line">    IIC_Delay(DELAY_TIME);</span><br><span class="line">    return ackbit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//é€šè¿‡I2Cæ€»çº¿å‘é€æ•°æ®</span><br><span class="line">void IIC_SendByte(unsigned char byt)</span><br><span class="line">&#123;</span><br><span class="line">    unsigned char i;</span><br><span class="line"></span><br><span class="line">    for(i=0; i&lt;8; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        SCL  = 0;</span><br><span class="line">        IIC_Delay(DELAY_TIME);</span><br><span class="line">        if(byt &amp; 0x80) SDA  = 1;</span><br><span class="line">        else SDA  = 0;</span><br><span class="line">        IIC_Delay(DELAY_TIME);</span><br><span class="line">        SCL = 1;</span><br><span class="line">        byt &lt;&lt;= 1;</span><br><span class="line">        IIC_Delay(DELAY_TIME);</span><br><span class="line">    &#125;</span><br><span class="line">    SCL  = 0;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//ä»I2Cæ€»çº¿ä¸Šæ¥æ”¶æ•°æ®</span><br><span class="line">unsigned char IIC_RecByte(void)</span><br><span class="line">&#123;</span><br><span class="line">    unsigned char i, da;</span><br><span class="line">    for(i=0; i&lt;8; i++)</span><br><span class="line">    &#123;   </span><br><span class="line">    SCL = 1;</span><br><span class="line">IIC_Delay(DELAY_TIME);</span><br><span class="line">da &lt;&lt;= 1;</span><br><span class="line">if(SDA) da |= 1;</span><br><span class="line">SCL = 0;</span><br><span class="line">IIC_Delay(DELAY_TIME);</span><br><span class="line">    &#125;</span><br><span class="line">    return da;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><hr><h2 id="2-AD-DA-è½¬æ¢åŠŸèƒ½å±‚"><a href="#2-AD-DA-è½¬æ¢åŠŸèƒ½å±‚" class="headerlink" title="2. AD&#x2F;DA è½¬æ¢åŠŸèƒ½å±‚"></a>2. AD&#x2F;DA è½¬æ¢åŠŸèƒ½å±‚</h2><h3 id="ä»€ä¹ˆæ˜¯-AD-DAï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-AD-DAï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ AD&#x2F;DAï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ AD&#x2F;DAï¼Ÿ</h3><h4 id="A-D-è½¬æ¢-Analog-to-Digital-ADC"><a href="#A-D-è½¬æ¢-Analog-to-Digital-ADC" class="headerlink" title="A&#x2F;D è½¬æ¢ (Analog to Digital - ADC)"></a>A&#x2F;D è½¬æ¢ (Analog to Digital - ADC)</h4><p>å°†è¿ç»­çš„**æ¨¡æ‹Ÿä¿¡å·ï¼ˆç”µå‹ï¼‰**è½¬æ¢ä¸ºç¦»æ•£çš„**æ•°å­—ä¿¡å·ï¼ˆ0-255ï¼Œ8ä½ï¼‰**ã€‚</p><p>æ¨¡æ‹Ÿä¿¡å·(0âˆ’5V)â†’ADCæ•°å­—ä¿¡å·(0âˆ’255)æ¨¡æ‹Ÿä¿¡å·(0âˆ’5<em>V</em>)ADCæ•°å­—ä¿¡å·(0âˆ’255)</p><ul><li><strong>ç¤ºä¾‹:</strong> è¾“å…¥ 2.5Vâ†’2.5Vâ†’ è¾“å‡º 127127 (çº¦ä¸€åŠ)ã€‚</li></ul><h4 id="D-A-è½¬æ¢-Digital-to-Analog-DAC"><a href="#D-A-è½¬æ¢-Digital-to-Analog-DAC" class="headerlink" title="D&#x2F;A è½¬æ¢ (Digital to Analog - DAC)"></a>D&#x2F;A è½¬æ¢ (Digital to Analog - DAC)</h4><p>å°†**æ•°å­—ä¿¡å·ï¼ˆ0-255ï¼‰**è½¬æ¢ä¸º**æ¨¡æ‹Ÿä¿¡å·ï¼ˆç”µå‹ï¼‰**ã€‚</p><p>æ•°å­—ä¿¡å·(0âˆ’255)â†’DACæ¨¡æ‹Ÿä¿¡å·(0âˆ’5V)æ•°å­—ä¿¡å·(0âˆ’255)DACæ¨¡æ‹Ÿä¿¡å·(0âˆ’5<em>V</em>)</p><ul><li><strong>ç¤ºä¾‹:</strong> è¾“å…¥ 127â†’127â†’ è¾“å‡º â‰ˆ2.5Vâ‰ˆ2.5Vã€‚</li></ul><h3 id="51å•ç‰‡æœºçš„å±€é™ä¸-PCF8591-çš„è¡¥å……"><a href="#51å•ç‰‡æœºçš„å±€é™ä¸-PCF8591-çš„è¡¥å……" class="headerlink" title="51å•ç‰‡æœºçš„å±€é™ä¸ PCF8591 çš„è¡¥å……"></a>51å•ç‰‡æœºçš„å±€é™ä¸ PCF8591 çš„è¡¥å……</h3><table><thead><tr><th align="left">è®¾å¤‡</th><th align="left">é™åˆ¶&#x2F;èƒ½åŠ›</th></tr></thead><tbody><tr><td align="left"><strong>51å•ç‰‡æœº</strong></td><td align="left">åªèƒ½è¯†åˆ«å’Œè¾“å‡ºæ•°å­—ä¿¡å·ï¼ˆ0&#x2F;1ï¼‰ã€‚</td></tr><tr><td align="left"><strong>PCF8591</strong></td><td align="left"><strong>4è·¯AD</strong> (è¯»å–ä¼ æ„Ÿå™¨) + <strong>1è·¯DA</strong> (è¾“å‡ºæ§åˆ¶ç”µå‹)ã€‚</td></tr></tbody></table><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><table><thead><tr><th align="center">åŠŸèƒ½</th><th align="center">è¾“å…¥ç±»å‹</th><th align="center">è¾“å‡ºç±»å‹</th><th align="center">åº”ç”¨å®ä¾‹</th></tr></thead><tbody><tr><td align="center"><strong>AD</strong></td><td align="center">æ¨¡æ‹Ÿä¼ æ„Ÿå™¨</td><td align="center">æ•°å­—å€¼</td><td align="center">æ¸©åº¦æ£€æµ‹ã€å…‰ç…§æ£€æµ‹</td></tr><tr><td align="center"><strong>DA</strong></td><td align="center">æ•°å­—å€¼</td><td align="center">æ¨¡æ‹Ÿç”µå‹</td><td align="center">LEDè°ƒå…‰ã€å£°éŸ³è¾“å‡º</td></tr></tbody></table><h2 id="ğŸ”§-PCF8591åº”ç”¨å±‚"><a href="#ğŸ”§-PCF8591åº”ç”¨å±‚" class="headerlink" title="ğŸ”§ PCF8591åº”ç”¨å±‚"></a>ğŸ”§ PCF8591åº”ç”¨å±‚</h2><h3 id="1-èŠ¯ç‰‡æ¦‚è¿°"><a href="#1-èŠ¯ç‰‡æ¦‚è¿°" class="headerlink" title="1. èŠ¯ç‰‡æ¦‚è¿°"></a>1. èŠ¯ç‰‡æ¦‚è¿°</h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111105134801.png"></p><p><strong>PCF8591 &#x3D; 8ä½AD&#x2F;DAè½¬æ¢å™¨ + I2Cæ¥å£</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TEXTèŠ¯ç‰‡å¼•è„šï¼š</span><br><span class="line">  AIN0-AIN3ï¼š4è·¯æ¨¡æ‹Ÿè¾“å…¥ï¼ˆADï¼‰</span><br><span class="line">  AOUTï¼š     1è·¯æ¨¡æ‹Ÿè¾“å‡ºï¼ˆDAï¼‰</span><br><span class="line">  SCL/SDAï¼š  I2Cé€šä¿¡æ¥å£</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111105211035.png"></p><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111105343352.png"></p><h3 id="2-è®¾å¤‡åœ°å€ï¼ˆæ¥è‡ªæ•°æ®æ‰‹å†Œ"><a href="#2-è®¾å¤‡åœ°å€ï¼ˆæ¥è‡ªæ•°æ®æ‰‹å†Œ" class="headerlink" title="2. è®¾å¤‡åœ°å€ï¼ˆæ¥è‡ªæ•°æ®æ‰‹å†Œ)"></a>2. è®¾å¤‡åœ°å€ï¼ˆæ¥è‡ªæ•°æ®æ‰‹å†Œ)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C// åœ°å€æ ¼å¼ï¼š1001 A2 A1 A0 R/W</span><br><span class="line">// A2/A1/A0ç”±ç¡¬ä»¶å¼•è„šå†³å®šï¼ˆé€šå¸¸æ¥åœ°ï¼‰</span><br><span class="line"></span><br><span class="line">#define PCF8591_ADDR_W  0x90  // 1001 0000 (å†™)</span><br><span class="line">#define PCF8591_ADDR_R  0x91  // 1001 0001 (è¯»)</span><br></pre></td></tr></table></figure><p><strong>åœ°å€æ¨å¯¼</strong>ï¼š</p><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111105438501.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">TEXTåŸºç¡€åœ°å€ï¼š1001 000X</span><br><span class="line">         â”‚â”‚â”‚â”‚ â”‚â”‚â”‚â””â”€ R/Wä½</span><br><span class="line">         â”‚â”‚â”‚â”‚ â”‚â””â”€â”€â”€ A0å¼•è„šï¼ˆ0=GNDï¼‰</span><br><span class="line">         â”‚â”‚â”‚â”‚ â””â”€â”€â”€â”€ A1å¼•è„šï¼ˆ0=GNDï¼‰</span><br><span class="line">         â”‚â”‚â”‚â””â”€â”€â”€â”€â”€â”€ A2å¼•è„šï¼ˆ0=GNDï¼‰</span><br><span class="line">         â””â”´â”´â”€â”€â”€â”€â”€â”€â”€ å›ºå®šæ ‡è¯†</span><br><span class="line"></span><br><span class="line">å†™åœ°å€ï¼š1001 0000 = 0x90</span><br><span class="line">è¯»åœ°å€ï¼š1001 0001 = 0x91</span><br></pre></td></tr></table></figure><hr><h3 id="3-æ§åˆ¶å­—èŠ‚ï¼ˆæ¥è‡ªæ•°æ®æ‰‹å†Œï¼‰"><a href="#3-æ§åˆ¶å­—èŠ‚ï¼ˆæ¥è‡ªæ•°æ®æ‰‹å†Œï¼‰" class="headerlink" title="3. æ§åˆ¶å­—èŠ‚ï¼ˆæ¥è‡ªæ•°æ®æ‰‹å†Œï¼‰"></a>3. æ§åˆ¶å­—èŠ‚ï¼ˆæ¥è‡ªæ•°æ®æ‰‹å†Œï¼‰</h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111105510306.png">]</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// æ§åˆ¶å­—èŠ‚æ ¼å¼ï¼š</span><br><span class="line">// bit7 | bit6 | bit5 | bit4 | bit3 | bit2 | bit1 | bit0</span><br><span class="line">//  0   | DAC  | AIN2 | AIN1 | AIN0 |  0   | Auto | Auto</span><br><span class="line">//        ä½¿èƒ½   é€šé“é€‰æ‹©(0-3)         è‡ªåŠ¨å¢é‡æ¨¡å¼</span><br><span class="line"></span><br><span class="line">//æ»‘åŠ¨å˜é˜»å™¨ 0000 1000</span><br><span class="line">#define PCF8591_DAC_OFF  0x00  // 0000 0000</span><br><span class="line">#define PCF8591_DAC_ON   0x40  // 0100 0000</span><br></pre></td></tr></table></figure><h3 id="AD-è¯»å–å‡½æ•°"><a href="#AD-è¯»å–å‡½æ•°" class="headerlink" title="AD è¯»å–å‡½æ•°"></a>AD è¯»å–å‡½æ•°</h3><p><strong>PCF8591 è¯»å–ç‰¹ç‚¹:</strong> æ¯æ¬¡ä½¿ç”¨è¯»åœ°å€ <code>0x91</code> é€šä¿¡æ—¶ï¼Œå®ƒä¼šè¿”å›<strong>ä¸¤ä¸ªå­—èŠ‚</strong>ï¼šç¬¬ä¸€ä¸ªæ˜¯çŠ¶æ€&#x2F;æ§åˆ¶å­—ï¼Œç¬¬äºŒä¸ªæ‰æ˜¯æˆ‘ä»¬éœ€è¦çš„ AD æ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">unsigned char Ad_Read(unsigned char addr)</span><br><span class="line">&#123;</span><br><span class="line">unsigned char temp;</span><br><span class="line">IIC_Start();</span><br><span class="line">IIC_SendByte(0x90);</span><br><span class="line">IIC_WaitAck();</span><br><span class="line">IIC_SendByte(addr);</span><br><span class="line">IIC_WaitAck();</span><br><span class="line"></span><br><span class="line">IIC_Start();</span><br><span class="line">IIC_SendByte(0x91);</span><br><span class="line">IIC_WaitAck();</span><br><span class="line">temp = IIC_RecByte();</span><br><span class="line">IIC_SendAck(1);//åº”å¸¦ä¿¡å·  åªæœ‰ä¸»æœºæ¥æ”¶ä¿¡å·æ‰éœ€è¦å‘é€</span><br><span class="line">IIC_Stop();</span><br><span class="line">return temp; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="DA-è¾“å‡ºå‡½æ•°"><a href="#DA-è¾“å‡ºå‡½æ•°" class="headerlink" title="DA è¾“å‡ºå‡½æ•°"></a>DA è¾“å‡ºå‡½æ•°</h3><p>è¦é€šè¿‡ DA è¾“å‡ºä¸€ä¸ªæ•°å­—å€¼ <code>dat</code> (0-255)ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">void Da_Write(unsigned char dat)</span><br><span class="line">&#123;</span><br><span class="line">    IIC_Start();                   // 1. STARTä¿¡å·</span><br><span class="line">    IIC_SendByte(0x90);            // 2. å‘é€å†™åœ°å€ (0x90)</span><br><span class="line">    IIC_WaitAck();                 // 3. ç­‰å¾…åº”ç­”</span><br><span class="line">    IIC_SendByte(0x40);            // 4. å‘é€æ§åˆ¶å­—èŠ‚ (DACä½¿èƒ½)</span><br><span class="line">    IIC_WaitAck();                 // 5. ç­‰å¾…åº”ç­”</span><br><span class="line">    IIC_SendByte(dat);             // 6. å‘é€DAå€¼ (0-255)</span><br><span class="line">    IIC_WaitAck();                 // 7. ç­‰å¾…åº”ç­”</span><br><span class="line">    IIC_Stop();                    // 8. STOPä¿¡å·</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p> <strong>æ˜“é”™ç‚¹</strong>ï¼šæ··æ·†<code>IIC_SendByte</code>å’Œ<code>IIC_SendAck</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;I2C-åè®®ï¼ˆPCF8591ï¼‰&quot;&gt;&lt;a href=&quot;#I2C-åè®®ï¼ˆPCF8591ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;I2C åè®®ï¼ˆPCF8591ï¼‰&quot;&gt;&lt;/a&gt;I2C åè®®ï¼ˆPCF8591ï¼‰&lt;/h1&gt;&lt;p&gt;æœ¬æ–‡æ¡£è®°å½•äº† I2C é€šä¿¡åè®®çš„åŸºç¡€</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>6.DS1302å®æ—¶æ—¶é’Ÿ</title>
    <link href="https://roselin1217.github.io/2025/11/24/6.DS1302/"/>
    <id>https://roselin1217.github.io/2025/11/24/6.DS1302/</id>
    <published>2025-11-24T02:00:00.000Z</published>
    <updated>2025-11-28T10:19:05.479Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ğŸ•°ï¸-DS1302-å®æ—¶é’ŸèŠ¯ç‰‡å­¦ä¹ ç¬”è®°"><a href="#ğŸ•°ï¸-DS1302-å®æ—¶é’ŸèŠ¯ç‰‡å­¦ä¹ ç¬”è®°" class="headerlink" title="ğŸ•°ï¸ DS1302 å®æ—¶é’ŸèŠ¯ç‰‡å­¦ä¹ ç¬”è®°"></a>ğŸ•°ï¸ DS1302 å®æ—¶é’ŸèŠ¯ç‰‡å­¦ä¹ ç¬”è®°</h1><h2 id="ä¸€ã€DS1302-é€šè®¯åè®®"><a href="#ä¸€ã€DS1302-é€šè®¯åè®®" class="headerlink" title="ä¸€ã€DS1302 é€šè®¯åè®®"></a>ä¸€ã€DS1302 é€šè®¯åè®®</h2><p>DS1302 é‡‡ç”¨ <strong>Dallas&#x2F;Maxim ä¸‰çº¿åŒæ­¥ä¸²è¡Œæ¥å£</strong>ï¼ˆä¸“æœ‰åè®®ï¼‰ã€‚</p><h3 id="1-ä¿¡å·çº¿"><a href="#1-ä¿¡å·çº¿" class="headerlink" title="1. ä¿¡å·çº¿"></a>1. ä¿¡å·çº¿</h3><p>èŠ¯ç‰‡ä»…éœ€ 3 æ ¹ä¿¡å·çº¿è¿›è¡Œé€šä¿¡ï¼š</p><ul><li><strong>SCLK</strong>ï¼šä¸²è¡Œæ—¶é’Ÿï¼ˆ<strong>ä¸»æœºè¾“å‡º</strong>ï¼‰</li><li><strong>I&#x2F;O</strong>ï¼šåŒå‘æ•°æ®çº¿ï¼ˆ<strong>å¼€æ¼è¾“å‡º</strong>ï¼Œå¿…é¡»å¤–æ¥ä¸Šæ‹‰ç”µé˜»ï¼‰</li><li><strong>RST</strong>ï¼šç‰‡é€‰&#x2F;å¤ä½ï¼ˆé«˜ç”µå¹³æœ‰æ•ˆï¼Œ<strong>é€šä¿¡å¼€å§‹&#x2F;ç»“æŸæ ‡å¿—</strong>ï¼‰</li></ul><h3 id="2-é€šä¿¡è§„åˆ™"><a href="#2-é€šä¿¡è§„åˆ™" class="headerlink" title="2. é€šä¿¡è§„åˆ™"></a>2. é€šä¿¡è§„åˆ™</h3><table><thead><tr><th><strong>æ­¥éª¤</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td><strong>å¼€å§‹</strong></td><td>å¿…é¡»å…ˆæ‹‰é«˜ <strong>RST</strong></td></tr><tr><td><strong>æµç¨‹</strong></td><td>å…ˆå‘é€ <strong>1 å­—èŠ‚å‘½ä»¤</strong> â†’ å†è¯»&#x2F;å†™ <strong>1 å­—èŠ‚æˆ–å¤šä¸ªå­—èŠ‚æ•°æ®</strong></td></tr><tr><td><strong>æ•°æ®é¡ºåº</strong></td><td>æ•°æ®ä¼ è¾“æ—¶ï¼Œ<strong>ä½ä½åœ¨å‰ (LSB first)</strong></td></tr><tr><td><strong>ç»“æŸ</strong></td><td>å¿…é¡»æ‹‰ä½ <strong>RST</strong></td></tr></tbody></table><h2 id="äºŒã€ç¨‹åºä¸­å¸¸ç”¨å‘½ä»¤"><a href="#äºŒã€ç¨‹åºä¸­å¸¸ç”¨å‘½ä»¤" class="headerlink" title="äºŒã€ç¨‹åºä¸­å¸¸ç”¨å‘½ä»¤"></a>äºŒã€ç¨‹åºä¸­å¸¸ç”¨å‘½ä»¤</h2><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251120213917095.png" alt="image-20251120213917095"></p><h3 id="âš ï¸-ç¼–ç¨‹é‡è¦æé†’"><a href="#âš ï¸-ç¼–ç¨‹é‡è¦æé†’" class="headerlink" title="âš ï¸ ç¼–ç¨‹é‡è¦æé†’"></a>âš ï¸ ç¼–ç¨‹é‡è¦æé†’</h3><ol><li><strong>å†™ä¿æŠ¤æ§åˆ¶ï¼š</strong><ul><li><strong>å…³é—­å†™ä¿æŠ¤</strong>ï¼ˆå…è®¸å†™å…¥ï¼‰ï¼š<code>Write_Ds1302_Byte(0x8E, 0x00);</code></li><li><strong>æ‰“å¼€å†™ä¿æŠ¤</strong>ï¼ˆç¦æ­¢å†™å…¥ï¼‰ï¼š<code>Write_Ds1302_Byte(0x8E, 0x80);</code></li></ul></li><li><strong>æ—¶é—´å¯åŠ¨ï¼š</strong><ul><li>åœ¨å†™å…¥<strong>ç§’å¯„å­˜å™¨</strong> (<code>0x80</code>) çš„å€¼æ—¶ï¼Œå¿…é¡»ç¡®ä¿å…¶ <strong>CH ä½ (bit7) ä¸º 0</strong>ï¼Œå³éœ€è¦å¯¹å†™å…¥å€¼è¿›è¡Œ <code>&amp; 0x7F</code> æ“ä½œï¼Œå¦åˆ™æ—¶é—´å°†åœæ­¢ã€‚</li></ul></li></ol><h2 id="ä¸‰ã€ç¨‹åºä¸­çš„æ•°æ®è½¬æ¢ï¼šåè¿›åˆ¶-â†”-BCD-ç "><a href="#ä¸‰ã€ç¨‹åºä¸­çš„æ•°æ®è½¬æ¢ï¼šåè¿›åˆ¶-â†”-BCD-ç " class="headerlink" title="ä¸‰ã€ç¨‹åºä¸­çš„æ•°æ®è½¬æ¢ï¼šåè¿›åˆ¶ â†” BCD ç "></a>ä¸‰ã€ç¨‹åºä¸­çš„æ•°æ®è½¬æ¢ï¼šåè¿›åˆ¶ â†” BCD ç </h2><p>DS1302 çš„æ‰€æœ‰æ—¶é—´&#x2F;æ—¥æœŸ<strong>å¯„å­˜å™¨</strong>éƒ½ä½¿ç”¨<strong>BCD (Binary-Coded Decimal) ç </strong> å­˜å‚¨æ•°æ®ï¼Œè€Œä¸æ˜¯çº¯äºŒè¿›åˆ¶ã€‚</p><h3 id="1-åè¿›åˆ¶-â†’-BCD-ç ï¼ˆå†™å…¥æ—¶ä½¿ç”¨ï¼‰"><a href="#1-åè¿›åˆ¶-â†’-BCD-ç ï¼ˆå†™å…¥æ—¶ä½¿ç”¨ï¼‰" class="headerlink" title="1. åè¿›åˆ¶ â†’ BCD ç ï¼ˆå†™å…¥æ—¶ä½¿ç”¨ï¼‰"></a>1. åè¿›åˆ¶ â†’ BCD ç ï¼ˆå†™å…¥æ—¶ä½¿ç”¨ï¼‰</h3><p>å°†åè¿›åˆ¶æ•°æ‹†åˆ†ä¸ºâ€œåä½â€å’Œâ€œä¸ªä½â€ï¼Œå¹¶åˆ†åˆ«æ”¾å…¥ BCD å­—èŠ‚çš„é«˜ 4 ä½å’Œä½ 4 ä½ã€‚<br>$$<br>BCD &#x3D; \left(\frac{åè¿›åˆ¶}{10} \ll 4\right) ; \mid ; \left(åè¿›åˆ¶ \bmod 10\right)<br>$$<br>æˆ–ä½¿ç”¨åŠ æ³•ï¼š<br>$$<br>BCD &#x3D; \left(\left(\frac{åè¿›åˆ¶}{10}\right) \ll 4\right) + \left(åè¿›åˆ¶ \bmod 10\right)<br>$$<br>ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">23 â†’ (2&lt;&lt;4)|3 = 0x23</span><br><span class="line">09 â†’ (0&lt;&lt;4)|9 = 0x09</span><br><span class="line">58 â†’ 0x58</span><br></pre></td></tr></table></figure><h3 id="2-BCD-ç -â†’-åè¿›åˆ¶ï¼ˆè¯»å–æ—¶ä½¿ç”¨ï¼‰"><a href="#2-BCD-ç -â†’-åè¿›åˆ¶ï¼ˆè¯»å–æ—¶ä½¿ç”¨ï¼‰" class="headerlink" title="2. BCD ç  â†’ åè¿›åˆ¶ï¼ˆè¯»å–æ—¶ä½¿ç”¨ï¼‰"></a>2. BCD ç  â†’ åè¿›åˆ¶ï¼ˆè¯»å–æ—¶ä½¿ç”¨ï¼‰</h3><p>å°† BCD å­—èŠ‚çš„é«˜ 4 ä½ä¹˜ä»¥ 10ï¼Œç„¶ååŠ ä¸Šä½ 4 ä½ã€‚<br>$$<br>åè¿›åˆ¶ &#x3D; \left(\frac{BCD}{16}\right) \times 10 + \left(BCD \bmod 16\right)<br>$$<br>æˆ–ä½¿ç”¨ç§»ä½æ“ä½œï¼š<br>$$<br>åè¿›åˆ¶ &#x3D; \left(BCD \gg 4\right) \times 10 + \left(BCD \land 0x0F\right)<br>$$</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x23 â†’ (2)*10 + 3 = 23</span><br><span class="line">0x59 â†’ 5*10 + 9 = 59</span><br></pre></td></tr></table></figure><h3 id="3-å®Œæ•´å†™å…¥å¹´æœˆæ—¥æ—¶åˆ†ç§’"><a href="#3-å®Œæ•´å†™å…¥å¹´æœˆæ—¥æ—¶åˆ†ç§’" class="headerlink" title="3. å®Œæ•´å†™å…¥å¹´æœˆæ—¥æ—¶åˆ†ç§’"></a>3. å®Œæ•´å†™å…¥å¹´æœˆæ—¥æ—¶åˆ†ç§’</h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251120221158940.png" alt="image-20251120221158940"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;intrins.h&quot;</span><br><span class="line">sbit SDA = P2 ^ 3;</span><br><span class="line">sbit RST = P1 ^ 3;</span><br><span class="line">sbit SCK = P1 ^ 7;</span><br><span class="line"></span><br><span class="line">// Write_Ds1302_Byte(addr,dat)</span><br><span class="line">void Set_Rtc(unsigned char *ucRtc)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned char i;</span><br><span class="line">  Write_Ds1302_Byte(0x8e, 0x00); // ç¦æ­¢å†™ä¿æŠ¤ æ§åˆ¶å¯„å­˜å™¨ bit7 æ˜¯ WP ä½ï¼Œ0=å…è®¸å†™å…¥æ‰€æœ‰å¯„å­˜å™¨</span><br><span class="line">  Write_Ds1302_Byte(0x80, 0x80); // æš‚åœè®¾å¤‡è¿è¡Œ</span><br><span class="line">  for (i = 0; i &lt; 3; i++)</span><br><span class="line">    Write_Ds1302_Byte(0x84 - 2 * i, ucRtc[i] / 10 % 10 &lt;&lt; 4 | ucRtc[i] % 10);//åè¿›åˆ¶æ•´æ•°è½¬æ¢ä¸ºBCDç  æ—¶åˆ†ç§’é¡ºåº</span><br><span class="line">    // è¿™è¡Œä»£ç æŠŠä¸€ä¸ªåè¿›åˆ¶æ•°ï¼ˆæ¯”å¦‚23ï¼‰è½¬æ¢æˆäº†BCDç ï¼ˆ`0010 0011`ï¼Œå³0x23ï¼‰ã€‚</span><br><span class="line">  Write_Ds1302_Byte(0x8e, 0x80);//å†™ä¿æŠ¤</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Read_Rtc(unsigned char *ucRtc)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned char i;</span><br><span class="line">  unsigned temp;</span><br><span class="line">  EA = 0; // å…³é—­æ€»ä¸­æ–­ï¼Œé˜²æ­¢æ—¶åºé”™è¯¯</span><br><span class="line">  for (i = 0; i &lt; 3; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    temp = Read_Ds1302_Byte(0x85 - 2 * i);</span><br><span class="line">    ucRtc[i] = temp / 16 * 10 + temp % 16;//BCDç åˆ°åè¿›åˆ¶æ•°çš„è½¬æ¢ã€‚</span><br><span class="line">    //è¿™è¡Œä»£ç æŠŠBCDç ï¼ˆæ¯”å¦‚0x23ï¼‰è½¬æ¢å›äº†åè¿›åˆ¶æ•°23ã€‚</span><br><span class="line">  &#125;</span><br><span class="line">  EA = 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ğŸ•°ï¸-DS1302-å®æ—¶é’ŸèŠ¯ç‰‡å­¦ä¹ ç¬”è®°&quot;&gt;&lt;a href=&quot;#ğŸ•°ï¸-DS1302-å®æ—¶é’ŸèŠ¯ç‰‡å­¦ä¹ ç¬”è®°&quot; class=&quot;headerlink&quot; title=&quot;ğŸ•°ï¸ DS1302 å®æ—¶é’ŸèŠ¯ç‰‡å­¦ä¹ ç¬”è®°&quot;&gt;&lt;/a&gt;ğŸ•°ï¸ DS1302 å®æ—¶é’ŸèŠ¯ç‰‡å­¦ä¹ ç¬”è®°&lt;/h1&gt;&lt;</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>7.NE555é¢‘ç‡æµ‹é‡ç³»ç»Ÿè®¾è®¡</title>
    <link href="https://roselin1217.github.io/2025/11/24/7.NE555/"/>
    <id>https://roselin1217.github.io/2025/11/24/7.NE555/</id>
    <published>2025-11-24T02:00:00.000Z</published>
    <updated>2025-11-28T10:19:18.122Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NE555é¢‘ç‡æµ‹é‡ç³»ç»Ÿè®¾è®¡"><a href="#NE555é¢‘ç‡æµ‹é‡ç³»ç»Ÿè®¾è®¡" class="headerlink" title="NE555é¢‘ç‡æµ‹é‡ç³»ç»Ÿè®¾è®¡"></a>NE555é¢‘ç‡æµ‹é‡ç³»ç»Ÿè®¾è®¡</h1><h2 id="ğŸ“‹-ç³»ç»Ÿæ¦‚è¿°"><a href="#ğŸ“‹-ç³»ç»Ÿæ¦‚è¿°" class="headerlink" title="ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°"></a>ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°</h2><p>åŸºäºNE555æ–¹æ³¢å‘ç”Ÿå™¨å’Œ51å•ç‰‡æœºçš„é¢‘ç‡æµ‹é‡ç³»ç»Ÿï¼Œé€šè¿‡è®¡æ•°å™¨æ¨¡å¼ç²¾ç¡®æµ‹é‡å¤–éƒ¨è„‰å†²é¢‘ç‡ã€‚</p><hr><h2 id="ğŸ”§-ç¡¬ä»¶è®¾è®¡"><a href="#ğŸ”§-ç¡¬ä»¶è®¾è®¡" class="headerlink" title="ğŸ”§ ç¡¬ä»¶è®¾è®¡"></a>ğŸ”§ ç¡¬ä»¶è®¾è®¡</h2><h3 id="NE555åŸç†å›¾"><a href="#NE555åŸç†å›¾" class="headerlink" title="NE555åŸç†å›¾"></a>NE555åŸç†å›¾</h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251121221438634.png" alt="NE555åŸç†å›¾"></p><h3 id="å®šæ—¶å™¨æ•°æ®æ‰‹å†Œ"><a href="#å®šæ—¶å™¨æ•°æ®æ‰‹å†Œ" class="headerlink" title="å®šæ—¶å™¨æ•°æ®æ‰‹å†Œ"></a>å®šæ—¶å™¨æ•°æ®æ‰‹å†Œ</h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251121222129653.png" alt="å®šæ—¶å™¨æ•°æ®æ‰‹å†Œ"></p><hr><h2 id="ğŸ—ï¸-ç³»ç»Ÿæ•´ä½“æ¡†å›¾"><a href="#ğŸ—ï¸-ç³»ç»Ÿæ•´ä½“æ¡†å›¾" class="headerlink" title="ğŸ—ï¸ ç³»ç»Ÿæ•´ä½“æ¡†å›¾"></a>ğŸ—ï¸ ç³»ç»Ÿæ•´ä½“æ¡†å›¾</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">+------------------+</span><br><span class="line">|  NE555æ–¹æ³¢å‘ç”Ÿå™¨   |  â† ç”¨æ¥äº§ç”Ÿå·²çŸ¥/å¯è°ƒé¢‘ç‡çš„æ–¹æ³¢ï¼ˆç›¸å½“äºä¿¡å·æºï¼‰</span><br><span class="line">|  è¾“å‡ºå¼•è„š3 (OUT)   |</span><br><span class="line">+--------+---------+</span><br><span class="line">         â†“ (ä¸€æ ¹ä¿¡å·çº¿)</span><br><span class="line">   å•ç‰‡æœº P3.4 (T0å¼•è„š)</span><br><span class="line">         â†“</span><br><span class="line">+--------v---------+</span><br><span class="line">|    51å•ç‰‡æœºå†…éƒ¨    |</span><br><span class="line">|                   |</span><br><span class="line">|  T0ï¼šè®¡æ•°å™¨æ¨¡å¼    | â† ä¸“é—¨è´Ÿè´£æ•°å¤–éƒ¨è„‰å†²ä¸ªæ•°ï¼ˆ16ä½ï¼‰</span><br><span class="line">|  T1ï¼šå®šæ—¶å™¨æ¨¡å¼    | â† äº§ç”Ÿç²¾ç¡®çš„1ç§’â€œé—¸é—¨æ—¶é—´â€</span><br><span class="line">|                   |</span><br><span class="line">|  æ¯1ç§’è¯»å–ä¸€æ¬¡T0   |</span><br><span class="line">|  è®¡æ•°å€¼ â†’ é¢‘ç‡å€¼   |</span><br><span class="line">|  â†’ é€æ•°ç ç®¡æ˜¾ç¤º    |</span><br><span class="line">+-------------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ğŸ’»-ç¨‹åºè®¾è®¡"><a href="#ğŸ’»-ç¨‹åºè®¾è®¡" class="headerlink" title="ğŸ’» ç¨‹åºè®¾è®¡"></a>ğŸ’» ç¨‹åºè®¾è®¡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * @brief å®šæ—¶å™¨0åˆå§‹åŒ–å‡½æ•°</span><br><span class="line"> * é…ç½®ä¸ºè®¡æ•°å™¨æ¨¡å¼ï¼Œç”¨äºæµ‹é‡å¤–éƒ¨è„‰å†²é¢‘ç‡ã€‚</span><br><span class="line"> */</span><br><span class="line">void Timer0_Init(void) // 1æ¯«ç§’@12.000MHz</span><br><span class="line">&#123;</span><br><span class="line">AUXR &amp;= 0x7F; // å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼</span><br><span class="line">TMOD &amp;= 0xF0; // æ¸…é™¤T0çš„æ¨¡å¼ä½</span><br><span class="line">TMOD |= 0x05; // è®¾ç½®ä¸ºè®¡æ•°å™¨æ¨¡å¼(M1=0, M0=1, C/T=1)ï¼Œå¤–éƒ¨å¼•è„šT0(P3.4)çš„ä¸‹é™æ²¿è®¡æ•°</span><br><span class="line">TL0 = 0x00;  // è®¾ç½®è®¡æ•°å™¨åˆå§‹å€¼</span><br><span class="line">TH0 = 0x00;  // è®¾ç½®è®¡æ•°å™¨åˆå§‹å€¼</span><br><span class="line">TF0 = 0;  // æ¸…é™¤TF0æº¢å‡ºæ ‡å¿—</span><br><span class="line">TR0 = 1;  // å®šæ—¶å™¨0å¼€å§‹å·¥ä½œ</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @brief å®šæ—¶å™¨1åˆå§‹åŒ–å‡½æ•°</span><br><span class="line"> * é…ç½®ä¸º1msä¸­æ–­çš„å®šæ—¶å™¨ï¼Œä½œä¸ºç³»ç»Ÿçš„å¿ƒè·³ã€‚</span><br><span class="line"> */</span><br><span class="line">void Timer1_Init(void) // 1æ¯«ç§’@12.000MHz</span><br><span class="line">&#123;</span><br><span class="line">AUXR &amp;= 0xBF; // å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼</span><br><span class="line">TMOD &amp;= 0x0F; // è®¾ç½®å®šæ—¶å™¨æ¨¡å¼ (æ¸…ç©ºT1çš„è®¾ç½®)</span><br><span class="line">TL1 = 0x18;  // è®¾ç½®å®šæ—¶åˆå§‹å€¼ (65536-1000) -&gt; FC18H</span><br><span class="line">TH1 = 0xFC;  // è®¾ç½®å®šæ—¶åˆå§‹å€¼</span><br><span class="line">TF1 = 0;  // æ¸…é™¤TF1æº¢å‡ºæ ‡å¿—</span><br><span class="line">TR1 = 1;  // å®šæ—¶å™¨1å¼€å§‹è®¡æ—¶</span><br><span class="line">ET1 = 1;  // ä½¿èƒ½å®šæ—¶å™¨1ä¸­æ–­</span><br><span class="line">EA = 1;  // å¼€å¯æ€»ä¸­æ–­</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @brief å®šæ—¶å™¨1ä¸­æ–­æœåŠ¡å‡½æ•°</span><br><span class="line"> * æ¯1msæ‰§è¡Œä¸€æ¬¡ï¼Œå¤„ç†éœ€è¦å®šæ—¶æ‰§è¡Œçš„ä»»åŠ¡ã€‚</span><br><span class="line"> */</span><br><span class="line">void Timer1_Isr(void) interrupt 3</span><br><span class="line">&#123;</span><br><span class="line">uwTick++; // ç³»ç»Ÿæ»´ç­”è®¡æ—¶å™¨åŠ 1</span><br><span class="line"></span><br><span class="line">// é¢‘ç‡æµ‹é‡ï¼Œæ¯1000ms (1s) è®¡ç®—ä¸€æ¬¡</span><br><span class="line">if (++Time_1s == 1000)</span><br><span class="line">&#123;</span><br><span class="line">Time_1s = 0; // è®¡æ—¶å™¨æ¸…é›¶</span><br><span class="line">// è¯»å–T0çš„è®¡æ•°å€¼ï¼Œå³ä¸ºè¿‡å»1ç§’å†…çš„è„‰å†²æ•°(Hz)</span><br><span class="line">Freq = (TH0 &lt;&lt; 8) | TL0;</span><br><span class="line">TH0 = TL0 = 0; // æ¸…ç©ºT0è®¡æ•°å™¨ï¼Œå¼€å§‹ä¸‹ä¸€ä¸ªå‘¨æœŸçš„æµ‹é‡</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NE555é¢‘ç‡æµ‹é‡ç³»ç»Ÿè®¾è®¡&quot;&gt;&lt;a href=&quot;#NE555é¢‘ç‡æµ‹é‡ç³»ç»Ÿè®¾è®¡&quot; class=&quot;headerlink&quot; title=&quot;NE555é¢‘ç‡æµ‹é‡ç³»ç»Ÿè®¾è®¡&quot;&gt;&lt;/a&gt;NE555é¢‘ç‡æµ‹é‡ç³»ç»Ÿè®¾è®¡&lt;/h1&gt;&lt;h2 id=&quot;ğŸ“‹-ç³»ç»Ÿæ¦‚è¿°&quot;&gt;&lt;a href=&quot;#ğŸ“‹</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>8.ä»»åŠ¡è°ƒåº¦å™¨</title>
    <link href="https://roselin1217.github.io/2025/11/24/8.%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E5%99%A8/"/>
    <id>https://roselin1217.github.io/2025/11/24/8.%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E5%99%A8/</id>
    <published>2025-11-24T02:00:00.000Z</published>
    <updated>2025-11-28T10:19:34.806Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»»åŠ¡è°ƒåº¦å™¨"><a href="#ä»»åŠ¡è°ƒåº¦å™¨" class="headerlink" title="ä»»åŠ¡è°ƒåº¦å™¨"></a>ä»»åŠ¡è°ƒåº¦å™¨</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">void</span> (*task_func)(<span class="type">void</span>);          <span class="comment">// ã€1ã€‘è¦æ‰§è¡Œçš„å‡½æ•°ï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> rate_ms;        <span class="comment">// ã€2ã€‘æ¯éš”å¤šå°‘æ¯«ç§’æ‰§è¡Œä¸€æ¬¡ï¼ˆå›ºå®šå€¼ï¼‰</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> last_ms;        <span class="comment">// ã€3ã€‘ä¸Šæ¬¡æ‰§è¡Œçš„æ—¶é—´ï¼ˆä¼šè‡ªå·±å˜ï¼‰</span></span><br><span class="line">&#125; <span class="type">task_t</span>;</span><br></pre></td></tr></table></figure><h3 id="1-å®šä¹‰ç»“æ„ä½“ï¼ˆåªæ˜¯ç”»ä¸€å¼ â€œä»»åŠ¡å¡çš„æ¨¡æ¿ï¼‰"><a href="#1-å®šä¹‰ç»“æ„ä½“ï¼ˆåªæ˜¯ç”»ä¸€å¼ â€œä»»åŠ¡å¡çš„æ¨¡æ¿ï¼‰" class="headerlink" title="1. å®šä¹‰ç»“æ„ä½“ï¼ˆåªæ˜¯ç”»ä¸€å¼ â€œä»»åŠ¡å¡çš„æ¨¡æ¿ï¼‰"></a>1. å®šä¹‰ç»“æ„ä½“ï¼ˆåªæ˜¯ç”»ä¸€å¼ â€œä»»åŠ¡å¡çš„æ¨¡æ¿ï¼‰</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®€å•ä»»åŠ¡è°ƒåº¦å™¨ç»“æ„ä½“å®šä¹‰</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">void</span> (*task_func)(<span class="type">void</span>);          <span class="comment">// ä»»åŠ¡å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> rate_ms;        <span class="comment">// æ‰§è¡Œå‘¨æœŸï¼ˆæ¯«ç§’ï¼‰</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> last_ms;        <span class="comment">// ä¸Šæ¬¡æ‰§è¡Œçš„æ—¶é—´æˆ³</span></span><br><span class="line">&#125; <span class="type">task_t</span>;</span><br></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºä»»åŠ¡åˆ—è¡¨ï¼ˆçœŸæ­£å¡«å¥½çš„8å¼ ä»»åŠ¡å¡ï¼‰"><a href="#2-åˆ›å»ºä»»åŠ¡åˆ—è¡¨ï¼ˆçœŸæ­£å¡«å¥½çš„8å¼ ä»»åŠ¡å¡ï¼‰" class="headerlink" title="2. åˆ›å»ºä»»åŠ¡åˆ—è¡¨ï¼ˆçœŸæ­£å¡«å¥½çš„8å¼ ä»»åŠ¡å¡ï¼‰"></a>2. åˆ›å»ºä»»åŠ¡åˆ—è¡¨ï¼ˆçœŸæ­£å¡«å¥½çš„8å¼ ä»»åŠ¡å¡ï¼‰</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨èå†™æ³•ï¼šç”¨ .æˆå‘˜å = å€¼ï¼Œé¡ºåºéšä¾¿æ”¹ä¹Ÿä¸æ€•é”™ï¼</span></span><br><span class="line">idata <span class="type">task_t</span> Scheduler_Task[] = &#123;</span><br><span class="line">  &#123;Led_Proc, <span class="number">1</span>, <span class="number">0</span>&#125;,   <span class="comment">// LEDä»»åŠ¡ï¼Œæ¯1ms</span></span><br><span class="line">&#123;Key_Proc, <span class="number">10</span>, <span class="number">0</span>&#125;,   <span class="comment">// æŒ‰é”®ä»»åŠ¡ï¼Œæ¯10ms</span></span><br><span class="line">&#123;Seg_Proc, <span class="number">20</span>, <span class="number">0</span>&#125;,   <span class="comment">// æ•°ç ç®¡ä»»åŠ¡ï¼Œæ¯20ms</span></span><br><span class="line">&#123;Get_Time, <span class="number">100</span>, <span class="number">0</span>&#125;,   <span class="comment">// è·å–æ—¶é—´ä»»åŠ¡ï¼Œæ¯100ms</span></span><br><span class="line">&#123;Get_Temperature, <span class="number">300</span>, <span class="number">0</span>&#125;, <span class="comment">// è·å–æ¸©åº¦ä»»åŠ¡ï¼Œæ¯300ms</span></span><br><span class="line">&#123;AD_DA, <span class="number">150</span>, <span class="number">0</span>&#125;,   <span class="comment">// AD/DAä»»åŠ¡ï¼Œæ¯150ms</span></span><br><span class="line">&#123;Get_Distance, <span class="number">120</span>, <span class="number">0</span>&#125;,   <span class="comment">// è·å–è·ç¦»ä»»åŠ¡ï¼Œæ¯120ms</span></span><br><span class="line">&#123;Uart_Proc, <span class="number">10</span>, <span class="number">0</span>&#125;,   <span class="comment">// ä¸²å£å¤„ç†ä»»åŠ¡ï¼Œæ¯10ms</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="3-åˆå§‹åŒ–ï¼šè‡ªåŠ¨ç®—å‡ºæœ‰å‡ ä¸ªä»»åŠ¡"><a href="#3-åˆå§‹åŒ–ï¼šè‡ªåŠ¨ç®—å‡ºæœ‰å‡ ä¸ªä»»åŠ¡" class="headerlink" title="3. åˆå§‹åŒ–ï¼šè‡ªåŠ¨ç®—å‡ºæœ‰å‡ ä¸ªä»»åŠ¡"></a>3. åˆå§‹åŒ–ï¼šè‡ªåŠ¨ç®—å‡ºæœ‰å‡ ä¸ªä»»åŠ¡</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">idata <span class="type">unsigned</span> <span class="type">char</span> task_num;   <span class="comment">// ä»»åŠ¡æ•°é‡</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Scheduler_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    task_num = <span class="keyword">sizeof</span>(Scheduler_Task) / <span class="keyword">sizeof</span>(<span class="type">task_t</span>);  <span class="comment">// æ€»å­—èŠ‚æ•° / ç»“æ„ä½“å­—èŠ‚æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-æ ¸å¿ƒè¿è¡Œå‡½æ•°ï¼ˆæ¯1msè°ƒç”¨ä¸€æ¬¡å°±è¡Œï¼‰"><a href="#4-æ ¸å¿ƒè¿è¡Œå‡½æ•°ï¼ˆæ¯1msè°ƒç”¨ä¸€æ¬¡å°±è¡Œï¼‰" class="headerlink" title="4. æ ¸å¿ƒè¿è¡Œå‡½æ•°ï¼ˆæ¯1msè°ƒç”¨ä¸€æ¬¡å°±è¡Œï¼‰"></a>4. æ ¸å¿ƒè¿è¡Œå‡½æ•°ï¼ˆæ¯1msè°ƒç”¨ä¸€æ¬¡å°±è¡Œï¼‰</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Scheduler_Run</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> now_time = uwTick;   <span class="comment">// å½“å‰æ¯«ç§’è®¡æ•°å€¼ï¼ˆè‡ªå·±å†™ä¸ªå®šæ—¶å™¨ç»´æŠ¤ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; task_num; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å½“å‰æ—¶é—´ - ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´ &gt;= å‘¨æœŸ â†’ è¯¥å¹²æ´»äº†</span></span><br><span class="line">        <span class="keyword">if</span>(now_time - Scheduler_Task[i].last_ms &gt;= Scheduler_Task[i].rate_ms)</span><br><span class="line">        &#123;</span><br><span class="line">            Scheduler_Task[i].last_ms = now_time;   <span class="comment">// è®°ä½è¿™æ¬¡æ—¶é—´</span></span><br><span class="line">            Scheduler_Task[i].task_func();          <span class="comment">// çœŸæ­£æ‰§è¡Œä»»åŠ¡ï¼ï¼</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨æ–¹æ³•ï¼ˆè¶…çº§ç®€å•ï¼‰"><a href="#ä½¿ç”¨æ–¹æ³•ï¼ˆè¶…çº§ç®€å•ï¼‰" class="headerlink" title="ä½¿ç”¨æ–¹æ³•ï¼ˆè¶…çº§ç®€å•ï¼‰"></a>ä½¿ç”¨æ–¹æ³•ï¼ˆè¶…çº§ç®€å•ï¼‰</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç³»ç»Ÿåˆå§‹åŒ–...</span></span><br><span class="line">    Timer0_Init();         <span class="comment">// 1msä¸­æ–­ï¼Œé‡Œé¢ç»´æŠ¤ uwTick++    idata unsigned long int uwTick;</span></span><br><span class="line">    Scheduler_Init();      <span class="comment">// è®¡ç®—ä»»åŠ¡æ•°é‡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Scheduler_Run();   <span class="comment">// æ”¾åœ¨ä¸»å¾ªç¯é‡Œï¼Œæˆ–è€…1msä¸­æ–­é‡Œéƒ½è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é‡ç‚¹å£è¯€è¡¨"><a href="#é‡ç‚¹å£è¯€è¡¨" class="headerlink" title="é‡ç‚¹å£è¯€è¡¨"></a>é‡ç‚¹å£è¯€è¡¨</h3><table><thead><tr><th>é¡¹ç›®</th><th>æ­£ç¡®å†™æ³•</th><th>é”™è¯¯å†™æ³•</th><th>ä¸ºä»€ä¹ˆ</th></tr></thead><tbody><tr><td>å–æˆå‘˜</td><td><code>Scheduler_Task[i].task_func()</code></td><td><code>Scheduler_Task[i]-&gt;task_func()</code></td><td>å®ç‰©ç”¨ .   æŒ‡é’ˆç”¨ -&gt;</td></tr><tr><td>åˆå§‹åŒ–</td><td><code>{ .task_func = xxx, .rate_ms = yyy }</code></td><td>ä¹±åºå†™</td><td>é˜²æ­¢ç»“æ„ä½“æ”¹é¡ºåºåæ­»æœº</td></tr><tr><td>è°ƒç”¨å‡½æ•°</td><td><code>task_func()</code> åŠ æ‹¬å·</td><td>åªå†™ <code>task_func</code></td><td>æ²¡æ‹¬å·ç­‰äºæ²¡æŒ‰é¥æ§å™¨</td></tr><tr><td>è®¡ç®—ä»»åŠ¡æ•°é‡</td><td><code>sizeof(array)/sizeof(task_t)</code></td><td>æ‰‹åŠ¨å†™æ•°å­—8</td><td>å¢åˆ ä»»åŠ¡ä¸ç”¨æ”¹ä»£ç </td></tr></tbody></table><h3 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h3><table><thead><tr><th>ç±»å‹</th><th>å ç”¨å­—èŠ‚</th><th>èƒ½è¡¨ç¤ºçš„èŒƒå›´ï¼ˆæ— ç¬¦å·ï¼‰</th><th>å…¸å‹ç”¨é€”</th><th>ä½ ä»£ç é‡Œå‡ºç°çš„ä¾‹å­</th></tr></thead><tbody><tr><td><code>unsigned char</code></td><td>1å­—èŠ‚</td><td>0 ~ 255</td><td>æ™®é€šæ ‡å¿—ä½ã€ç«¯å£ã€è®¡æ•°å°æ•°å­—</td><td><code>unsigned char i;</code> <code>P0 = 0x55;</code></td></tr><tr><td><code>unsigned int</code></td><td>2å­—èŠ‚</td><td>0 ~ 65,535</td><td>ä¸€èˆ¬è®¡æ•°ã€å»¶æ—¶ã€ADCå€¼</td><td><code>unsigned int delay;</code></td></tr><tr><td><code>unsigned long int</code></td><td>4å­—èŠ‚</td><td>0 ~ 4,294,967,295ï¼ˆ42äº¿ï¼‰</td><td><strong>æ—¶é—´æˆ³ã€é•¿è®¡æ—¶ã€å¤§æ•°å€¼ã€æ¯«ç§’è®¡æ•°</strong></td><td><code>uwTick</code> ç³»ç»Ÿæ¯«ç§’è®¡æ—¶ <code>last_ms</code>ã€<code>rate_ms</code></td></tr><tr><td><code>unsigned long</code></td><td>4å­—èŠ‚</td><td>åŒä¸Šï¼Œå’Œä¸Šé¢å®Œå…¨ä¸€æ ·</td><td>å¾ˆå¤šäººæ‡’å¾—å†™ intï¼Œå°±ç®€å†™æˆè¿™ä¸ª</td><td>å¾ˆå¤šä»£ç é‡Œä½ ä¼šçœ‹åˆ° <code>unsigned long</code></td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä»»åŠ¡è°ƒåº¦å™¨&quot;&gt;&lt;a href=&quot;#ä»»åŠ¡è°ƒåº¦å™¨&quot; class=&quot;headerlink&quot; title=&quot;ä»»åŠ¡è°ƒåº¦å™¨&quot;&gt;&lt;/a&gt;ä»»åŠ¡è°ƒåº¦å™¨&lt;/h1&gt;&lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pr</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>9.ä¸²å£é€šä¿¡ (UART) </title>
    <link href="https://roselin1217.github.io/2025/11/24/9.%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1%20(UART)/"/>
    <id>https://roselin1217.github.io/2025/11/24/9.%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1%20(UART)/</id>
    <published>2025-11-24T02:00:00.000Z</published>
    <updated>2025-11-28T10:19:42.275Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ğŸ“-ä¸²å£é€šä¿¡-UART"><a href="#ğŸ“-ä¸²å£é€šä¿¡-UART" class="headerlink" title="ğŸ“ ä¸²å£é€šä¿¡ (UART)"></a>ğŸ“ ä¸²å£é€šä¿¡ (UART)</h1><h2 id="1-ä¸²å£-UART-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-ä¸²å£-UART-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. ä¸²å£ (UART) æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. ä¸²å£ (UART) æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>ä¸²å£æ˜¯ä¸€ç§ç”¨äºç‚¹å¯¹ç‚¹è®¾å¤‡é—´é€šä¿¡çš„<strong>å¼‚æ­¥ä¸²è¡Œ</strong>é€šä¿¡åè®®ã€‚</p><h3 id="ğŸš€-ä¸²å£ä¸-IÂ²C-çš„æ ¸å¿ƒå¯¹æ¯”"><a href="#ğŸš€-ä¸²å£ä¸-IÂ²C-çš„æ ¸å¿ƒå¯¹æ¯”" class="headerlink" title="ğŸš€ ä¸²å£ä¸ IÂ²C çš„æ ¸å¿ƒå¯¹æ¯”"></a>ğŸš€ ä¸²å£ä¸ IÂ²C çš„æ ¸å¿ƒå¯¹æ¯”</h3><table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>ä¸²å£ (UART)</strong></th><th><strong>IÂ²C (å·²å­¦)</strong></th></tr></thead><tbody><tr><td><strong>ä¼ è¾“ç±»å‹</strong></td><td><strong>ä¸²è¡Œ</strong> (ä¸€ä½ä¸€ä½)</td><td><strong>ä¸²è¡Œ</strong> (ä¸€ä½ä¸€ä½)</td></tr><tr><td><strong>åŒæ­¥æ€§</strong></td><td><strong>å¼‚æ­¥</strong> (æ— æ—¶é’Ÿçº¿)</td><td><strong>åŒæ­¥</strong> (æœ‰ SCL æ—¶é’Ÿçº¿)</td></tr><tr><td><strong>æ—¶é’Ÿæº</strong></td><td><strong>å†…éƒ¨å®šæ—¶å™¨</strong>ç”Ÿæˆæ³¢ç‰¹ç‡æ—¶é’Ÿ</td><td><strong>ä¸»è®¾å¤‡</strong>é€šè¿‡ SCL çº¿æä¾›å¤–éƒ¨æ—¶é’Ÿ</td></tr><tr><td><strong>æ‹“æ‰‘ç»“æ„</strong></td><td><strong>ç‚¹å¯¹ç‚¹</strong> (å¤šæ•°æƒ…å†µ)</td><td><strong>æ€»çº¿å‹</strong> (å¤šä¸»å¤šä»)</td></tr><tr><td><strong>åœ°å€å¯»å€</strong></td><td><strong>ä¸éœ€è¦</strong>åœ°å€</td><td><strong>éœ€è¦</strong>åœ°å€ (7&#x2F;10 ä½åœ°å€)</td></tr><tr><td><strong>åŒå·¥æ€§</strong></td><td><strong>å…¨åŒå·¥</strong> (TX&#x2F;RX åˆ†ç¦»ï¼Œå¯åŒæ—¶æ”¶å‘)</td><td><strong>åŠåŒå·¥</strong> (SDA çº¿ï¼Œåˆ†æ—¶æ”¶å‘)</td></tr><tr><td><strong>ä¿¡å·çº¿</strong></td><td>2 æ ¹ï¼šTXD (å‘é€), RXD (æ¥æ”¶)</td><td>2 æ ¹ï¼šSDA (æ•°æ®), SCL (æ—¶é’Ÿ)</td></tr><tr><td><strong>æ ¸å¿ƒæœºåˆ¶</strong></td><td>æ³¢ç‰¹ç‡ã€èµ·å§‹ä½ã€åœæ­¢ä½</td><td>èµ·å§‹&#x2F;åœæ­¢ä¿¡å·ã€ACK&#x2F;NACK</td></tr></tbody></table><h3 id="ğŸ”-ä¸²å£çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#ğŸ”-ä¸²å£çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="ğŸ” ä¸²å£çš„æ ¸å¿ƒæ¦‚å¿µ"></a>ğŸ” ä¸²å£çš„æ ¸å¿ƒæ¦‚å¿µ</h3><ul><li><strong>å¼‚æ­¥ (Asynchronous):</strong> æ”¶å‘åŒæ–¹å¿…é¡»çº¦å®š<strong>æ³¢ç‰¹ç‡</strong>ï¼Œé€šè¿‡æ•°æ®å¸§ä¸­çš„<strong>èµ·å§‹ä½</strong>å®ç°åŒæ­¥ã€‚</li><li><strong>æ³¢ç‰¹ç‡ (Baud Rate):</strong> æ¯ç§’ä¼ è¾“çš„ä½æ•° (bps)ï¼Œæ”¶å‘åŒæ–¹å¿…é¡»ä¸€è‡´ã€‚</li><li><strong>æ•°æ®å¸§:</strong> ä¸€å¸§æ•°æ®åŒ…å«ï¼š<code>èµ·å§‹ä½ (1ä½, ä½ç”µå¹³)</code> + <code>æ•°æ®ä½ (5~8ä½)</code> + <code>æ ¡éªŒä½ (å¯é€‰)</code> + <code>åœæ­¢ä½ (1~2ä½, é«˜ç”µå¹³)</code>ã€‚</li><li><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/%E4%B8%B2%E5%8F%A3%E9%80%9A%E8%AE%AF.png"></li></ul><h2 id="2-ä¸²å£æ•°æ®æ”¶å‘ä¸è§£ææ–¹å¼"><a href="#2-ä¸²å£æ•°æ®æ”¶å‘ä¸è§£ææ–¹å¼" class="headerlink" title="2. ä¸²å£æ•°æ®æ”¶å‘ä¸è§£ææ–¹å¼"></a>2. ä¸²å£æ•°æ®æ”¶å‘ä¸è§£ææ–¹å¼</h2><p>ä¸²å£é€šä¿¡çš„æ€è·¯å¯ä»¥åˆ†ä¸ºåº•å±‚<strong>æ•°æ®é©±åŠ¨</strong>å’Œä¸Šå±‚<strong>æ•°æ®è§£æ</strong>ã€‚</p><h3 id="A-é©±åŠ¨å±‚æ€è·¯ï¼šæ•°æ®æ¥æ”¶æ–¹å¼-CPUå¦‚ä½•è·å–æ•°æ®"><a href="#A-é©±åŠ¨å±‚æ€è·¯ï¼šæ•°æ®æ¥æ”¶æ–¹å¼-CPUå¦‚ä½•è·å–æ•°æ®" class="headerlink" title="A. é©±åŠ¨å±‚æ€è·¯ï¼šæ•°æ®æ¥æ”¶æ–¹å¼ (CPUå¦‚ä½•è·å–æ•°æ®)"></a>A. é©±åŠ¨å±‚æ€è·¯ï¼šæ•°æ®æ¥æ”¶æ–¹å¼ (CPUå¦‚ä½•è·å–æ•°æ®)</h3><table><thead><tr><th><strong>æ–¹å¼</strong></th><th><strong>æè¿°</strong></th><th><strong>ä¼˜ç¼ºç‚¹</strong></th></tr></thead><tbody><tr><td>1.<strong>è½®è¯¢&#x2F;æŸ¥è¯¢ (Polling)</strong></td><td>CPU ä¸æ–­æŸ¥è¯¢æ¥æ”¶æ ‡å¿—ä½ (<code>RI</code>)ï¼Œç›´åˆ°å…¶ç½® 1 æ—¶è¯»å–æ•°æ®ã€‚</td><td><strong>ä¼˜ç‚¹:</strong> ä»£ç ç®€å•ã€‚ <strong>ç¼ºç‚¹:</strong> æ•ˆç‡æä½ï¼ŒCPU å¿™ç­‰æµªè´¹èµ„æºã€‚</td></tr><tr><td>2.<strong>ä¸­æ–­ (Interrupt)</strong></td><td>ç¡¬ä»¶æ¥æ”¶å®Œæ•°æ®åï¼Œç½®ä½ <code>RI</code> å¹¶è§¦å‘ä¸­æ–­ã€‚CPU åœ¨ä¸­æ–­æœåŠ¡å‡½æ•° (<code>ISR</code>) ä¸­å¤„ç†æ•°æ®ã€‚</td><td><strong>ä¼˜ç‚¹:</strong> <strong>æ•ˆç‡é«˜</strong>ï¼ŒCPU å¯æ‰§è¡Œä¸»ç¨‹åºã€‚ <strong>ç¼ºç‚¹:</strong> éœ€é…ç½®ä¸­æ–­ã€‚</td></tr><tr><td>3.<strong>DMA (ç›´æ¥å­˜å‚¨å™¨å­˜å–)</strong></td><td>(é«˜çº§å•ç‰‡æœº) æ•°æ®ç›´æ¥ä»ä¸²å£ç¡¬ä»¶æ¬è¿åˆ°å†…å­˜ï¼Œæ— éœ€ CPU å‚ä¸ã€‚</td><td><strong>ä¼˜ç‚¹:</strong> <strong>æœ€é«˜æ•ˆ</strong>ï¼Œå‡ ä¹ä¸å  CPU èµ„æºã€‚ <strong>ç¼ºç‚¹:</strong> é…ç½®å¤æ‚ï¼Œç¡¬ä»¶è¦æ±‚é«˜ã€‚</td></tr></tbody></table><h3 id="B-åº”ç”¨å±‚æ€è·¯ï¼šæ•°æ®è§£ææ–¹å¼-å¦‚ä½•åˆ¤æ–­ä¸€å¸§æ•°æ®ç»“æŸ"><a href="#B-åº”ç”¨å±‚æ€è·¯ï¼šæ•°æ®è§£ææ–¹å¼-å¦‚ä½•åˆ¤æ–­ä¸€å¸§æ•°æ®ç»“æŸ" class="headerlink" title="B. åº”ç”¨å±‚æ€è·¯ï¼šæ•°æ®è§£ææ–¹å¼ (å¦‚ä½•åˆ¤æ–­ä¸€å¸§æ•°æ®ç»“æŸ)"></a>B. åº”ç”¨å±‚æ€è·¯ï¼šæ•°æ®è§£ææ–¹å¼ (å¦‚ä½•åˆ¤æ–­ä¸€å¸§æ•°æ®ç»“æŸ)</h3><table><thead><tr><th><strong>æ–¹å¼</strong></th><th><strong>æè¿°</strong></th><th><strong>é€‚ç”¨åœºæ™¯</strong></th></tr></thead><tbody><tr><td>1.<strong>å­—ç¬¦æµ&#x2F;ç»“æŸç¬¦</strong></td><td>ä»¥ç‰¹å®šçš„å­—ç¬¦ï¼ˆå¦‚ <code>\n</code>, <code>\r\n</code>ï¼‰ä½œä¸ºä¸€å¸§æ•°æ®çš„ç»“æŸæ ‡å¿—ã€‚</td><td>å‘½ä»¤è¡Œäº¤äº’ã€æ–‡æœ¬ä¼ è¾“ã€‚</td></tr><tr><td>2.<strong>å›ºå®šé•¿åº¦</strong></td><td>é¢„å…ˆçº¦å®šæ•°æ®åŒ…é•¿åº¦ã€‚è®¡æ•°å™¨è¾¾åˆ°çº¦å®šé•¿åº¦åè®¤ä¸ºæ¥æ”¶å®Œæˆã€‚</td><td>ä¼ æ„Ÿå™¨æ•°æ®æµã€å›ºå®šæ ¼å¼åè®®ã€‚</td></tr><tr><td>3.<strong>å¸§å¤´&#x2F;é•¿åº¦&#x2F;æ ¡éªŒ</strong></td><td>æ•°æ®åŒ…åŒ…å«ï¼šå¸§å¤´ã€æ•°æ®é•¿åº¦ã€æœ‰æ•ˆæ•°æ®ã€æ ¡éªŒå’Œã€å¸§å°¾ã€‚</td><td><strong>æœ€å¯é </strong>ï¼Œç”¨äºå·¥ä¸šæ§åˆ¶ã€å¤æ‚è‡ªå®šä¹‰åè®®ã€‚</td></tr><tr><td>4.<strong>è¶…æ—¶ (Timeout)</strong></td><td>æ”¶åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚åå¼€å§‹è®¡æ—¶ï¼Œå¦‚æœåœ¨è®¾å®šçš„æ—¶é—´é˜ˆå€¼å†…æ²¡æœ‰æ”¶åˆ°åç»­å­—èŠ‚ï¼Œåˆ™è®¤ä¸ºå½“å‰æ•°æ®æ¥æ”¶å®Œæˆã€‚</td><td><strong>æœ€çµæ´»</strong>ï¼Œé€‚ç”¨äºæ•°æ®é•¿åº¦ä¸å›ºå®šã€å®æ—¶æ€§è¦æ±‚ä¸é«˜çš„åœºæ™¯ã€‚</td></tr></tbody></table><h2 id="3-ä»£ç æ€è·¯æ€»ç»“"><a href="#3-ä»£ç æ€è·¯æ€»ç»“" class="headerlink" title="3.ä»£ç æ€è·¯æ€»ç»“"></a>3.ä»£ç æ€è·¯æ€»ç»“</h2><p>æ‚¨çš„ä»£ç ï¼ˆåŸºäº 8051&#x2F;STC å•ç‰‡æœºï¼‰é‡‡ç”¨äº†ä»¥ä¸‹æˆç†Ÿçš„é©±åŠ¨å’Œåº”ç”¨æ€è·¯ï¼š</p><h3 id="A-æ•°æ®å‘é€æ€è·¯ï¼šæŸ¥è¯¢-å¿™ç­‰å‘é€"><a href="#A-æ•°æ®å‘é€æ€è·¯ï¼šæŸ¥è¯¢-å¿™ç­‰å‘é€" class="headerlink" title="A. æ•°æ®å‘é€æ€è·¯ï¼šæŸ¥è¯¢&#x2F;å¿™ç­‰å‘é€"></a>A. æ•°æ®å‘é€æ€è·¯ï¼š<strong>æŸ¥è¯¢&#x2F;å¿™ç­‰å‘é€</strong></h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251123114733536.png" alt="ä¸²å£é…ç½®"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;uart.h&quot;</span><br><span class="line">#include &quot;stdio.h&quot;</span><br><span class="line">void Uart1_Init(void)//9600bps@12.000MHz</span><br><span class="line">&#123;</span><br><span class="line">SCON = 0x50;//8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡</span><br><span class="line">AUXR |= 0x01;//ä¸²å£1é€‰æ‹©å®šæ—¶å™¨2ä¸ºæ³¢ç‰¹ç‡å‘ç”Ÿå™¨</span><br><span class="line">AUXR &amp;= 0xFB;//å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼</span><br><span class="line">T2L = 0xE6;//è®¾ç½®å®šæ—¶åˆå§‹å€¼</span><br><span class="line">T2H = 0xFF;//è®¾ç½®å®šæ—¶åˆå§‹å€¼</span><br><span class="line">AUXR |= 0x10;//å®šæ—¶å™¨2å¼€å§‹è®¡æ—¶</span><br><span class="line">ES = 1;//ä½¿èƒ½ä¸²å£1ä¸­æ–­</span><br><span class="line">EA = 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">extern char putchar (char ch)</span><br><span class="line">&#123;</span><br><span class="line">    SBUF = ch;</span><br><span class="line">    while(TI == 0)</span><br><span class="line">        ;</span><br><span class="line"></span><br><span class="line">    TI = 0;</span><br><span class="line">    return ch;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-æ•°æ®æ¥æ”¶æ€è·¯ï¼šä¸­æ–­æ¥æ”¶-è¶…æ—¶è§£æ"><a href="#B-æ•°æ®æ¥æ”¶æ€è·¯ï¼šä¸­æ–­æ¥æ”¶-è¶…æ—¶è§£æ" class="headerlink" title="B. æ•°æ®æ¥æ”¶æ€è·¯ï¼šä¸­æ–­æ¥æ”¶ + è¶…æ—¶è§£æ"></a>B. æ•°æ®æ¥æ”¶æ€è·¯ï¼š<strong>ä¸­æ–­æ¥æ”¶ + è¶…æ—¶è§£æ</strong></h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251123115349717.png" alt="ä¸­æ–­å·"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">void Uart1_Isr(void) interrupt 4</span><br><span class="line">&#123;</span><br><span class="line">if (RI) // åˆ¤æ–­æ˜¯å¦æ˜¯æ¥æ”¶ä¸­æ–­</span><br><span class="line">&#123;</span><br><span class="line">Uart_Rx_Flag = 1; // è®¾ç½®æ¥æ”¶æ ‡å¿—</span><br><span class="line">Uart_Rx_Tick = 0; // é‡ç½®è¶…æ—¶è®¡æ—¶å™¨</span><br><span class="line">Uart_Rx_Buf[Uart_Rx_Index++] = SBUF;</span><br><span class="line">RI = 0; // æ‰‹åŠ¨æ¸…é™¤æ¥æ”¶ä¸­æ–­è¯·æ±‚ä½</span><br><span class="line">if (Uart_Rx_Index &gt; 10)</span><br><span class="line">&#123;</span><br><span class="line">Uart_Rx_Index = 0;</span><br><span class="line">memset(Uart_Rx_Buf, 0, 10); // æº¢å‡ºåˆ™æ¸…ç©ºç¼“å†²åŒº</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">void Timer0Server() interrupt 1</span><br><span class="line">&#123;   </span><br><span class="line">    if(Uart_Rx_Flag == 1)</span><br><span class="line">        Uart_Recv_Tick ++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="III-ä»£ç è§£æï¼š8051-ä¸²å£å®ç°"><a href="#III-ä»£ç è§£æï¼š8051-ä¸²å£å®ç°" class="headerlink" title="III. ä»£ç è§£æï¼š8051 ä¸²å£å®ç°"></a>III. ä»£ç è§£æï¼š8051 ä¸²å£å®ç°</h2><h3 id="1-æ ¸å¿ƒå¯„å­˜å™¨ï¼šSBUF-Serial-Buffer-Register"><a href="#1-æ ¸å¿ƒå¯„å­˜å™¨ï¼šSBUF-Serial-Buffer-Register" class="headerlink" title="1. æ ¸å¿ƒå¯„å­˜å™¨ï¼šSBUF (Serial Buffer Register)"></a>1. æ ¸å¿ƒå¯„å­˜å™¨ï¼šSBUF (Serial Buffer Register)</h3><ul><li><strong>åŠŸèƒ½ï¼š</strong> ä¸²å£æ•°æ®äº¤æ¢çš„<strong>å”¯ä¸€é€šé“</strong>ï¼ˆâ€œä¿¡ç®±â€ï¼‰ã€‚</li><li><strong>å‘é€ï¼š</strong> å†™å…¥ <code>SBUF = ch </code>ç«‹å³å¯åŠ¨å‘é€ã€‚</li><li><strong>æ¥æ”¶ï¼š</strong> æ¥æ”¶å®Œæˆåï¼Œæ•°æ®è‡ªåŠ¨å­˜å…¥ $\text{SBUF}$ï¼Œéœ€è¯»å– $\text{ch} &#x3D; \text{SBUF}$ã€‚</li></ul><h3 id="2-æ•°æ®å‘é€ï¼šæŸ¥è¯¢-å¿™ç­‰-ç”¨äº-printf-é‡å®šå‘"><a href="#2-æ•°æ®å‘é€ï¼šæŸ¥è¯¢-å¿™ç­‰-ç”¨äº-printf-é‡å®šå‘" class="headerlink" title="2. æ•°æ®å‘é€ï¼šæŸ¥è¯¢&#x2F;å¿™ç­‰ (ç”¨äº printf é‡å®šå‘)"></a>2. æ•°æ®å‘é€ï¼šæŸ¥è¯¢&#x2F;å¿™ç­‰ (ç”¨äº <code>printf</code> é‡å®šå‘)</h3><p>è¯¥ä»£ç åˆ©ç”¨äº† <strong>C è¯­è¨€ I&#x2F;O é‡å®šå‘æœºåˆ¶</strong>ã€‚</p><h4 id="æœºåˆ¶ï¼šprintf-é‡å®šå‘"><a href="#æœºåˆ¶ï¼šprintf-é‡å®šå‘" class="headerlink" title="æœºåˆ¶ï¼šprintf é‡å®šå‘"></a>æœºåˆ¶ï¼š<code>printf</code> é‡å®šå‘</h4><table><thead><tr><th><strong>æ¦‚å¿µ</strong></th><th><strong>è§£é‡Š</strong></th></tr></thead><tbody><tr><td><strong>ç›®æ ‡</strong></td><td>å°† <code>printf</code> çš„è¾“å‡ºç›®æ ‡ä»é»˜è®¤çš„â€œå±å¹•&#x2F;æ§åˆ¶å°â€<strong>è½¬ç§»</strong>åˆ°â€œä¸²å£ç¡¬ä»¶â€ã€‚</td></tr><tr><td><strong>åŸç†</strong></td><td><code>printf</code> å‡½æ•°åœ¨åº•å±‚ä¾èµ–äºä¸€ä¸ªåä¸º <code>putchar(char ch)</code> çš„å‡½æ•°æ¥é€ä¸ªè¾“å‡ºå­—ç¬¦ã€‚</td></tr><tr><td><strong>æ“ä½œ</strong></td><td>ç¨‹åºå‘˜é€šè¿‡<strong>è‡ªè¡Œå®ç°</strong> <code>char putchar(char ch)</code> å‡½æ•°ï¼Œå¹¶åœ¨å…¶å†…éƒ¨ç›´æ¥æ“ä½œä¸²å£å‘é€å¯„å­˜å™¨ <code>SBUF</code>ã€‚é“¾æ¥å™¨å°†è‡ªåŠ¨ç”¨æ‚¨çš„ç‰ˆæœ¬æ›¿æ¢åº“ä¸­çš„é»˜è®¤ç‰ˆæœ¬ã€‚</td></tr></tbody></table><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251123120637083.png" alt="image-20251123120637083"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;string.h&quot; // å­—ç¬¦ä¸²å¤„ç†å‡½æ•°</span><br><span class="line">#include &quot;stdio.h&quot;// æ ‡å‡†è¾“å…¥è¾“å‡ºå‡½æ•°ï¼Œå¦‚ printf å’Œ sscanf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ä¸²å£æ¥æ”¶ç›¸å…³å˜é‡</span><br><span class="line">idata unsigned char Uart_Rx_Index;  // ä¸²å£æ¥æ”¶ç¼“å†²åŒºç´¢å¼•</span><br><span class="line">pdata unsigned char Uart_Rx_Buf[10] = &#123;0, 0, 0, 0, 0, 0, 0, 0, 0, 0&#125;; // ä¸²å£æ¥æ”¶ç¼“å†²åŒº</span><br><span class="line">idata unsigned char Uart_Rx_Flag;  // ä¸²å£æ¥æ”¶åˆ°æ•°æ®çš„æ ‡å¿—</span><br><span class="line">idata unsigned char Uart_Rx_Tick;  // ä¸²å£æ¥æ”¶è¶…æ—¶è®¡æ—¶å™¨</span><br><span class="line"></span><br><span class="line">void Uart_Proc() //è¶…æ—¶è§£æ</span><br><span class="line">&#123;</span><br><span class="line">// å¦‚æœæ²¡æœ‰æ¥æ”¶åˆ°æ•°æ®ï¼Œç›´æ¥è¿”å›</span><br><span class="line">if (Uart_Rx_Index == 0)</span><br><span class="line">return;</span><br><span class="line"></span><br><span class="line">// å¦‚æœè·ç¦»ä¸Šæ¬¡æ¥æ”¶åˆ°æ•°æ®è¶…è¿‡10msï¼ˆè¶…æ—¶ï¼‰</span><br><span class="line">if (Uart_Rx_Tick &gt;= 10)</span><br><span class="line">&#123;</span><br><span class="line">Uart_Rx_Flag = 0; // æ¸…é™¤æ¥æ”¶æ ‡å¿—</span><br><span class="line">Uart_Rx_Tick = 0; // å¤ä½è¶…æ—¶è®¡æ—¶å™¨</span><br><span class="line"></span><br><span class="line">//å¤„ç†å‡½æ•°</span><br><span class="line"></span><br><span class="line">// æ¸…ç©ºæ¥æ”¶ç¼“å†²åŒºï¼Œä¸ºä¸‹æ¬¡æ¥æ”¶åšå‡†å¤‡</span><br><span class="line">memset(Uart_Rx_Buf, 0, Uart_Rx_Index);</span><br><span class="line">Uart_Rx_Index = 0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ğŸ“-ä¸²å£é€šä¿¡-UART&quot;&gt;&lt;a href=&quot;#ğŸ“-ä¸²å£é€šä¿¡-UART&quot; class=&quot;headerlink&quot; title=&quot;ğŸ“ ä¸²å£é€šä¿¡ (UART)&quot;&gt;&lt;/a&gt;ğŸ“ ä¸²å£é€šä¿¡ (UART)&lt;/h1&gt;&lt;h2 id=&quot;1-ä¸²å£-UART-æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;a hr</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>1.è“æ¡¥æ¯LEDæ¨¡å—</title>
    <link href="https://roselin1217.github.io/2025/11/22/1.LED%E5%BA%95%E5%B1%82%E4%BB%A3%E7%A0%81/"/>
    <id>https://roselin1217.github.io/2025/11/22/1.LED%E5%BA%95%E5%B1%82%E4%BB%A3%E7%A0%81/</id>
    <published>2025-11-22T02:00:00.000Z</published>
    <updated>2025-11-28T10:16:57.950Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è“æ¡¥æ¯å•ç‰‡æœºä¹‹LEDç¯"><a href="#è“æ¡¥æ¯å•ç‰‡æœºä¹‹LEDç¯" class="headerlink" title="**è“æ¡¥æ¯å•ç‰‡æœºä¹‹LEDç¯ **"></a>**è“æ¡¥æ¯å•ç‰‡æœºä¹‹LEDç¯ **</h1><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/NotebookLM%20Mind%20Map.png" alt="NotebookLM Mind Map"></p><p>åœ¨ä½¿ç”¨å•ç‰‡æœºæ§åˆ¶LEDç¯æ—¶ï¼Œè‹¥é€šè¿‡<strong>74HC138è¯‘ç å™¨</strong>å’Œ<strong>M74HC573é”å­˜å™¨</strong>è¿›è¡Œåœ°å€é€‰é€šä¸ä¿¡å·ä¿æŒï¼Œéœ€æŒ‰ä»¥ä¸‹ä¸‰ä¸ªå…³é”®æ­¥éª¤æ“ä½œï¼š</p><blockquote><p>âœ… <strong>ç‚¹äº®LEDå‰çš„ä¸‰ä¸ªå¿…è¦æ­¥éª¤ï¼š</strong><br><strong>1. æ‰“å¼€é”å­˜å™¨ï¼ˆä½¿èƒ½ï¼‰ â†’ 2. é€‰ä¸­Y4è¾“å‡º â†’ 3. é€šè¿‡è¯‘ç å™¨é…ç½®åœ°å€</strong></p></blockquote><hr><h2 id="ğŸ”§-ä¸€ã€æ ¸å¿ƒå™¨ä»¶åŸç†è¡¥å……"><a href="#ğŸ”§-ä¸€ã€æ ¸å¿ƒå™¨ä»¶åŸç†è¡¥å……" class="headerlink" title="ğŸ”§ ä¸€ã€æ ¸å¿ƒå™¨ä»¶åŸç†è¡¥å……"></a>ğŸ”§ ä¸€ã€æ ¸å¿ƒå™¨ä»¶åŸç†è¡¥å……</h2><h3 id="1-74HC138-3-8è¯‘ç å™¨ï¼ˆDecoderï¼‰"><a href="#1-74HC138-3-8è¯‘ç å™¨ï¼ˆDecoderï¼‰" class="headerlink" title="1. 74HC138 3-8è¯‘ç å™¨ï¼ˆDecoderï¼‰"></a><strong>1. 74HC138 3-8è¯‘ç å™¨ï¼ˆDecoderï¼‰</strong></h3><ul><li><strong>åŠŸèƒ½</strong>ï¼šå°†3ä½äºŒè¿›åˆ¶è¾“å…¥ï¼ˆAã€Bã€Cï¼‰è¯‘ç ä¸º8ä¸ªç‹¬ç«‹ä½ç”µå¹³æœ‰æ•ˆè¾“å‡ºï¼ˆY0ï½Y7ï¼‰ï¼Œå…¶ä½™è¾“å‡ºä¸ºé«˜ç”µå¹³ã€‚</li><li>ä½¿èƒ½ç«¯ï¼š<ul><li><code>G1</code>ï¼šé«˜ç”µå¹³æœ‰æ•ˆ</li><li><code>G2A</code>ã€<code>G2B</code>ï¼šä½ç”µå¹³æœ‰æ•ˆ</li><li><strong>åªæœ‰å½“ <code>G1=1</code> ä¸” <code>G2A=G2B=0</code> æ—¶ï¼Œè¯‘ç å™¨æ‰å·¥ä½œ</strong></li></ul></li><li><strong>è¾“å‡ºç‰¹æ€§</strong>ï¼š<strong>ä½ç”µå¹³æœ‰æ•ˆ</strong>ï¼Œå³é€‰ä¸­é€šé“è¾“å‡ºä¸º<code>0</code>ï¼Œæœªé€‰ä¸­ä¸º<code>1</code></li><li>æœ¬ç”µè·¯åº”ç”¨ï¼š<ul><li><code>Aã€Bã€C</code> æ¥ P2.0ã€P2.1ã€P2.2ï¼ˆæˆ–ç±»ä¼¼ç«¯å£ï¼‰</li><li>æˆ‘ä»¬å¸Œæœ›é€‰ä¸­ <strong>Y4</strong>ï¼Œå³äºŒè¿›åˆ¶ <code>100</code> â†’ A&#x3D;0, B&#x3D;0, C&#x3D;1ï¼ˆæ³¨æ„é¡ºåºï¼‰</li><li>æ­¤æ—¶ Y4 è¾“å‡ºä¸º<strong>ä½ç”µå¹³</strong>ï¼Œå…¶ä½™ä¸ºé«˜ç”µå¹³</li></ul></li></ul><blockquote><p>ğŸ’¡ <strong>å…³é”®ç‚¹</strong>ï¼šY4ä¸ºä½ â†’ ç»è¿‡æˆ–éé—¨ â†’ Y4Cä¸ºé«˜ â†’ é”å­˜å™¨ä½¿èƒ½</p><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251110230032264.png"></p></blockquote><h3 id="2-M74HC573M1R-å…«Dé”å­˜å™¨ï¼ˆLatchï¼‰"><a href="#2-M74HC573M1R-å…«Dé”å­˜å™¨ï¼ˆLatchï¼‰" class="headerlink" title="2. M74HC573M1R å…«Dé”å­˜å™¨ï¼ˆLatchï¼‰"></a><strong>2. M74HC573M1R å…«Dé”å­˜å™¨ï¼ˆLatchï¼‰</strong></h3><ul><li><p><strong>åŠŸèƒ½</strong>ï¼š8ä½é€æ˜é”å­˜å™¨ï¼Œå½“ä½¿èƒ½ç«¯ï¼ˆLEï¼‰ä¸ºé«˜ç”µå¹³æ—¶ï¼Œè¾“å‡ºè·Ÿéšè¾“å…¥ï¼›å½“LEä¸ºä½ç”µå¹³æ—¶ï¼Œé”å­˜å½“å‰è¾“å…¥å€¼å¹¶ä¿æŒã€‚</p></li><li><p>å¼•è„šè¯´æ˜ï¼š</p><ul><li><code>D0ï½D7</code>ï¼šæ•°æ®è¾“å…¥ï¼ˆæ¥P0å£ï¼‰</li><li><code>Q0ï½Q7</code>ï¼šæ•°æ®è¾“å‡ºï¼ˆæ¥LEDé˜´æï¼‰</li><li><code>LE</code>ï¼ˆLatch Enableï¼‰ï¼šé”å­˜ä½¿èƒ½ç«¯ï¼Œ<strong>é«˜ç”µå¹³æœ‰æ•ˆ</strong></li><li><code>OE</code>ï¼ˆOutput Enableï¼‰ï¼šè¾“å‡ºä½¿èƒ½ç«¯ï¼Œ<strong>ä½ç”µå¹³æœ‰æ•ˆ</strong>ï¼ˆæœ¬ç”µè·¯å¸¸æ¥åœ°ï¼Œå§‹ç»ˆä½¿èƒ½ï¼‰</li></ul></li><li><p>æœ¬ç”µè·¯åº”ç”¨ï¼š</p><ul><li><p><code>LE</code> ç”± <strong>Y4C</strong> æ§åˆ¶</p></li><li><p><code>Y4C</code> ç”± <code>Y4</code> ç»<strong>æˆ–éé—¨</strong>ç”Ÿæˆ â†’ <strong>Y4ä¸ºä½æ—¶ï¼ŒY4Cä¸ºé«˜</strong></p></li><li><p>æ‰€ä»¥ï¼š<strong>é€‰ä¸­Y4 â†’ Y4C&#x3D;é«˜ â†’ é”å­˜å™¨æ‰“å¼€ â†’ P0å£æ•°æ®è¢«é”å­˜åˆ°LED</strong></p><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251110230233125.png"></p></li></ul></li></ul><blockquote><p>âœ… <strong>æ€»ç»“é€»è¾‘é“¾</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å•ç‰‡æœºè®¾ç½® P2.0~P2.2 = 001 â†’ 74HC138 é€‰ä¸­ Y4ï¼ˆè¾“å‡º=0ï¼‰</span><br><span class="line">Y4=0 â†’ ç»æˆ–éé—¨ â†’ Y4C=1 â†’ é”å­˜å™¨LE=1 â†’ é”å­˜å™¨é€æ˜</span><br><span class="line">å•ç‰‡æœºè®¾ç½® P0 = æŸä¸ªå€¼ï¼ˆå¦‚ 0x01ï¼‰â†’ æ•°æ®ä¼ å…¥é”å­˜å™¨</span><br><span class="line">P2ç½®ä½ï¼ˆLE=0ï¼‰â†’ é”å­˜å™¨é”å®šï¼Œä¿æŒLEDçŠ¶æ€ï¼Œé‡Šæ”¾P0å£</span><br></pre></td></tr></table></figure></blockquote><hr><h2 id="ğŸ’¡-äºŒã€ç³»ç»Ÿåˆå§‹åŒ–å‡½æ•°è¯¦è§£ï¼ˆå¸¦æ³¨é‡Šï¼‰"><a href="#ğŸ’¡-äºŒã€ç³»ç»Ÿåˆå§‹åŒ–å‡½æ•°è¯¦è§£ï¼ˆå¸¦æ³¨é‡Šï¼‰" class="headerlink" title="ğŸ’¡ äºŒã€ç³»ç»Ÿåˆå§‹åŒ–å‡½æ•°è¯¦è§£ï¼ˆå¸¦æ³¨é‡Šï¼‰"></a>ğŸ’¡ äºŒã€ç³»ç»Ÿåˆå§‹åŒ–å‡½æ•°è¯¦è§£ï¼ˆå¸¦æ³¨é‡Šï¼‰</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// å‡½æ•°åï¼šç³»ç»Ÿå¤–è®¾åˆå§‹åŒ–å‡½æ•°</span><br><span class="line">// å…¥å£å‚æ•°ï¼šæ— </span><br><span class="line">// è¿”å›å€¼ï¼šæ— </span><br><span class="line">// åŠŸèƒ½ï¼šåˆå§‹åŒ–ç³»ç»Ÿï¼Œå…³é—­æ‰€æœ‰å¤–è®¾ï¼ˆLEDã€èœ‚é¸£å™¨ã€ç»§ç”µå™¨ï¼‰ï¼Œç¡®ä¿åˆå§‹çŠ¶æ€å®‰å…¨</span><br><span class="line"></span><br><span class="line">void system_init()</span><br><span class="line">&#123;</span><br><span class="line">    /* ç¬¬ä¸€æ­¥ï¼šå…³é—­æ‰€æœ‰ï¼ˆLEDP0 = 11111111ï¼ˆLEDä½ç”µå¹³ç‚¹äº®ï¼Œé«˜ç”µå¹³ç†„ç­ï¼‰</span><br><span class="line">     ç¬¬äºŒæ­¥ï¼šé…ç½®P2å£ï¼Œä½¿èƒ½é”å­˜å™¨ï¼ˆè®¾ç½®P2.7=1ï¼ŒP2.6~P2.5ä¸º0ï¼Œç”¨äºåç»­é€‰é€šï¼‰</span><br><span class="line">     P2 = P2 &amp; 0x1F | 0x80;  â†’ ä¿ç•™ä½5ä½ï¼Œé«˜3ä½ä¸­ä»…ç½®P2.7=1</span><br><span class="line">     ç¬¬ä¸‰æ­¥ï¼šå…³é—­é”å­˜å™¨ï¼ˆLE=0ï¼Œé”å®šå½“å‰çŠ¶æ€ï¼Œé˜²æ­¢è¯¯è§¦å‘ï¼‰</span><br><span class="line">     P2 &amp;= 0x1F; â†’ å°†P2.7æ¸…é›¶ï¼Œä½¿é”å­˜å™¨è¿›å…¥ä¿æŒæ¨¡å¼ */</span><br><span class="line">    </span><br><span class="line">    P0 = 0xFF;</span><br><span class="line">    P2 = P2 &amp; 0x1F | 0x80;</span><br><span class="line">    P2 &amp;= 0x1F;</span><br><span class="line"></span><br><span class="line">    /* ç¬¬å››æ­¥ï¼šå…³é—­èœ‚é¸£å™¨å’Œç»§ç”µå™¨</span><br><span class="line">     ç¬¬äº”æ­¥ï¼šå†æ¬¡é…ç½®P2ï¼Œå‡†å¤‡é€‰é€šY4ï¼ˆP2.2=1, P2.1=0, P2.0=0 â†’ é€‰Y4ï¼‰</span><br><span class="line">     0xA0 = 1010 0000 â†’ è®¾ç½®P2.7=1, P2.5=1ï¼Œå…¶ä½™ä¸º0ï¼ˆæ­¤å¤„ä»…ç”¨äºé…ç½®è¯‘ç å™¨åœ°å€ï¼‰</span><br><span class="line">     ç¬¬å…­æ­¥ï¼šå…³é—­é”å­˜å™¨ï¼ˆç¡®ä¿è¯‘ç å™¨é€‰é€šåä¸ä¼šç«‹å³é”å­˜ï¼‰*/</span><br><span class="line">    </span><br><span class="line">    P0 = 0x00;</span><br><span class="line">    P2 = P2 &amp; 0x1F | 0xA0;</span><br><span class="line"></span><br><span class="line">    // ç¬¬å…­æ­¥ï¼šå…³é—­é”å­˜å™¨ï¼ˆç¡®ä¿è¯‘ç å™¨é€‰é€šåä¸ä¼šç«‹å³é”å­˜ï¼‰</span><br><span class="line">    P2 &amp;= 0x1F;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ” <strong>è¯´æ˜</strong>ï¼šæ­¤å‡½æ•°ä¸­ä¸¤æ¬¡é…ç½®P2æ˜¯ä¸ºäº†<strong>å…ˆæ¸…ç©ºé”å­˜å™¨ï¼Œå†é…ç½®è¯‘ç å™¨åœ°å€</strong>ï¼Œé¿å…åœ¨è®¾ç½®è¿‡ç¨‹ä¸­è¯¯è§¦å‘é”å­˜ã€‚</p></blockquote><hr><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251110230305970.png"></p><h2 id="ğŸ’¡-ä¸‰ã€LEDæ˜¾ç¤ºæ§åˆ¶å‡½æ•°è¯¦è§£ï¼ˆå¸¦æ³¨é‡Šï¼‰"><a href="#ğŸ’¡-ä¸‰ã€LEDæ˜¾ç¤ºæ§åˆ¶å‡½æ•°è¯¦è§£ï¼ˆå¸¦æ³¨é‡Šï¼‰" class="headerlink" title="ğŸ’¡ ä¸‰ã€LEDæ˜¾ç¤ºæ§åˆ¶å‡½æ•°è¯¦è§£ï¼ˆå¸¦æ³¨é‡Šï¼‰"></a>ğŸ’¡ ä¸‰ã€LEDæ˜¾ç¤ºæ§åˆ¶å‡½æ•°è¯¦è§£ï¼ˆå¸¦æ³¨é‡Šï¼‰</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">// å‡½æ•°åï¼šLEDæ˜¾ç¤ºæ§åˆ¶å‡½æ•°ï¼ˆé€šè¿‡é”å­˜å™¨ä¸è¯‘ç å™¨æ§åˆ¶ï¼‰</span><br><span class="line">// å…¥å£å‚æ•°ï¼š</span><br><span class="line">//   addrï¼šè¦ç‚¹äº®çš„LEDç¼–å·ï¼ˆ0~7ï¼Œå¯¹åº”Q0~Q7ï¼‰</span><br><span class="line">//   enableï¼šä½¿èƒ½æ ‡å¿—ï¼Œ1=ç‚¹äº®ï¼Œ0=ç†„ç­</span><br><span class="line">// è¿”å›å€¼ï¼šæ— </span><br><span class="line">// åŠŸèƒ½ï¼šæ ¹æ®åœ°å€å’Œä½¿èƒ½ä¿¡å·ï¼Œæ§åˆ¶å¯¹åº”LEDçš„äº®ç­ï¼Œé€šè¿‡é”å­˜å™¨ä¿æŒçŠ¶æ€</span><br><span class="line"></span><br><span class="line">void led_disp(unsigned char addr, unsigned char enable)</span><br><span class="line">&#123;</span><br><span class="line">    static unsigned char temp = 0x00;      // é™æ€å˜é‡ï¼šå­˜å‚¨å½“å‰é”å­˜å™¨åº”è¾“å‡ºçš„å€¼</span><br><span class="line">    static unsigned char temp_old = 0xFF;  // é™æ€å˜é‡ï¼šè®°å½•ä¸Šä¸€æ¬¡é”å­˜çš„å€¼ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦å˜åŒ–</span><br><span class="line"></span><br><span class="line">    // æ ¹æ®enableè®¾ç½®å½“å‰è¦è¾“å‡ºçš„æ•°æ®</span><br><span class="line">    // è‹¥enable=1ï¼Œåˆ™ç‚¹äº®æŒ‡å®šLEDï¼ˆä½ç”µå¹³æœ‰æ•ˆï¼Œæ•…å…ˆå–åï¼‰</span><br><span class="line">    // ä¾‹å¦‚ï¼šaddr=0 â†’ 0x01&lt;&lt;0=0x01 â†’ å–å=0xFE â†’ Q0è¾“å‡º0 â†’ LEDç‚¹äº®</span><br><span class="line">    if(enable)</span><br><span class="line">        temp = ~(0x01 &lt;&lt; addr);   // ç‚¹äº®ï¼šå¯¹åº”ä½ä¸º0</span><br><span class="line">    else</span><br><span class="line">        temp = 0xFF;              // ç†„ç­ï¼šå…¨ä¸º1</span><br><span class="line"></span><br><span class="line">    // âœ… é‡è¦ï¼šä»…å½“LEDçŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ‰é‡æ–°é”å­˜ï¼Œé¿å…é¢‘ç¹æ“ä½œ</span><br><span class="line">    if(temp != temp_old)</span><br><span class="line">    &#123;</span><br><span class="line">        // 1. å°†æ–°æ•°æ®å†™å…¥P0å£ï¼ˆæ•°æ®æ€»çº¿ï¼‰</span><br><span class="line">        P0 = temp;</span><br><span class="line"></span><br><span class="line">        // 2. ä½¿èƒ½é”å­˜å™¨ï¼šP2.7=1ï¼ˆY4C=1ï¼‰</span><br><span class="line">        // P2 = P2 &amp; 0x1F | 0x80; â†’ ä¿ç•™ä½5ä½ï¼ŒP2.7ç½®1</span><br><span class="line">        P2 = P2 &amp; 0x1F | 0x80;</span><br><span class="line"></span><br><span class="line">        // 3. é”å­˜æ•°æ®ï¼šP2.7=0ï¼Œå…³é—­é”å­˜å™¨ï¼Œä¿æŒæ•°æ®</span><br><span class="line">        // P2 &amp;= 0x1F; â†’ æ¸…é™¤P2.7</span><br><span class="line">        P2 &amp;= 0x1F;</span><br><span class="line"></span><br><span class="line">        // 4. æ›´æ–°è®°å½•ï¼Œé¿å…é‡å¤æ“ä½œ</span><br><span class="line">        temp_old = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>âœ… <strong>ä¼˜åŒ–è¯´æ˜</strong>ï¼š</p><ul><li>ä½¿ç”¨ <code>static</code> å˜é‡é¿å…é‡å¤é”å­˜ï¼Œæé«˜æ•ˆç‡ã€‚</li><li><code>temp = ~(0x01 &lt;&lt; addr)</code> æ˜¯å› ä¸ºLEDé˜´ææ¥é”å­˜å™¨è¾“å‡ºï¼Œ<strong>ä½ç”µå¹³ç‚¹äº®</strong>ã€‚</li><li>é”å­˜æ“ä½œå¿…é¡»ä¸ºâ€œå†™æ•°æ® â†’ æ‹‰é«˜LE â†’ æ‹‰ä½LEâ€ä¸‰æ­¥ï¼Œç¼ºä¸€ä¸å¯ã€‚</li></ul></blockquote><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">void Beep(unsigned char flag)</span><br><span class="line">&#123;</span><br><span class="line">static unsigned char temp = 0x00;</span><br><span class="line">static unsigned char temp_old = 0xff;</span><br><span class="line">if(flag)</span><br><span class="line">temp |= 0x40;//çœ‹åŸç†å›¾ï¼ï¼ï¼</span><br><span class="line">else</span><br><span class="line">temp &amp;= ~0x40;</span><br><span class="line">if(temp != temp_old)</span><br><span class="line">&#123;</span><br><span class="line">P0 = temp;</span><br><span class="line">P2 = P2 &amp; 0x1f | 0xa0;</span><br><span class="line">P2 &amp;= 0x1f;</span><br><span class="line">temp_old = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Relay(unsigned char flag)</span><br><span class="line">&#123;</span><br><span class="line">static unsigned char temp = 0x00;</span><br><span class="line">static unsigned char temp_old = 0xff;</span><br><span class="line">if(flag)</span><br><span class="line">temp |= 0x10;   //çœ‹åŸç†å›¾</span><br><span class="line">else</span><br><span class="line">temp &amp;= ~0x10;</span><br><span class="line">if(temp != temp_old)</span><br><span class="line">&#123;</span><br><span class="line">P0 = temp;</span><br><span class="line">P2 = P2 &amp; 0x1f | 0xa0;</span><br><span class="line">P2 &amp;= 0x1f;</span><br><span class="line">temp_old = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ğŸ“Œ-å››ã€æ€»ç»“ï¼šç‚¹äº®LEDçš„å®Œæ•´æµç¨‹"><a href="#ğŸ“Œ-å››ã€æ€»ç»“ï¼šç‚¹äº®LEDçš„å®Œæ•´æµç¨‹" class="headerlink" title="ğŸ“Œ å››ã€æ€»ç»“ï¼šç‚¹äº®LEDçš„å®Œæ•´æµç¨‹"></a>ğŸ“Œ å››ã€æ€»ç»“ï¼šç‚¹äº®LEDçš„å®Œæ•´æµç¨‹</h2><blockquote><p><strong>â€œå…ˆè®¾åœ°å€ï¼Œå†é€æ•°æ®ï¼Œæœ€åé”å­˜â€</strong></p></blockquote><ol><li><strong>é€‰åœ°å€</strong>ï¼šè®¾ç½®P2.0~P2.2 &#x3D; 001ï¼ˆLEDé€‰Y4   èœ‚é¸£å™¨å’Œç»§ç”µå™¨é€‰Y5ï¼‰</li><li><strong>é€æ•°æ®</strong>ï¼šP0 &#x3D; è¦æ˜¾ç¤ºçš„LEDæ•°æ®ï¼ˆå¦‚ <code>0xFE</code> è¡¨ç¤ºç‚¹äº®LED0ï¼‰</li><li><strong>é”æ•°æ®</strong>ï¼šP2 &#x3D; 0x80ï¼ˆä½¿èƒ½LEï¼‰â†’ P2 &#x3D; 0x00ï¼ˆé”å­˜ï¼‰</li><li><strong>ä¿æŒ</strong>ï¼šé”å­˜å™¨ä¿æŒè¾“å‡ºï¼ŒP0å¯é‡Šæ”¾ç”¨äºå…¶ä»–æ“ä½œ</li></ol><h2 id="è¡¥å……ï¼ˆV4Tï¼‰"><a href="#è¡¥å……ï¼ˆV4Tï¼‰" class="headerlink" title="è¡¥å……ï¼ˆV4Tï¼‰"></a>è¡¥å……ï¼ˆV4Tï¼‰</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;led.h&quot;</span><br><span class="line">/// @brief Ledæ‰«æ</span><br><span class="line">/// @param addr éœ€è¦æ§åˆ¶çš„Ledçš„åœ°å€ï¼ˆ0-7ï¼‰</span><br><span class="line">/// @param enable æ§åˆ¶è¯¥åœ°å€çš„Ledæ˜¯å¦ç‚¹äº®</span><br><span class="line">#include &lt;STC15F2K60S2.H&gt;</span><br><span class="line"></span><br><span class="line"> idata  unsigned char temp_1 = 0x00;</span><br><span class="line"> idata  unsigned char temp_old_1 = 0xff;</span><br><span class="line"></span><br><span class="line">void Led_Disp(unsigned char *ucLed)</span><br><span class="line">&#123;</span><br><span class="line">   unsigned char temp;</span><br><span class="line">   temp_1=0x00;</span><br><span class="line">   temp_1 = (ucLed[0] &lt;&lt; 0) | (ucLed[1] &lt;&lt; 1) | (ucLed[2] &lt;&lt; 2) | (ucLed[3] &lt;&lt; 3) |</span><br><span class="line">         (ucLed[4] &lt;&lt; 4) | (ucLed[5] &lt;&lt; 5) | (ucLed[6] &lt;&lt; 6) | (ucLed[7] &lt;&lt; 7);</span><br><span class="line">  if (temp_1 != temp_old_1)</span><br><span class="line">  &#123;</span><br><span class="line">    P0 = ~temp_1;</span><br><span class="line">    </span><br><span class="line">    // æ“ä½œP2é”å­˜å™¨</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    temp = temp | 0x80;  // ä¸0x80è¿›è¡Œæˆ–æ“ä½œ</span><br><span class="line">    P2 = temp;           // å†™å…¥P2</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    P2 = temp;           // å†™å…¥P2ï¼Œå…³é—­é”å­˜å™¨</span><br><span class="line">    </span><br><span class="line">    temp_old_1 = temp_1;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Led_Off()</span><br><span class="line">&#123;</span><br><span class="line">    unsigned char temp;</span><br><span class="line"></span><br><span class="line">    P0 = 0xff;</span><br><span class="line">    </span><br><span class="line">    // æ“ä½œP2é”å­˜å™¨</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    temp = temp | 0x80;  // ä¸0x80è¿›è¡Œæˆ–æ“ä½œ</span><br><span class="line">    P2 = temp;           // å†™å…¥P2</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    P2 = temp;           // å†™å…¥P2ï¼Œå…³é—­é”å­˜å™¨</span><br><span class="line">    </span><br><span class="line">    temp_old_1=0x00;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">idata unsigned char temp_0 = 0x00;</span><br><span class="line">idata unsigned char temp_old_0 = 0xff;</span><br><span class="line">/// @brief èœ‚é¸£å™¨æ§åˆ¶</span><br><span class="line">/// @param enable</span><br><span class="line">void Beep(bit enable)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned char temp;</span><br><span class="line">  </span><br><span class="line">  if (enable)</span><br><span class="line">    temp_0 |= 0x40;</span><br><span class="line">  else</span><br><span class="line">    temp_0 &amp;= ~(0x40);</span><br><span class="line">  if (temp_0 != temp_old_0)</span><br><span class="line">  &#123;</span><br><span class="line">    P0 = temp_0;</span><br><span class="line">    </span><br><span class="line">    // æ“ä½œP2é”å­˜å™¨</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    temp = temp | 0xa0;  // ä¸0xa0è¿›è¡Œæˆ–æ“ä½œ</span><br><span class="line">    P2 = temp;           // å†™å…¥P2</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    P2 = temp;           // å†™å…¥P2ï¼Œå…³é—­é”å­˜å™¨</span><br><span class="line">    </span><br><span class="line">    temp_old_0 = temp_0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">/// @brief ç»§ç”µå™¨æ§åˆ¶</span><br><span class="line">/// @param enable</span><br><span class="line">void Relay(bit enable)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned char temp;</span><br><span class="line">  </span><br><span class="line">  if (enable)</span><br><span class="line">    temp_0 |= 0x10;</span><br><span class="line">  else</span><br><span class="line">    temp_0 &amp;= ~(0x10);</span><br><span class="line">  if (temp_0 != temp_old_0)</span><br><span class="line">  &#123;</span><br><span class="line">    P0 = temp_0;</span><br><span class="line">    </span><br><span class="line">    // æ“ä½œP2é”å­˜å™¨</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    temp = temp | 0xa0;  // ä¸0xa0è¿›è¡Œæˆ–æ“ä½œ</span><br><span class="line">    P2 = temp;           // å†™å…¥P2</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    P2 = temp;           // å†™å…¥P2ï¼Œå…³é—­é”å­˜å™¨</span><br><span class="line">    </span><br><span class="line">    temp_old_0 = temp_0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">/// @brief MOTORæ§åˆ¶</span><br><span class="line">/// @param enable</span><br><span class="line">void MOTOR(bit enable)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned char temp;</span><br><span class="line">  </span><br><span class="line">  if (enable)</span><br><span class="line">    temp_0 |= 0x20;</span><br><span class="line">  else</span><br><span class="line">    temp_0 &amp;= ~(0x20);</span><br><span class="line">  if (temp_0 != temp_old_0)</span><br><span class="line">  &#123;</span><br><span class="line">    P0 = temp_0;</span><br><span class="line">    </span><br><span class="line">    // æ“ä½œP2é”å­˜å™¨</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    temp = temp | 0xa0;  // ä¸0xa0è¿›è¡Œæˆ–æ“ä½œ</span><br><span class="line">    P2 = temp;           // å†™å…¥P2</span><br><span class="line">    temp = P2 &amp; 0x1f;    // ä¿ç•™P2çš„ä½5ä½</span><br><span class="line">    P2 = temp;           // å†™å…¥P2ï¼Œå…³é—­é”å­˜å™¨</span><br><span class="line">    </span><br><span class="line">    temp_old_0 = temp_0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è“æ¡¥æ¯å•ç‰‡æœºä¹‹LEDç¯&quot;&gt;&lt;a href=&quot;#è“æ¡¥æ¯å•ç‰‡æœºä¹‹LEDç¯&quot; class=&quot;headerlink&quot; title=&quot;**è“æ¡¥æ¯å•ç‰‡æœºä¹‹LEDç¯ **&quot;&gt;&lt;/a&gt;**è“æ¡¥æ¯å•ç‰‡æœºä¹‹LEDç¯ **&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://raw.gi</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>0.å•ç‰‡æœºKeilå·¥ç¨‹æ¨¡æ¿æ­å»ºæŒ‡å— (V4T)</title>
    <link href="https://roselin1217.github.io/2025/11/22/0.Keil%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97/"/>
    <id>https://roselin1217.github.io/2025/11/22/0.Keil%E5%B7%A5%E7%A8%8B%E6%A8%A1%E6%9D%BF%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97/</id>
    <published>2025-11-22T02:00:00.000Z</published>
    <updated>2025-11-28T10:16:50.534Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å•ç‰‡æœºKeilå·¥ç¨‹æ¨¡æ¿æ­å»ºæŒ‡å—-V4T"><a href="#å•ç‰‡æœºKeilå·¥ç¨‹æ¨¡æ¿æ­å»ºæŒ‡å—-V4T" class="headerlink" title="å•ç‰‡æœºKeilå·¥ç¨‹æ¨¡æ¿æ­å»ºæŒ‡å— (V4T)"></a>å•ç‰‡æœºKeilå·¥ç¨‹æ¨¡æ¿æ­å»ºæŒ‡å— (V4T)</h1><blockquote><p><strong>æ ¸å¿ƒåŸåˆ™ï¼š</strong> ç‰©ç†æ–‡ä»¶å¤¹ä¸Keilé€»è¾‘Groupä¿æŒé•œåƒå¯¹åº”ã€‚</p></blockquote><hr><h3 id="Step-1-ç‰©ç†å‡†å¤‡"><a href="#Step-1-ç‰©ç†å‡†å¤‡" class="headerlink" title="Step 1: ç‰©ç†å‡†å¤‡"></a><strong>Step 1: ç‰©ç†å‡†å¤‡</strong></h3><ol><li><strong>å»ºæ ¹ç›®å½•</strong>ï¼šæ–°å»º <code>V4T</code> æ–‡ä»¶å¤¹ã€‚</li><li><strong>å»ºå­ç›®å½•</strong>ï¼šè¿›å…¥ <code>V4T</code>ï¼Œæ–°å»º <code>User</code> å’Œ <code>Driver</code> ä¸¤ä¸ªæ–‡ä»¶å¤¹ã€‚<blockquote><p><strong>ä¸€å¥è¯ç‚¹é†’</strong>ï¼šè¿™æ˜¯åœ¨ç¡¬ç›˜ä¸Šä¸ºä»£ç åˆ†å¥½â€œç±»â€ï¼Œä¸ºåç»­é€»è¾‘ç®¡ç†æ‰“åŸºç¡€ã€‚<br><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251115175154940.png" alt="image-20251115175154940"></p></blockquote></li></ol><hr><h3 id="Step-2-Keilå·¥ç¨‹åˆå§‹åŒ–"><a href="#Step-2-Keilå·¥ç¨‹åˆå§‹åŒ–" class="headerlink" title="Step 2: Keilå·¥ç¨‹åˆå§‹åŒ–"></a><strong>Step 2: Keilå·¥ç¨‹åˆå§‹åŒ–</strong></h3><ol><li><strong>æ–°å»ºå·¥ç¨‹</strong>ï¼š<code>Project -&gt; New ÂµVision Project...</code></li><li><strong>ä¿å­˜ä½ç½®</strong>ï¼š<strong>å¿…é¡»</strong>é€‰æ‹©å¹¶è¿›å…¥ <code>User</code> æ–‡ä»¶å¤¹ï¼Œå·¥ç¨‹åä¹Ÿèµ· <code>V4T</code>ã€‚</li><li><strong>é€‰èŠ¯ç‰‡</strong>ï¼šé€‰æ‹©ä½ çš„ç›®æ ‡èŠ¯ç‰‡ï¼ŒRTEçª—å£ç›´æ¥å…³æ‰ã€‚<blockquote><p><strong>ä¸€å¥è¯ç‚¹é†’</strong>ï¼šå·¥ç¨‹æ–‡ä»¶ï¼ˆè“å›¾ï¼‰å’Œæ ¸å¿ƒä»£ç æ”¾ä¸€èµ·ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚<br><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251115175609525.png" alt="image-20251115175609525"></p></blockquote></li></ol><hr><h3 id="Step-3-æ„å»ºé€»è¾‘ç»“æ„"><a href="#Step-3-æ„å»ºé€»è¾‘ç»“æ„" class="headerlink" title="Step 3: æ„å»ºé€»è¾‘ç»“æ„"></a><strong>Step 3: æ„å»ºé€»è¾‘ç»“æ„</strong></h3><ol><li><strong>æ”¹Targetå</strong>ï¼šå°† <code>Target 1</code> æ”¹ä¸º <code>V4T</code>ã€‚</li><li><strong>æ¸…ç©ºGroups</strong>ï¼šåˆ é™¤é»˜è®¤çš„ <code>Source Group 1</code>ã€‚</li><li><strong>æ–°å»ºGroups</strong>ï¼šæ·»åŠ  <code>User</code> å’Œ <code>Driver</code> ä¸¤ä¸ªGroupã€‚<blockquote><p><strong>ä¸€å¥è¯ç‚¹é†’</strong>ï¼šGroupsæ˜¯Keilé‡Œçš„â€œè™šæ‹Ÿæ–‡ä»¶å¤¹â€ï¼Œè®©å®ƒå’Œä½ çš„ç‰©ç†æ–‡ä»¶å¤¹ç»“æ„å®Œå…¨ä¸€æ ·ã€‚<br><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251115175238712.png" alt="image-20251115175238712"></p></blockquote></li></ol><hr><h3 id="Step-4-æ·»åŠ æºæ–‡ä»¶"><a href="#Step-4-æ·»åŠ æºæ–‡ä»¶" class="headerlink" title="Step 4: æ·»åŠ æºæ–‡ä»¶"></a><strong>Step 4: æ·»åŠ æºæ–‡ä»¶</strong></h3><ol><li><strong>æ·»åŠ ä¸»æ–‡ä»¶</strong>ï¼šå³é”® <code>User</code> Group -&gt; <code>Add New Item...</code> -&gt; åˆ›å»º <code>main.c</code>ã€‚</li><li><strong>æ·»åŠ é©±åŠ¨æ–‡ä»¶</strong>ï¼šå³é”® <code>Driver</code> Group -&gt; <code>Add New Item...</code> -&gt; åˆ›å»º <code>led.c</code>ã€<code>led.h</code> ç­‰ã€‚<ul><li><strong>å…³é”®</strong>ï¼šä¿å­˜æ—¶ï¼ŒåŠ¡å¿…æ‰‹åŠ¨å°† <code>led.c</code> å’Œ <code>led.h</code> å­˜åˆ°<strong>ç‰©ç†çš„ <code>Driver</code> æ–‡ä»¶å¤¹</strong>é‡Œï¼<blockquote><p><strong>ä¸€å¥è¯ç‚¹é†’</strong>ï¼šæ‰‹åŠ¨åŒæ­¥é€»è¾‘å’Œç‰©ç†ï¼Œè¿™æ˜¯ç»“æ„ä¸æ··ä¹±çš„å…³é”®ï¼</p></blockquote></li></ul></li></ol><hr><h3 id="Step-5-å·¥ç¨‹é…ç½®"><a href="#Step-5-å·¥ç¨‹é…ç½®" class="headerlink" title="Step 5: å·¥ç¨‹é…ç½®"></a><strong>Step 5: å·¥ç¨‹é…ç½®</strong></h3><ol><li><strong>æ‰“å¼€â€œé­”æœ¯æ£’â€</strong>ï¼š<code>Options for Target &#39;V4T&#39;</code>ã€‚</li><li><strong>æ·»åŠ å¤´æ–‡ä»¶è·¯å¾„</strong>ï¼š<ul><li><code>C/C++</code> é€‰é¡¹å¡ -&gt; <code>Include Paths</code> -&gt; æ·»åŠ  <code>../Driver</code>ã€‚</li></ul></li><li><strong>ç”ŸæˆHexæ–‡ä»¶</strong>ï¼š<ul><li><code>Output</code> é€‰é¡¹å¡ -&gt; å‹¾é€‰ <code>Create HEX File</code>ã€‚<blockquote><p><strong>ä¸€å¥è¯ç‚¹é†’</strong>ï¼šå‘Šè¯‰ç¼–è¯‘å™¨å»å“ªæ‰¾å¤´æ–‡ä»¶ï¼Œå¹¶è®©å®ƒç”Ÿæˆèƒ½çƒ§å½•çš„æ–‡ä»¶ã€‚<br><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/image-20251115175720773.png" alt="image-20251115175720773"></p></blockquote></li></ul></li></ol><hr><h3 id="æœ€ç»ˆç»“æ„å¯¹ç…§"><a href="#æœ€ç»ˆç»“æ„å¯¹ç…§" class="headerlink" title="æœ€ç»ˆç»“æ„å¯¹ç…§"></a><strong>æœ€ç»ˆç»“æ„å¯¹ç…§</strong></h3><table><thead><tr><th align="left">ç‰©ç†æ–‡ä»¶ç³»ç»Ÿ</th><th align="left">Keilé€»è¾‘è§†å›¾</th></tr></thead><tbody><tr><td align="left"><code>V4T/</code></td><td align="left"><code>Project: V4T</code></td></tr><tr><td align="left"><code>â”œâ”€â”€ User/</code></td><td align="left"><code>â””â”€â”€ Target: V4T</code></td></tr><tr><td align="left"><code>â”‚   â”œâ”€â”€ main.c</code></td><td align="left"><code>    â”œâ”€â”€ User</code></td></tr><tr><td align="left"><code>â”‚   â””â”€â”€ V4T.uvprojx</code></td><td align="left"><code>    â”‚   â””â”€â”€ main.c</code></td></tr><tr><td align="left"><code>â””â”€â”€ Driver/</code></td><td align="left"><code>    â””â”€â”€ Driver</code></td></tr><tr><td align="left"><code>    â”œâ”€â”€ led.c</code></td><td align="left"><code>        â”œâ”€â”€ led.c</code></td></tr><tr><td align="left"><code>    â””â”€â”€ led.h</code></td><td align="left"><code>        â””â”€â”€ led.h</code></td></tr></tbody></table><hr><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">V4T/</span><br><span class="line">â”œâ”€â”€ User/</span><br><span class="line">â”‚   â”œâ”€â”€ V4T.uvprojx      &lt;-- Keilå·¥ç¨‹æ–‡ä»¶</span><br><span class="line">â”‚   â”œâ”€â”€ V4T.uvoptx       &lt;-- Keilå·¥ç¨‹é€‰é¡¹æ–‡ä»¶</span><br><span class="line">â”‚   â”œâ”€â”€ main.c           &lt;-- ä¸»ç¨‹åº</span><br><span class="line">â”‚   â””â”€â”€ Objects/          &lt;-- ç¼–è¯‘è¾“å‡ºæ–‡ä»¶å¤¹ (Keilè‡ªåŠ¨ç”Ÿæˆ)</span><br><span class="line">â”‚       â””â”€â”€ V4T.axf, V4T.hex ...</span><br><span class="line">â””â”€â”€ Driver/</span><br><span class="line">    â”œâ”€â”€ led.c            &lt;-- LEDé©±åŠ¨æºæ–‡ä»¶ (å¾…æ·»åŠ )</span><br><span class="line">    â””â”€â”€ led.h            &lt;-- LEDé©±åŠ¨å¤´æ–‡ä»¶ (å¾…æ·»åŠ )</span><br></pre></td></tr></table></figure><p><strong>æå®šï¼</strong> è¿™ä»½æ¸…å•åº”è¯¥èƒ½è®©ä½ åœ¨1åˆ†é’Ÿå†…å›å¿†èµ·æ‰€æœ‰å…³é”®æ­¥éª¤å’Œæ³¨æ„äº‹é¡¹ã€‚</p>]]></content>
    
    
    <summary type="html">è¿™æ˜¯ä¸€ç¯‡å…³äºè“æ¡¥æ¯çš„é›¶åŸºç¡€å…¥é—¨æ•™ç¨‹ï¼Œå¦‚ä½•æ­å»ºå·¥ç¨‹æ¨¡æ¿ã€‚</summary>
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>5.I2Cåè®® (AT24C02 )ï¼‰</title>
    <link href="https://roselin1217.github.io/2025/11/22/5.I2C%E5%8D%8F%E8%AE%AE%20(AT24C02%20)/"/>
    <id>https://roselin1217.github.io/2025/11/22/5.I2C%E5%8D%8F%E8%AE%AE%20(AT24C02%20)/</id>
    <published>2025-11-22T02:00:00.000Z</published>
    <updated>2025-11-28T10:18:55.521Z</updated>
    
    <content type="html"><![CDATA[<h1 id="I2C-åè®®-AT24C02"><a href="#I2C-åè®®-AT24C02" class="headerlink" title="I2C åè®® (AT24C02 )"></a>I2C åè®® (AT24C02 )</h1><p>AT24C02 æ˜¯ä¸€æ¬¾ <strong>2Kbit (256 å­—èŠ‚)</strong> çš„ä¸²è¡Œç”µå¯æ“¦é™¤å¯ç¼–ç¨‹åªè¯»å­˜å‚¨å™¨ (EEPROM)ï¼Œå®ƒä½¿ç”¨ I2C åè®®è¿›è¡Œæ•°æ®è¯»å†™ã€‚</p><h2 id="1-AT24C02-æ ¸å¿ƒç‰¹ç‚¹ä¸-PCF8591-å¯¹æ¯”"><a href="#1-AT24C02-æ ¸å¿ƒç‰¹ç‚¹ä¸-PCF8591-å¯¹æ¯”" class="headerlink" title="1. AT24C02 æ ¸å¿ƒç‰¹ç‚¹ä¸ PCF8591 å¯¹æ¯”"></a>1. AT24C02 æ ¸å¿ƒç‰¹ç‚¹ä¸ PCF8591 å¯¹æ¯”</h2><p>AT24C02 å’Œ PCF8591 çš„ä¸»è¦åŒºåˆ«åœ¨äº<strong>åº”ç”¨åŠŸèƒ½</strong>ã€‚å®ƒä»¬å…±äº« <strong>I2C é€šä¿¡å±‚</strong>ã€‚</p><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">PCF8591 (AD&#x2F;DA è½¬æ¢å™¨)</th><th align="left">AT24C02 (EEPROM å­˜å‚¨å™¨)</th></tr></thead><tbody><tr><td align="left"><strong>æ ¸å¿ƒåŠŸèƒ½</strong></td><td align="left">æ¨¡æ‹Ÿä¿¡å·çš„è¾“å…¥&#x2F;è¾“å‡º</td><td align="left"><strong>éæ˜“å¤±æ€§æ•°æ®å­˜å‚¨</strong>ï¼ˆæ‰ç”µæ•°æ®ä¸ä¸¢å¤±ï¼‰</td></tr><tr><td align="left"><strong>I2C è¯»&#x2F;å†™åœ°å€</strong></td><td align="left">è¯»&#x2F;å†™åœ°å€ä¸åŒ (<code>0x90</code>&#x2F;<code>0x91</code>)</td><td align="left">è¯»&#x2F;å†™åœ°å€ä¸åŒ (<code>0xA0</code>&#x2F;<code>0xA1</code>)</td></tr><tr><td align="left"><strong>æ•°æ®å¯»å€</strong></td><td align="left">é€šè¿‡<strong>æ§åˆ¶å­—èŠ‚</strong>é€‰æ‹© AIN é€šé“</td><td align="left">é€šè¿‡<strong>å†…éƒ¨åœ°å€æŒ‡é’ˆ</strong>å®šä½å­˜å‚¨å•å…ƒ</td></tr><tr><td align="left"><strong>æ•°æ®ä¼ è¾“</strong></td><td align="left">è¯»æ“ä½œæ—¶ï¼Œè¿”å› 2 ä¸ªå­—èŠ‚ï¼ˆçŠ¶æ€+æ•°æ®ï¼‰</td><td align="left">å†™æ“ä½œé€šå¸¸æ˜¯<strong>é¡µå†™ (Page Write)</strong>ï¼›è¯»æ“ä½œå¯ä»¥æ˜¯<strong>è¿ç»­è¯» (Sequential Read)</strong>ã€‚</td></tr></tbody></table><hr><h2 id="2-I2C-åº”ç”¨å±‚ï¼šAT24C02-å¯»å€æœºåˆ¶"><a href="#2-I2C-åº”ç”¨å±‚ï¼šAT24C02-å¯»å€æœºåˆ¶" class="headerlink" title="2. I2C åº”ç”¨å±‚ï¼šAT24C02 å¯»å€æœºåˆ¶"></a>2. I2C åº”ç”¨å±‚ï¼šAT24C02 å¯»å€æœºåˆ¶</h2><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111105554912.png"></p><h3 id="è®¾å¤‡åœ°å€-Device-Address"><a href="#è®¾å¤‡åœ°å€-Device-Address" class="headerlink" title="è®¾å¤‡åœ°å€ (Device Address)"></a>è®¾å¤‡åœ°å€ (Device Address)</h3><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/20251111105638244.png"></p><p>æ ¹æ®æ‚¨çš„ä»£ç ï¼ŒAT24C02 çš„åœ°å€ç»“æ„éµå¾ª I2C æ ‡å‡†ï¼Œåœ°å€ä½é€šå¸¸åŒ…å«èŠ¯ç‰‡ç±»å‹ã€å­˜å‚¨å™¨å—é€‰æ‹©ä½ï¼Œä»¥åŠ R&#x2F;W ä½ã€‚</p><table><thead><tr><th align="left">æ“ä½œ</th><th align="left">åœ°å€æ ¼å¼ï¼ˆå‡è®¾ A0&#x2F;A1&#x2F;A2 å‡æ¥åœ°ï¼‰</th><th align="left">å†™åœ°å€ (åå…­è¿›åˆ¶)</th><th align="left">è¯»åœ°å€ (åå…­è¿›åˆ¶)</th></tr></thead><tbody><tr><td align="left"><strong>åœ°å€</strong></td><td align="left"><code>1010 000x</code></td><td align="left"><code>0xA0</code> (å†™)</td><td align="left"><code>0xA1</code> (è¯»)</td></tr></tbody></table><p><strong>å¯¹æ¯” PCF8591:</strong></p><ul><li>PCF8591 å†™åœ°å€ï¼š<code>0x90</code> (<code>1001 0000</code>)</li><li>AT24C02 å†™åœ°å€ï¼š<code>0xA0</code> (<code>1010 0000</code>)</li></ul><h3 id="å†…éƒ¨å­˜å‚¨å™¨å¯»å€-Memory-Addressing"><a href="#å†…éƒ¨å­˜å‚¨å™¨å¯»å€-Memory-Addressing" class="headerlink" title="å†…éƒ¨å­˜å‚¨å™¨å¯»å€ (Memory Addressing)"></a>å†…éƒ¨å­˜å‚¨å™¨å¯»å€ (Memory Addressing)</h3><p>AT24C02 å…±æœ‰ 256 å­—èŠ‚çš„å­˜å‚¨ç©ºé—´ï¼ˆåœ°å€èŒƒå›´ 00H00<em>H</em> åˆ° FFH<em>FF**H</em>ï¼‰ã€‚ä¸ PCF8591 çš„â€œæ§åˆ¶å­—èŠ‚â€ä¸åŒï¼ŒEEPROM ä½¿ç”¨**æ•°æ®åœ°å€ï¼ˆMemory Addressï¼‰**æ¥å®šä½è¦è¯»å†™çš„ä½ç½®ã€‚</p><ul><li>åœ¨æ‚¨çš„ä»£ç ä¸­ï¼Œ<code>addr</code> å‚æ•°ä»£è¡¨çš„å°±æ˜¯è¿™ä¸ª<strong>å†…éƒ¨æ•°æ®åœ°å€</strong>ï¼ˆ0 åˆ° 255ï¼‰ã€‚</li><li><strong>æ³¨æ„:</strong> AT24C02 çš„åœ°å€æ˜¯ 8 ä½ï¼ˆ1å­—èŠ‚ï¼‰ã€‚å¯¹äºæ›´å¤§çš„ EEPROMï¼ˆå¦‚ AT24C256ï¼‰ï¼Œåœ°å€éœ€è¦ 2 ä¸ªå­—èŠ‚ã€‚</li></ul><hr><h2 id="3-AT24C02-å‡½æ•°åˆ†æä¸-I2C-æ—¶åºå¯¹æ¯”"><a href="#3-AT24C02-å‡½æ•°åˆ†æä¸-I2C-æ—¶åºå¯¹æ¯”" class="headerlink" title="3. AT24C02 å‡½æ•°åˆ†æä¸ I2C æ—¶åºå¯¹æ¯”"></a>3. AT24C02 å‡½æ•°åˆ†æä¸ I2C æ—¶åºå¯¹æ¯”</h2><p>æ‚¨çš„å‡½æ•°å®Œç¾å±•ç¤ºäº† I2C è¯»å†™çš„åŸºæœ¬æ—¶åºæ¨¡æ¿ã€‚</p><h3 id="3-1-EEPROM-Write-å‡½æ•°åˆ†æ-å†™æ“ä½œ"><a href="#3-1-EEPROM-Write-å‡½æ•°åˆ†æ-å†™æ“ä½œ" class="headerlink" title="3.1 EEPROM_Write å‡½æ•°åˆ†æ (å†™æ“ä½œ)"></a>3.1 EEPROM_Write å‡½æ•°åˆ†æ (å†™æ“ä½œ)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">void EEPROM_Write(unsigned char* EEPROM_String, unsigned char addr, unsigned char num)</span><br><span class="line">&#123;</span><br><span class="line">IIC_Start();                   // 1. STARTä¿¡å· (é€šç”¨)</span><br><span class="line">IIC_SendByte(0xA0);            // 2. å‘é€å†™åœ°å€ (EEPROMç‰¹æœ‰)</span><br><span class="line">IIC_WaitAck();                 // 3. ç­‰å¾…åº”ç­” (é€šç”¨)</span><br><span class="line"></span><br><span class="line">IIC_SendByte(addr);            // 4. å†™å…¥æ•°æ®åœ°å€ (EEPROMç‰¹æœ‰)</span><br><span class="line">IIC_WaitAck();                 // 5. ç­‰å¾…åº”ç­” (é€šç”¨)</span><br><span class="line"></span><br><span class="line">while(num--)</span><br><span class="line">&#123;</span><br><span class="line">IIC_SendByte(*EEPROM_String++); // 6. å†™å…¥æ•°æ® (EEPROMç‰¹æœ‰)</span><br><span class="line">IIC_WaitAck();                 // 7. ç­‰å¾…åº”ç­” (é€šç”¨)</span><br><span class="line">IIC_Delay(200);               // 8. å…³é”®ï¼šå†™å…¥åå¿…é¡»å»¶è¿Ÿï¼ˆè§ä¸‹æ–¹è¯´æ˜ï¼‰</span><br><span class="line">&#125;</span><br><span class="line">IIC_Stop();                    // 9. STOPä¿¡å· (é€šç”¨)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸ PCF8591 å†™å…¥å¯¹æ¯”ï¼š</strong></p><table><thead><tr><th align="left">æ­¥éª¤</th><th align="left">PCF8591 å†™å…¥ (ä¾‹å¦‚ DA)</th><th align="left">AT24C02 å†™å…¥</th></tr></thead><tbody><tr><td align="left">æ­¥éª¤ 2&#x2F;3</td><td align="left">å‘é€è®¾å¤‡åœ°å€ + R&#x2F;W&#x3D;0</td><td align="left">å‘é€è®¾å¤‡åœ°å€ + R&#x2F;W&#x3D;0</td></tr><tr><td align="left"><strong>å…³é”®å·®å¼‚</strong></td><td align="left">å‘é€ <strong>æ§åˆ¶å­—èŠ‚</strong> (æŒ‡å®šé€šé“&#x2F;åŠŸèƒ½)</td><td align="left">å‘é€ <strong>æ•°æ®åœ°å€</strong> (æŒ‡å®šå­˜å‚¨å•å…ƒ)</td></tr><tr><td align="left"><strong>æ•°æ®è´Ÿè½½</strong></td><td align="left">å‘é€ <strong>DA æ•°æ®</strong></td><td align="left">å¾ªç¯å‘é€ <strong>æ•°æ®å­—èŠ‚</strong></td></tr><tr><td align="left"><strong>å»¶è¿Ÿ (æ–°)</strong></td><td align="left">æ— æ˜¾å¼å»¶è¿Ÿï¼ˆå› å…¶æ˜¯ç¬é—´æ“ä½œï¼‰</td><td align="left"><strong>å¿…é¡»æœ‰å»¶è¿Ÿ (<code>IIC_Delay(200)</code>)</strong>ï¼Œå› ä¸º EEPROM æ“¦å†™éœ€è¦æ—¶é—´ã€‚</td></tr></tbody></table><h3 id="3-2-EEPROM-Read-å‡½æ•°åˆ†æ-è¯»æ“ä½œ"><a href="#3-2-EEPROM-Read-å‡½æ•°åˆ†æ-è¯»æ“ä½œ" class="headerlink" title="3.2 EEPROM_Read å‡½æ•°åˆ†æ (è¯»æ“ä½œ)"></a>3.2 EEPROM_Read å‡½æ•°åˆ†æ (è¯»æ“ä½œ)</h3><p>è¯»å–æ“ä½œç›¸å¯¹å¤æ‚ï¼Œå› ä¸ºå®ƒéœ€è¦<strong>ä¸¤æ¬¡ I2C äº‹åŠ¡</strong>ï¼šä¸€æ¬¡æ˜¯â€œå¯»å€&#x2F;å®šä½â€ï¼Œä¸€æ¬¡æ˜¯â€œè¯»å–â€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">void EEPROM_Read(unsigned char* EEPROM_String, unsigned char addr, unsigned char num)</span><br><span class="line">&#123;</span><br><span class="line">// --- ç¬¬ä¸€æ¬¡é€šä¿¡ï¼šå®šä½/è®¾ç½®è¯»å–åœ°å€ ---</span><br><span class="line">IIC_Start();                      // 1. STARTä¿¡å·</span><br><span class="line">IIC_SendByte(0xA0);               // 2. å‘é€å†™åœ°å€ (å®šä½æ“ä½œå¿…é¡»ç”¨å†™æ¨¡å¼)</span><br><span class="line">IIC_WaitAck();</span><br><span class="line"></span><br><span class="line">IIC_SendByte(addr);               // 3. å†™å…¥è¦è¯»å–çš„æ•°æ®åœ°å€</span><br><span class="line">IIC_WaitAck();                    // 4. ç­‰å¾…åº”ç­”</span><br><span class="line"></span><br><span class="line">// --- ç¬¬äºŒæ¬¡é€šä¿¡ï¼šå®é™…è¯»å–æ•°æ® ---</span><br><span class="line">IIC_Start();                      // 5. ç¬¬äºŒæ¬¡ START (é‡å¯)</span><br><span class="line">IIC_SendByte(0xA1);               // 6. å‘é€è¯»åœ°å€ (ç¡®å®šè¯»æ¨¡å¼)</span><br><span class="line">IIC_WaitAck();</span><br><span class="line"></span><br><span class="line">while(num--)</span><br><span class="line">&#123;</span><br><span class="line">*EEPROM_String++ = IIC_RecByte();// 7. æ¥æ”¶æ•°æ®</span><br><span class="line">if(num) IIC_SendAck(0);       // 8. å¦‚æœè¿˜æœ‰æ•°æ®ï¼Œå‘é€ ACK (0)</span><br><span class="line">else IIC_SendAck(1);      // 9. å¦‚æœæ˜¯æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œå‘é€ NACK (1)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">IIC_Stop();                       // 10. STOPä¿¡å·</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸ PCF8591 è¯»å–å¯¹æ¯”ï¼š</strong></p><table><thead><tr><th align="left">æ­¥éª¤</th><th align="left">PCF8591 è¯»å– (AD)</th><th align="left">AT24C02 è¯»å– (EEPROM)</th></tr></thead><tbody><tr><td align="left"><strong>å®šä½&#x2F;å¯»å€</strong></td><td align="left">å‘é€æ§åˆ¶å­—èŠ‚ï¼ˆæŒ‡å®š AIN é€šé“ï¼‰</td><td align="left">å‘é€æ•°æ®åœ°å€ï¼ˆæŒ‡å®šå­˜å‚¨å•å…ƒï¼‰</td></tr><tr><td align="left"><strong>æ•°æ®è·å–</strong></td><td align="left">ç¬¬ä¸€æ¬¡å‘é€ R&#x2F;W&#x3D;1åï¼Œè¿”å› <strong>2ä¸ªå­—èŠ‚</strong>ï¼ˆçŠ¶æ€+æ•°æ®ï¼‰ã€‚</td><td align="left">å¿…é¡»<strong>é‡æ–°å‘èµ·ä¸€æ¬¡ I2C é€šä¿¡</strong>ï¼ˆç¬¬äºŒæ¬¡ START&#x2F;åœ°å€ï¼‰ï¼Œæ‰èƒ½å¼€å§‹æ¥æ”¶æ•°æ®ã€‚</td></tr><tr><td align="left"><strong>ç»“æŸåº”ç­”</strong></td><td align="left">ä¸»è®¾å¤‡åœ¨æœ€åä¸€ä¸ªå­—èŠ‚åå‘é€ NACK ç»“æŸä¼ è¾“ã€‚</td><td align="left">å¾ªç¯æ¥æ”¶ä¸­ï¼Œæœ€åä¸€ä¸ªå­—èŠ‚éœ€è¦å‘é€ NACK (1)ï¼Œéšåå‘é€ STOPã€‚</td></tr></tbody></table><p><img src="https://raw.githubusercontent.com/Roselin1217/roselin-images/main/images/i2c%E9%80%9F%E8%AE%B0.png"></p><h3 id="å…³é”®ç‚¹æ€»ç»“ï¼šEEPROM-çš„-Page-Write-é¡µå†™"><a href="#å…³é”®ç‚¹æ€»ç»“ï¼šEEPROM-çš„-Page-Write-é¡µå†™" class="headerlink" title="å…³é”®ç‚¹æ€»ç»“ï¼šEEPROM çš„ Page Write (é¡µå†™)"></a>å…³é”®ç‚¹æ€»ç»“ï¼šEEPROM çš„ Page Write (é¡µå†™)</h3><p>æ‚¨çš„ <code>EEPROM_Write</code> å‡½æ•°ä½¿ç”¨äº† <code>while(num--)</code> å¾ªç¯æ¥å†™å…¥å¤šä¸ªå­—èŠ‚ï¼Œè¿™è¢«ç§°ä¸º<strong>è¿ç»­å†™å…¥</strong>ã€‚</p><ul><li><strong>æ³¨æ„:</strong> AT24C02 æ”¯æŒ<strong>é¡µå†™</strong>ï¼ˆPage Writeï¼‰ã€‚å¦‚æœå†™å…¥çš„åœ°å€æœªè·¨è¶Šé¡µè¾¹ç•Œï¼ˆAT24C02 çš„é¡µå¤§å°é€šå¸¸æ˜¯ 8 å­—èŠ‚ï¼‰ï¼Œå®ƒå¯ä»¥ä¸€æ¬¡æ€§å†™å…¥ä¸€é¡µæ•°æ®ï¼Œé€Ÿåº¦æ¯”å•å­—èŠ‚å†™å…¥å¿«å¾—å¤šã€‚</li><li>æ‚¨çš„ä»£ç ä¸­æ˜¾å¼æ·»åŠ çš„ <code>IIC_Delay(200)</code> æ˜¯ä¸ºäº†ç­‰å¾… EEPROM å®Œæˆå†…éƒ¨çš„<strong>æ•°æ®æ“¦å†™å‘¨æœŸ</strong>ï¼Œè¿™æ˜¯å­˜å‚¨å™¨ç‹¬æœ‰çš„æ­¥éª¤ï¼ŒPCF8591 (ADC&#x2F;DAC) é€šå¸¸ä¸éœ€è¦å¦‚æ­¤é•¿çš„å†™ç­‰å¾…æ—¶é—´ã€‚</li></ul><h2 id="4-C-è¯­è¨€æ ¸å¿ƒï¼šæŒ‡é’ˆä¸å‡½æ•°è°ƒç”¨"><a href="#4-C-è¯­è¨€æ ¸å¿ƒï¼šæŒ‡é’ˆä¸å‡½æ•°è°ƒç”¨" class="headerlink" title="4  C è¯­è¨€æ ¸å¿ƒï¼šæŒ‡é’ˆä¸å‡½æ•°è°ƒç”¨"></a>4  C è¯­è¨€æ ¸å¿ƒï¼šæŒ‡é’ˆä¸å‡½æ•°è°ƒç”¨</h2><h3 id="4-1-ä¸ºä»€ä¹ˆå‡½æ•°å‚æ•°ä¸­è¦ç”¨-æŒ‡é’ˆ-ï¼Ÿ"><a href="#4-1-ä¸ºä»€ä¹ˆå‡½æ•°å‚æ•°ä¸­è¦ç”¨-æŒ‡é’ˆ-ï¼Ÿ" class="headerlink" title="4.1 ä¸ºä»€ä¹ˆå‡½æ•°å‚æ•°ä¸­è¦ç”¨ * (æŒ‡é’ˆ)ï¼Ÿ"></a>4.1 ä¸ºä»€ä¹ˆå‡½æ•°å‚æ•°ä¸­è¦ç”¨ <code>*</code> (æŒ‡é’ˆ)ï¼Ÿ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void EEPROM_Write(unsigned char* EEPROM_String, ...)</span><br></pre></td></tr></table></figure><ul><li><strong>åŸå› </strong>ï¼šC è¯­è¨€å‡½æ•°<strong>æ— æ³•ç›´æ¥ä¼ é€’æ•´ä¸ªæ•°ç»„</strong>ã€‚ä¼ é€’æ•°ç»„åä¼šé€€åŒ–ä¸ºæŒ‡å‘å…¶é¦–å…ƒç´ çš„æŒ‡é’ˆã€‚</li><li><strong>ä½œç”¨</strong>ï¼š<code>*</code> å·åœ¨å‚æ•°å£°æ˜ä¸­è¡¨ç¤º <code>EEPROM_String</code> æ˜¯ä¸€ä¸ª<strong>æŒ‡é’ˆ</strong>ï¼Œå®ƒå­˜å‚¨çš„æ˜¯ä¸€ä¸ªå†…å­˜åœ°å€ã€‚å‡½æ•°é€šè¿‡è¿™ä¸ªåœ°å€å¯ä»¥è®¿é—®å’Œæ“ä½œä¸€æ•´å—è¿ç»­çš„æ•°æ®ã€‚</li></ul><h3 id="4-2-å¦‚ä½•è°ƒç”¨å¸¦æŒ‡é’ˆå‚æ•°çš„å‡½æ•°ï¼Ÿ"><a href="#4-2-å¦‚ä½•è°ƒç”¨å¸¦æŒ‡é’ˆå‚æ•°çš„å‡½æ•°ï¼Ÿ" class="headerlink" title="4.2 å¦‚ä½•è°ƒç”¨å¸¦æŒ‡é’ˆå‚æ•°çš„å‡½æ•°ï¼Ÿ"></a>4.2 å¦‚ä½•è°ƒç”¨å¸¦æŒ‡é’ˆå‚æ•°çš„å‡½æ•°ï¼Ÿ</h3><table><thead><tr><th align="left">æ•°æ®ç±»å‹</th><th align="left">å¦‚ä½•ä¼ é€’ç»™ <code>EEPROM_Write</code></th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left"><strong>å­—ç¬¦ä¸²å¸¸é‡</strong></td><td align="left">ç›´æ¥ä¼ é€’å­—ç¬¦ä¸²åï¼ˆæœ¬èº«å°±æ˜¯æŒ‡é’ˆï¼‰</td><td align="left"><code>EEPROM_Write(&quot;Hello&quot;, 0, 5);</code></td></tr><tr><td align="left"><strong>æ•°ç»„</strong></td><td align="left">ç›´æ¥ä¼ é€’æ•°ç»„åï¼ˆé€€åŒ–ä¸ºæŒ‡é’ˆï¼‰</td><td align="left"><code>unsigned char data[5]={...}; EEPROM_Write(data, 10, 5);</code></td></tr><tr><td align="left"><strong>å•ä¸ªå˜é‡</strong></td><td align="left">ä½¿ç”¨ <code>&amp;</code> è¿ç®—ç¬¦è·å–å…¶åœ°å€</td><td align="left"><code>unsigned char val=100; EEPROM_Write(&amp;val, 20, 1);</code></td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;I2C-åè®®-AT24C02&quot;&gt;&lt;a href=&quot;#I2C-åè®®-AT24C02&quot; class=&quot;headerlink&quot; title=&quot;I2C åè®® (AT24C02 )&quot;&gt;&lt;/a&gt;I2C åè®® (AT24C02 )&lt;/h1&gt;&lt;p&gt;AT24C02 æ˜¯ä¸€æ¬¾ &lt;str</summary>
      
    
    
    
    <category term="åµŒå…¥å¼ä¹‹æ—…" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/"/>
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F%E4%B9%8B%E6%97%85/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    
    <category term="å¤§å­¦ç«èµ›" scheme="https://roselin1217.github.io/tags/%E5%A4%A7%E5%AD%A6%E7%AB%9E%E8%B5%9B/"/>
    
    <category term="å­¦ä¹ ç¬”è®°" scheme="https://roselin1217.github.io/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    <category term="è“æ¡¥æ¯" scheme="https://roselin1217.github.io/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"/>
    
  </entry>
  
</feed>
